(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function fu(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const $e={},ms=[],Rn=()=>{},Lw=()=>!1,ka=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),du=t=>t.startsWith("onUpdate:"),ct=Object.assign,mu=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Fw=Object.prototype.hasOwnProperty,Ne=(t,e)=>Fw.call(t,e),he=Array.isArray,ps=t=>Na(t)==="[object Map]",Bm=t=>Na(t)==="[object Set]",me=t=>typeof t=="function",et=t=>typeof t=="string",Gn=t=>typeof t=="symbol",Ge=t=>t!==null&&typeof t=="object",Um=t=>(Ge(t)||me(t))&&me(t.then)&&me(t.catch),$m=Object.prototype.toString,Na=t=>$m.call(t),Bw=t=>Na(t).slice(8,-1),jm=t=>Na(t)==="[object Object]",pu=t=>et(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,bi=fu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Oa=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Uw=/-(\w)/g,sn=Oa(t=>t.replace(Uw,(e,n)=>n?n.toUpperCase():"")),$w=/\B([A-Z])/g,wr=Oa(t=>t.replace($w,"-$1").toLowerCase()),Ma=Oa(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ol=Oa(t=>t?`on${Ma(t)}`:""),ar=(t,e)=>!Object.is(t,e),qo=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},qm=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:n})},gc=t=>{const e=parseFloat(t);return isNaN(e)?t:e},jw=t=>{const e=et(t)?Number(t):NaN;return isNaN(e)?t:e};let Af;const La=()=>Af||(Af=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Fa(t){if(he(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=et(r)?Gw(r):Fa(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(et(t)||Ge(t))return t}const qw=/;(?![^(]*\))/g,Hw=/:([^]+)/,zw=/\/\*[^]*?\*\//g;function Gw(t){const e={};return t.replace(zw,"").split(qw).forEach(n=>{if(n){const r=n.split(Hw);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Ba(t){let e="";if(et(t))e=t;else if(he(t))for(let n=0;n<t.length;n++){const r=Ba(t[n]);r&&(e+=r+" ")}else if(Ge(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Ww="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Kw=fu(Ww);function Hm(t){return!!t||t===""}const zm=t=>!!(t&&t.__v_isRef===!0),ye=t=>et(t)?t:t==null?"":he(t)||Ge(t)&&(t.toString===$m||!me(t.toString))?zm(t)?ye(t.value):JSON.stringify(t,Gm,2):String(t),Gm=(t,e)=>zm(e)?Gm(t,e.value):ps(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s],i)=>(n[Ml(r,i)+" =>"]=s,n),{})}:Bm(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Ml(n))}:Gn(e)?Ml(e):Ge(e)&&!he(e)&&!jm(e)?String(e):e,Ml=(t,e="")=>{var n;return Gn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Kt;class Qw{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Kt,!e&&Kt&&(this.index=(Kt.scopes||(Kt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Kt;try{return Kt=this,e()}finally{Kt=n}}}on(){Kt=this}off(){Kt=this.parent}stop(e){if(this._active){this._active=!1;let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(this.effects.length=0,n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Xw(){return Kt}let qe;const Ll=new WeakSet;class Wm{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Kt&&Kt.active&&Kt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ll.has(this)&&(Ll.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Qm(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,If(this),Xm(this);const e=qe,n=fn;qe=this,fn=!0;try{return this.fn()}finally{Jm(this),qe=e,fn=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)yu(e);this.deps=this.depsTail=void 0,If(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ll.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){_c(this)&&this.run()}get dirty(){return _c(this)}}let Km=0,Ti,Ai;function Qm(t,e=!1){if(t.flags|=8,e){t.next=Ai,Ai=t;return}t.next=Ti,Ti=t}function gu(){Km++}function _u(){if(--Km>0)return;if(Ai){let e=Ai;for(Ai=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Ti;){let e=Ti;for(Ti=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=n}}if(t)throw t}function Xm(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Jm(t){let e,n=t.depsTail,r=n;for(;r;){const s=r.prevDep;r.version===-1?(r===n&&(n=s),yu(r),Jw(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}t.deps=e,t.depsTail=n}function _c(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Ym(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Ym(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Oi))return;t.globalVersion=Oi;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!_c(t)){t.flags&=-3;return}const n=qe,r=fn;qe=t,fn=!0;try{Xm(t);const s=t.fn(t._value);(e.version===0||ar(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{qe=n,fn=r,Jm(t),t.flags&=-3}}function yu(t,e=!1){const{dep:n,prevSub:r,nextSub:s}=t;if(r&&(r.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=r,t.nextSub=void 0),n.subs===t&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)yu(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Jw(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let fn=!0;const Zm=[];function vr(){Zm.push(fn),fn=!1}function Er(){const t=Zm.pop();fn=t===void 0?!0:t}function If(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=qe;qe=void 0;try{e()}finally{qe=n}}}let Oi=0;class Yw{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class wu{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!qe||!fn||qe===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==qe)n=this.activeLink=new Yw(qe,this),qe.deps?(n.prevDep=qe.depsTail,qe.depsTail.nextDep=n,qe.depsTail=n):qe.deps=qe.depsTail=n,ep(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const r=n.nextDep;r.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=r),n.prevDep=qe.depsTail,n.nextDep=void 0,qe.depsTail.nextDep=n,qe.depsTail=n,qe.deps===n&&(qe.deps=r)}return n}trigger(e){this.version++,Oi++,this.notify(e)}notify(e){gu();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{_u()}}}function ep(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)ep(r)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const yc=new WeakMap,Ur=Symbol(""),wc=Symbol(""),Mi=Symbol("");function xt(t,e,n){if(fn&&qe){let r=yc.get(t);r||yc.set(t,r=new Map);let s=r.get(n);s||(r.set(n,s=new wu),s.map=r,s.key=n),s.track()}}function Un(t,e,n,r,s,i){const o=yc.get(t);if(!o){Oi++;return}const l=c=>{c&&c.trigger()};if(gu(),e==="clear")o.forEach(l);else{const c=he(t),u=c&&pu(n);if(c&&n==="length"){const f=Number(r);o.forEach((d,p)=>{(p==="length"||p===Mi||!Gn(p)&&p>=f)&&l(d)})}else switch((n!==void 0||o.has(void 0))&&l(o.get(n)),u&&l(o.get(Mi)),e){case"add":c?u&&l(o.get("length")):(l(o.get(Ur)),ps(t)&&l(o.get(wc)));break;case"delete":c||(l(o.get(Ur)),ps(t)&&l(o.get(wc)));break;case"set":ps(t)&&l(o.get(Ur));break}}_u()}function Zr(t){const e=xe(t);return e===t?e:(xt(e,"iterate",Mi),nn(t)?e:e.map(Vt))}function Ua(t){return xt(t=xe(t),"iterate",Mi),t}const Zw={__proto__:null,[Symbol.iterator](){return Fl(this,Symbol.iterator,Vt)},concat(...t){return Zr(this).concat(...t.map(e=>he(e)?Zr(e):e))},entries(){return Fl(this,"entries",t=>(t[1]=Vt(t[1]),t))},every(t,e){return On(this,"every",t,e,void 0,arguments)},filter(t,e){return On(this,"filter",t,e,n=>n.map(Vt),arguments)},find(t,e){return On(this,"find",t,e,Vt,arguments)},findIndex(t,e){return On(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return On(this,"findLast",t,e,Vt,arguments)},findLastIndex(t,e){return On(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return On(this,"forEach",t,e,void 0,arguments)},includes(...t){return Bl(this,"includes",t)},indexOf(...t){return Bl(this,"indexOf",t)},join(t){return Zr(this).join(t)},lastIndexOf(...t){return Bl(this,"lastIndexOf",t)},map(t,e){return On(this,"map",t,e,void 0,arguments)},pop(){return ai(this,"pop")},push(...t){return ai(this,"push",t)},reduce(t,...e){return Cf(this,"reduce",t,e)},reduceRight(t,...e){return Cf(this,"reduceRight",t,e)},shift(){return ai(this,"shift")},some(t,e){return On(this,"some",t,e,void 0,arguments)},splice(...t){return ai(this,"splice",t)},toReversed(){return Zr(this).toReversed()},toSorted(t){return Zr(this).toSorted(t)},toSpliced(...t){return Zr(this).toSpliced(...t)},unshift(...t){return ai(this,"unshift",t)},values(){return Fl(this,"values",Vt)}};function Fl(t,e,n){const r=Ua(t),s=r[e]();return r!==t&&!nn(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=n(i.value)),i}),s}const ev=Array.prototype;function On(t,e,n,r,s,i){const o=Ua(t),l=o!==t&&!nn(t),c=o[e];if(c!==ev[e]){const d=c.apply(t,i);return l?Vt(d):d}let u=n;o!==t&&(l?u=function(d,p){return n.call(this,Vt(d),p,t)}:n.length>2&&(u=function(d,p){return n.call(this,d,p,t)}));const f=c.call(o,u,r);return l&&s?s(f):f}function Cf(t,e,n,r){const s=Ua(t);let i=n;return s!==t&&(nn(t)?n.length>3&&(i=function(o,l,c){return n.call(this,o,l,c,t)}):i=function(o,l,c){return n.call(this,o,Vt(l),c,t)}),s[e](i,...r)}function Bl(t,e,n){const r=xe(t);xt(r,"iterate",Mi);const s=r[e](...n);return(s===-1||s===!1)&&bu(n[0])?(n[0]=xe(n[0]),r[e](...n)):s}function ai(t,e,n=[]){vr(),gu();const r=xe(t)[e].apply(t,n);return _u(),Er(),r}const tv=fu("__proto__,__v_isRef,__isVue"),tp=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Gn));function nv(t){Gn(t)||(t=String(t));const e=xe(this);return xt(e,"has",t),e.hasOwnProperty(t)}class np{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,r){if(n==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return r===(s?i?fv:op:i?ip:sp).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=he(e);if(!s){let c;if(o&&(c=Zw[n]))return c;if(n==="hasOwnProperty")return nv}const l=Reflect.get(e,n,kt(e)?e:r);return(Gn(n)?tp.has(n):tv(n))||(s||xt(e,"get",n),i)?l:kt(l)?o&&pu(n)?l:l.value:Ge(l)?s?lp(l):$a(l):l}}class rp extends np{constructor(e=!1){super(!1,e)}set(e,n,r,s){let i=e[n];if(!this._isShallow){const c=jr(i);if(!nn(r)&&!jr(r)&&(i=xe(i),r=xe(r)),!he(e)&&kt(i)&&!kt(r))return c?!1:(i.value=r,!0)}const o=he(e)&&pu(n)?Number(n)<e.length:Ne(e,n),l=Reflect.set(e,n,r,kt(e)?e:s);return e===xe(s)&&(o?ar(r,i)&&Un(e,"set",n,r):Un(e,"add",n,r)),l}deleteProperty(e,n){const r=Ne(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&r&&Un(e,"delete",n,void 0),s}has(e,n){const r=Reflect.has(e,n);return(!Gn(n)||!tp.has(n))&&xt(e,"has",n),r}ownKeys(e){return xt(e,"iterate",he(e)?"length":Ur),Reflect.ownKeys(e)}}class rv extends np{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const sv=new rp,iv=new rv,ov=new rp(!0);const vc=t=>t,Po=t=>Reflect.getPrototypeOf(t);function av(t,e,n){return function(...r){const s=this.__v_raw,i=xe(s),o=ps(i),l=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=s[t](...r),f=n?vc:e?Ec:Vt;return!e&&xt(i,"iterate",c?wc:Ur),{next(){const{value:d,done:p}=u.next();return p?{value:d,done:p}:{value:l?[f(d[0]),f(d[1])]:f(d),done:p}},[Symbol.iterator](){return this}}}}function xo(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function lv(t,e){const n={get(s){const i=this.__v_raw,o=xe(i),l=xe(s);t||(ar(s,l)&&xt(o,"get",s),xt(o,"get",l));const{has:c}=Po(o),u=e?vc:t?Ec:Vt;if(c.call(o,s))return u(i.get(s));if(c.call(o,l))return u(i.get(l));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!t&&xt(xe(s),"iterate",Ur),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=xe(i),l=xe(s);return t||(ar(s,l)&&xt(o,"has",s),xt(o,"has",l)),s===l?i.has(s):i.has(s)||i.has(l)},forEach(s,i){const o=this,l=o.__v_raw,c=xe(l),u=e?vc:t?Ec:Vt;return!t&&xt(c,"iterate",Ur),l.forEach((f,d)=>s.call(i,u(f),u(d),o))}};return ct(n,t?{add:xo("add"),set:xo("set"),delete:xo("delete"),clear:xo("clear")}:{add(s){!e&&!nn(s)&&!jr(s)&&(s=xe(s));const i=xe(this);return Po(i).has.call(i,s)||(i.add(s),Un(i,"add",s,s)),this},set(s,i){!e&&!nn(i)&&!jr(i)&&(i=xe(i));const o=xe(this),{has:l,get:c}=Po(o);let u=l.call(o,s);u||(s=xe(s),u=l.call(o,s));const f=c.call(o,s);return o.set(s,i),u?ar(i,f)&&Un(o,"set",s,i):Un(o,"add",s,i),this},delete(s){const i=xe(this),{has:o,get:l}=Po(i);let c=o.call(i,s);c||(s=xe(s),c=o.call(i,s)),l&&l.call(i,s);const u=i.delete(s);return c&&Un(i,"delete",s,void 0),u},clear(){const s=xe(this),i=s.size!==0,o=s.clear();return i&&Un(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=av(s,t,e)}),n}function vu(t,e){const n=lv(t,e);return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(Ne(n,s)&&s in r?n:r,s,i)}const cv={get:vu(!1,!1)},uv={get:vu(!1,!0)},hv={get:vu(!0,!1)};const sp=new WeakMap,ip=new WeakMap,op=new WeakMap,fv=new WeakMap;function dv(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function mv(t){return t.__v_skip||!Object.isExtensible(t)?0:dv(Bw(t))}function $a(t){return jr(t)?t:Eu(t,!1,sv,cv,sp)}function ap(t){return Eu(t,!1,ov,uv,ip)}function lp(t){return Eu(t,!0,iv,hv,op)}function Eu(t,e,n,r,s){if(!Ge(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=mv(t);if(o===0)return t;const l=new Proxy(t,o===2?r:n);return s.set(t,l),l}function gs(t){return jr(t)?gs(t.__v_raw):!!(t&&t.__v_isReactive)}function jr(t){return!!(t&&t.__v_isReadonly)}function nn(t){return!!(t&&t.__v_isShallow)}function bu(t){return t?!!t.__v_raw:!1}function xe(t){const e=t&&t.__v_raw;return e?xe(e):t}function pv(t){return!Ne(t,"__v_skip")&&Object.isExtensible(t)&&qm(t,"__v_skip",!0),t}const Vt=t=>Ge(t)?$a(t):t,Ec=t=>Ge(t)?lp(t):t;function kt(t){return t?t.__v_isRef===!0:!1}function it(t){return cp(t,!1)}function gv(t){return cp(t,!0)}function cp(t,e){return kt(t)?t:new _v(t,e)}class _v{constructor(e,n){this.dep=new wu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:xe(e),this._value=n?e:Vt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,r=this.__v_isShallow||nn(e)||jr(e);e=r?e:xe(e),ar(e,n)&&(this._rawValue=e,this._value=r?e:Vt(e),this.dep.trigger())}}function _s(t){return kt(t)?t.value:t}const yv={get:(t,e,n)=>e==="__v_raw"?t:_s(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return kt(s)&&!kt(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function up(t){return gs(t)?t:new Proxy(t,yv)}class wv{constructor(e,n,r){this.fn=e,this.setter=n,this._value=void 0,this.dep=new wu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Oi-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&qe!==this)return Qm(this,!0),!0}get value(){const e=this.dep.track();return Ym(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function vv(t,e,n=!1){let r,s;return me(t)?r=t:(r=t.get,s=t.set),new wv(r,s,n)}const Vo={},oa=new WeakMap;let kr;function Ev(t,e=!1,n=kr){if(n){let r=oa.get(n);r||oa.set(n,r=[]),r.push(t)}}function bv(t,e,n=$e){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:l,call:c}=n,u=N=>s?N:nn(N)||s===!1||s===0?$n(N,1):$n(N);let f,d,p,g,S=!1,R=!1;if(kt(t)?(d=()=>t.value,S=nn(t)):gs(t)?(d=()=>u(t),S=!0):he(t)?(R=!0,S=t.some(N=>gs(N)||nn(N)),d=()=>t.map(N=>{if(kt(N))return N.value;if(gs(N))return u(N);if(me(N))return c?c(N,2):N()})):me(t)?e?d=c?()=>c(t,2):t:d=()=>{if(p){vr();try{p()}finally{Er()}}const N=kr;kr=f;try{return c?c(t,3,[g]):t(g)}finally{kr=N}}:d=Rn,e&&s){const N=d,ne=s===!0?1/0:s;d=()=>$n(N(),ne)}const x=Xw(),j=()=>{f.stop(),x&&x.active&&mu(x.effects,f)};if(i&&e){const N=e;e=(...ne)=>{N(...ne),j()}}let D=R?new Array(t.length).fill(Vo):Vo;const O=N=>{if(!(!(f.flags&1)||!f.dirty&&!N))if(e){const ne=f.run();if(s||S||(R?ne.some((Q,T)=>ar(Q,D[T])):ar(ne,D))){p&&p();const Q=kr;kr=f;try{const T=[ne,D===Vo?void 0:R&&D[0]===Vo?[]:D,g];c?c(e,3,T):e(...T),D=ne}finally{kr=Q}}}else f.run()};return l&&l(O),f=new Wm(d),f.scheduler=o?()=>o(O,!1):O,g=N=>Ev(N,!1,f),p=f.onStop=()=>{const N=oa.get(f);if(N){if(c)c(N,4);else for(const ne of N)ne();oa.delete(f)}},e?r?O(!0):D=f.run():o?o(O.bind(null,!0),!0):f.run(),j.pause=f.pause.bind(f),j.resume=f.resume.bind(f),j.stop=j,j}function $n(t,e=1/0,n){if(e<=0||!Ge(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,kt(t))$n(t.value,e,n);else if(he(t))for(let r=0;r<t.length;r++)$n(t[r],e,n);else if(Bm(t)||ps(t))t.forEach(r=>{$n(r,e,n)});else if(jm(t)){for(const r in t)$n(t[r],e,n);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&$n(t[r],e,n)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function to(t,e,n,r){try{return r?t(...r):t()}catch(s){ja(s,e,n)}}function mn(t,e,n,r){if(me(t)){const s=to(t,e,n,r);return s&&Um(s)&&s.catch(i=>{ja(i,e,n)}),s}if(he(t)){const s=[];for(let i=0;i<t.length;i++)s.push(mn(t[i],e,n,r));return s}}function ja(t,e,n,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||$e;if(e){let l=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const f=l.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](t,c,u)===!1)return}l=l.parent}if(i){vr(),to(i,null,10,[t,c,u]),Er();return}}Tv(t,n,s,r,o)}function Tv(t,e,n,r=!0,s=!1){if(s)throw t;console.error(t)}const Mt=[];let Tn=-1;const ys=[];let nr=null,rs=0;const hp=Promise.resolve();let aa=null;function fp(t){const e=aa||hp;return t?e.then(this?t.bind(this):t):e}function Av(t){let e=Tn+1,n=Mt.length;for(;e<n;){const r=e+n>>>1,s=Mt[r],i=Li(s);i<t||i===t&&s.flags&2?e=r+1:n=r}return e}function Tu(t){if(!(t.flags&1)){const e=Li(t),n=Mt[Mt.length-1];!n||!(t.flags&2)&&e>=Li(n)?Mt.push(t):Mt.splice(Av(e),0,t),t.flags|=1,dp()}}function dp(){aa||(aa=hp.then(pp))}function Iv(t){he(t)?ys.push(...t):nr&&t.id===-1?nr.splice(rs+1,0,t):t.flags&1||(ys.push(t),t.flags|=1),dp()}function Sf(t,e,n=Tn+1){for(;n<Mt.length;n++){const r=Mt[n];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;Mt.splice(n,1),n--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function mp(t){if(ys.length){const e=[...new Set(ys)].sort((n,r)=>Li(n)-Li(r));if(ys.length=0,nr){nr.push(...e);return}for(nr=e,rs=0;rs<nr.length;rs++){const n=nr[rs];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}nr=null,rs=0}}const Li=t=>t.id==null?t.flags&2?-1:1/0:t.id;function pp(t){try{for(Tn=0;Tn<Mt.length;Tn++){const e=Mt[Tn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),to(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Tn<Mt.length;Tn++){const e=Mt[Tn];e&&(e.flags&=-2)}Tn=-1,Mt.length=0,mp(),aa=null,(Mt.length||ys.length)&&pp()}}let dt=null,gp=null;function la(t){const e=dt;return dt=t,gp=t&&t.type.__scopeId||null,e}function tn(t,e=dt,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&Ff(-1);const i=la(e);let o;try{o=t(...s)}finally{la(i),r._d&&Ff(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function ca(t,e){if(dt===null)return t;const n=Ka(dt),r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,l,c=$e]=e[s];i&&(me(i)&&(i={mounted:i,updated:i}),i.deep&&$n(o),r.push({dir:i,instance:n,value:o,oldValue:void 0,arg:l,modifiers:c}))}return t}function Pr(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const l=s[o];i&&(l.oldValue=i[o].value);let c=l.dir[r];c&&(vr(),mn(c,n,8,[t.el,l,t,e]),Er())}}const Cv=Symbol("_vte"),_p=t=>t.__isTeleport,rr=Symbol("_leaveCb"),Do=Symbol("_enterCb");function yp(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return za(()=>{t.isMounted=!0}),Sp(()=>{t.isUnmounting=!0}),t}const en=[Function,Array],wp={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:en,onEnter:en,onAfterEnter:en,onEnterCancelled:en,onBeforeLeave:en,onLeave:en,onAfterLeave:en,onLeaveCancelled:en,onBeforeAppear:en,onAppear:en,onAfterAppear:en,onAppearCancelled:en},vp=t=>{const e=t.subTree;return e.component?vp(e.component):e},Sv={name:"BaseTransition",props:wp,setup(t,{slots:e}){const n=Xp(),r=yp();return()=>{const s=e.default&&Au(e.default(),!0);if(!s||!s.length)return;const i=Ep(s),o=xe(t),{mode:l}=o;if(r.isLeaving)return Ul(i);const c=Rf(i);if(!c)return Ul(i);let u=Fi(c,o,r,n,d=>u=d);c.type!==Lt&&qr(c,u);let f=n.subTree&&Rf(n.subTree);if(f&&f.type!==Lt&&!Mr(c,f)&&vp(n).type!==Lt){let d=Fi(f,o,r,n);if(qr(f,d),l==="out-in"&&c.type!==Lt)return r.isLeaving=!0,d.afterLeave=()=>{r.isLeaving=!1,n.job.flags&8||n.update(),delete d.afterLeave,f=void 0},Ul(i);l==="in-out"&&c.type!==Lt?d.delayLeave=(p,g,S)=>{const R=bp(r,f);R[String(f.key)]=f,p[rr]=()=>{g(),p[rr]=void 0,delete u.delayedLeave,f=void 0},u.delayedLeave=()=>{S(),delete u.delayedLeave,f=void 0}}:f=void 0}else f&&(f=void 0);return i}}};function Ep(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==Lt){e=n;break}}return e}const Rv=Sv;function bp(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function Fi(t,e,n,r,s){const{appear:i,mode:o,persisted:l=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:f,onEnterCancelled:d,onBeforeLeave:p,onLeave:g,onAfterLeave:S,onLeaveCancelled:R,onBeforeAppear:x,onAppear:j,onAfterAppear:D,onAppearCancelled:O}=e,N=String(t.key),ne=bp(n,t),Q=(y,b)=>{y&&mn(y,r,9,b)},T=(y,b)=>{const A=b[1];Q(y,b),he(y)?y.every(I=>I.length<=1)&&A():y.length<=1&&A()},w={mode:o,persisted:l,beforeEnter(y){let b=c;if(!n.isMounted)if(i)b=x||c;else return;y[rr]&&y[rr](!0);const A=ne[N];A&&Mr(t,A)&&A.el[rr]&&A.el[rr](),Q(b,[y])},enter(y){let b=u,A=f,I=d;if(!n.isMounted)if(i)b=j||u,A=D||f,I=O||d;else return;let v=!1;const Se=y[Do]=We=>{v||(v=!0,We?Q(I,[y]):Q(A,[y]),w.delayedLeave&&w.delayedLeave(),y[Do]=void 0)};b?T(b,[y,Se]):Se()},leave(y,b){const A=String(t.key);if(y[Do]&&y[Do](!0),n.isUnmounting)return b();Q(p,[y]);let I=!1;const v=y[rr]=Se=>{I||(I=!0,b(),Se?Q(R,[y]):Q(S,[y]),y[rr]=void 0,ne[A]===t&&delete ne[A])};ne[A]=t,g?T(g,[y,v]):v()},clone(y){const b=Fi(y,e,n,r,s);return s&&s(b),b}};return w}function Ul(t){if(qa(t))return t=fr(t),t.children=null,t}function Rf(t){if(!qa(t))return _p(t.type)&&t.children?Ep(t.children):t;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&me(n.default))return n.default()}}function qr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,qr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Au(t,e=!1,n){let r=[],s=0;for(let i=0;i<t.length;i++){let o=t[i];const l=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===Ze?(o.patchFlag&128&&s++,r=r.concat(Au(o.children,e,l))):(e||o.type!==Lt)&&r.push(l!=null?fr(o,{key:l}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function Tp(t,e){return me(t)?ct({name:t.name},e,{setup:t}):t}function Ap(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function ua(t,e,n,r,s=!1){if(he(t)){t.forEach((S,R)=>ua(S,e&&(he(e)?e[R]:e),n,r,s));return}if(ws(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&ua(t,e,n,r.component.subTree);return}const i=r.shapeFlag&4?Ka(r.component):r.el,o=s?null:i,{i:l,r:c}=t,u=e&&e.r,f=l.refs===$e?l.refs={}:l.refs,d=l.setupState,p=xe(d),g=d===$e?()=>!1:S=>Ne(p,S);if(u!=null&&u!==c&&(et(u)?(f[u]=null,g(u)&&(d[u]=null)):kt(u)&&(u.value=null)),me(c))to(c,l,12,[o,f]);else{const S=et(c),R=kt(c);if(S||R){const x=()=>{if(t.f){const j=S?g(c)?d[c]:f[c]:c.value;s?he(j)&&mu(j,i):he(j)?j.includes(i)||j.push(i):S?(f[c]=[i],g(c)&&(d[c]=f[c])):(c.value=[i],t.k&&(f[t.k]=c.value))}else S?(f[c]=o,g(c)&&(d[c]=o)):R&&(c.value=o,t.k&&(f[t.k]=o))};o?(x.id=-1,Gt(x,n)):x()}}}La().requestIdleCallback;La().cancelIdleCallback;const ws=t=>!!t.type.__asyncLoader,qa=t=>t.type.__isKeepAlive;function Pv(t,e){Ip(t,"a",e)}function xv(t,e){Ip(t,"da",e)}function Ip(t,e,n=wt){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Ha(e,r,n),n){let s=n.parent;for(;s&&s.parent;)qa(s.parent.vnode)&&Vv(r,e,n,s),s=s.parent}}function Vv(t,e,n,r){const s=Ha(e,t,r,!0);Rp(()=>{mu(r[e],s)},n)}function Ha(t,e,n=wt,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{vr();const l=no(n),c=mn(e,n,t,o);return l(),Er(),c});return r?s.unshift(i):s.push(i),i}}const Wn=t=>(e,n=wt)=>{(!$i||t==="sp")&&Ha(t,(...r)=>e(...r),n)},Dv=Wn("bm"),za=Wn("m"),kv=Wn("bu"),Cp=Wn("u"),Sp=Wn("bum"),Rp=Wn("um"),Nv=Wn("sp"),Ov=Wn("rtg"),Mv=Wn("rtc");function Lv(t,e=wt){Ha("ec",t,e)}const Fv="components";function hr(t,e){return Uv(Fv,t,!0,e)||t}const Bv=Symbol.for("v-ndc");function Uv(t,e,n=!0,r=!1){const s=dt||wt;if(s){const i=s.type;{const l=SE(i,!1);if(l&&(l===e||l===sn(e)||l===Ma(sn(e))))return i}const o=Pf(s[t]||i[t],e)||Pf(s.appContext[t],e);return!o&&r?i:o}}function Pf(t,e){return t&&(t[e]||t[sn(e)]||t[Ma(sn(e))])}function Ho(t,e,n,r){let s;const i=n,o=he(t);if(o||et(t)){const l=o&&gs(t);let c=!1;l&&(c=!nn(t),t=Ua(t)),s=new Array(t.length);for(let u=0,f=t.length;u<f;u++)s[u]=e(c?Vt(t[u]):t[u],u,void 0,i)}else if(typeof t=="number"){s=new Array(t);for(let l=0;l<t;l++)s[l]=e(l+1,l,void 0,i)}else if(Ge(t))if(t[Symbol.iterator])s=Array.from(t,(l,c)=>e(l,c,void 0,i));else{const l=Object.keys(t);s=new Array(l.length);for(let c=0,u=l.length;c<u;c++){const f=l[c];s[c]=e(t[f],f,c,i)}}else s=[];return s}function $v(t,e,n={},r,s){if(dt.ce||dt.parent&&ws(dt.parent)&&dt.parent.ce)return ge(),Cc(Ze,null,[Me("slot",n,r)],64);let i=t[e];i&&i._c&&(i._d=!1),ge();const o=i&&Pp(i(n)),l=n.key||o&&o.key,c=Cc(Ze,{key:(l&&!Gn(l)?l:`_${e}`)+""},o||[],o&&t._===1?64:-2);return c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),i&&i._c&&(i._d=!0),c}function Pp(t){return t.some(e=>Ui(e)?!(e.type===Lt||e.type===Ze&&!Pp(e.children)):!0)?t:null}const bc=t=>t?Jp(t)?Ka(t):bc(t.parent):null,Ii=ct(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>bc(t.parent),$root:t=>bc(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Vp(t),$forceUpdate:t=>t.f||(t.f=()=>{Tu(t.update)}),$nextTick:t=>t.n||(t.n=fp.bind(t.proxy)),$watch:t=>lE.bind(t)}),$l=(t,e)=>t!==$e&&!t.__isScriptSetup&&Ne(t,e),jv={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:l,appContext:c}=t;let u;if(e[0]!=="$"){const g=o[e];if(g!==void 0)switch(g){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if($l(r,e))return o[e]=1,r[e];if(s!==$e&&Ne(s,e))return o[e]=2,s[e];if((u=t.propsOptions[0])&&Ne(u,e))return o[e]=3,i[e];if(n!==$e&&Ne(n,e))return o[e]=4,n[e];Tc&&(o[e]=0)}}const f=Ii[e];let d,p;if(f)return e==="$attrs"&&xt(t.attrs,"get",""),f(t);if((d=l.__cssModules)&&(d=d[e]))return d;if(n!==$e&&Ne(n,e))return o[e]=4,n[e];if(p=c.config.globalProperties,Ne(p,e))return p[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return $l(s,e)?(s[e]=n,!0):r!==$e&&Ne(r,e)?(r[e]=n,!0):Ne(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let l;return!!n[o]||t!==$e&&Ne(t,o)||$l(e,o)||(l=i[0])&&Ne(l,o)||Ne(r,o)||Ne(Ii,o)||Ne(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ne(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function xf(t){return he(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Tc=!0;function qv(t){const e=Vp(t),n=t.proxy,r=t.ctx;Tc=!1,e.beforeCreate&&Vf(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:l,provide:c,inject:u,created:f,beforeMount:d,mounted:p,beforeUpdate:g,updated:S,activated:R,deactivated:x,beforeDestroy:j,beforeUnmount:D,destroyed:O,unmounted:N,render:ne,renderTracked:Q,renderTriggered:T,errorCaptured:w,serverPrefetch:y,expose:b,inheritAttrs:A,components:I,directives:v,filters:Se}=e;if(u&&Hv(u,r,null),o)for(const z in o){const Z=o[z];me(Z)&&(r[z]=Z.bind(n))}if(s){const z=s.call(n,n);Ge(z)&&(t.data=$a(z))}if(Tc=!0,i)for(const z in i){const Z=i[z],De=me(Z)?Z.bind(n,n):me(Z.get)?Z.get.bind(n,n):Rn,Le=!me(Z)&&me(Z.set)?Z.set.bind(n):Rn,nt=Qt({get:De,set:Le});Object.defineProperty(r,z,{enumerable:!0,configurable:!0,get:()=>nt.value,set:Be=>nt.value=Be})}if(l)for(const z in l)xp(l[z],r,n,z);if(c){const z=me(c)?c.call(n):c;Reflect.ownKeys(z).forEach(Z=>{zo(Z,z[Z])})}f&&Vf(f,t,"c");function He(z,Z){he(Z)?Z.forEach(De=>z(De.bind(n))):Z&&z(Z.bind(n))}if(He(Dv,d),He(za,p),He(kv,g),He(Cp,S),He(Pv,R),He(xv,x),He(Lv,w),He(Mv,Q),He(Ov,T),He(Sp,D),He(Rp,N),He(Nv,y),he(b))if(b.length){const z=t.exposed||(t.exposed={});b.forEach(Z=>{Object.defineProperty(z,Z,{get:()=>n[Z],set:De=>n[Z]=De})})}else t.exposed||(t.exposed={});ne&&t.render===Rn&&(t.render=ne),A!=null&&(t.inheritAttrs=A),I&&(t.components=I),v&&(t.directives=v),y&&Ap(t)}function Hv(t,e,n=Rn){he(t)&&(t=Ac(t));for(const r in t){const s=t[r];let i;Ge(s)?"default"in s?i=dn(s.from||r,s.default,!0):i=dn(s.from||r):i=dn(s),kt(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function Vf(t,e,n){mn(he(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function xp(t,e,n,r){let s=r.includes(".")?zp(n,r):()=>n[r];if(et(t)){const i=e[t];me(i)&&Es(s,i)}else if(me(t))Es(s,t.bind(n));else if(Ge(t))if(he(t))t.forEach(i=>xp(i,e,n,r));else{const i=me(t.handler)?t.handler.bind(n):e[t.handler];me(i)&&Es(s,i,t)}}function Vp(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,l=i.get(e);let c;return l?c=l:!s.length&&!n&&!r?c=e:(c={},s.length&&s.forEach(u=>ha(c,u,o,!0)),ha(c,e,o)),Ge(e)&&i.set(e,c),c}function ha(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&ha(t,i,n,!0),s&&s.forEach(o=>ha(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const l=zv[o]||n&&n[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const zv={data:Df,props:kf,emits:kf,methods:ui,computed:ui,beforeCreate:Ot,created:Ot,beforeMount:Ot,mounted:Ot,beforeUpdate:Ot,updated:Ot,beforeDestroy:Ot,beforeUnmount:Ot,destroyed:Ot,unmounted:Ot,activated:Ot,deactivated:Ot,errorCaptured:Ot,serverPrefetch:Ot,components:ui,directives:ui,watch:Wv,provide:Df,inject:Gv};function Df(t,e){return e?t?function(){return ct(me(t)?t.call(this,this):t,me(e)?e.call(this,this):e)}:e:t}function Gv(t,e){return ui(Ac(t),Ac(e))}function Ac(t){if(he(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Ot(t,e){return t?[...new Set([].concat(t,e))]:e}function ui(t,e){return t?ct(Object.create(null),t,e):e}function kf(t,e){return t?he(t)&&he(e)?[...new Set([...t,...e])]:ct(Object.create(null),xf(t),xf(e??{})):e}function Wv(t,e){if(!t)return e;if(!e)return t;const n=ct(Object.create(null),t);for(const r in e)n[r]=Ot(t[r],e[r]);return n}function Dp(){return{app:null,config:{isNativeTag:Lw,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Kv=0;function Qv(t,e){return function(r,s=null){me(r)||(r=ct({},r)),s!=null&&!Ge(s)&&(s=null);const i=Dp(),o=new WeakSet,l=[];let c=!1;const u=i.app={_uid:Kv++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:PE,get config(){return i.config},set config(f){},use(f,...d){return o.has(f)||(f&&me(f.install)?(o.add(f),f.install(u,...d)):me(f)&&(o.add(f),f(u,...d))),u},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),u},component(f,d){return d?(i.components[f]=d,u):i.components[f]},directive(f,d){return d?(i.directives[f]=d,u):i.directives[f]},mount(f,d,p){if(!c){const g=u._ceVNode||Me(r,s);return g.appContext=i,p===!0?p="svg":p===!1&&(p=void 0),t(g,f,p),c=!0,u._container=f,f.__vue_app__=u,Ka(g.component)}},onUnmount(f){l.push(f)},unmount(){c&&(mn(l,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(f,d){return i.provides[f]=d,u},runWithContext(f){const d=vs;vs=u;try{return f()}finally{vs=d}}};return u}}let vs=null;function zo(t,e){if(wt){let n=wt.provides;const r=wt.parent&&wt.parent.provides;r===n&&(n=wt.provides=Object.create(r)),n[t]=e}}function dn(t,e,n=!1){const r=wt||dt;if(r||vs){const s=vs?vs._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&me(e)?e.call(r&&r.proxy):e}}const kp={},Np=()=>Object.create(kp),Op=t=>Object.getPrototypeOf(t)===kp;function Xv(t,e,n,r=!1){const s={},i=Np();t.propsDefaults=Object.create(null),Mp(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:ap(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function Jv(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,l=xe(s),[c]=t.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const f=t.vnode.dynamicProps;for(let d=0;d<f.length;d++){let p=f[d];if(Ga(t.emitsOptions,p))continue;const g=e[p];if(c)if(Ne(i,p))g!==i[p]&&(i[p]=g,u=!0);else{const S=sn(p);s[S]=Ic(c,l,S,g,t,!1)}else g!==i[p]&&(i[p]=g,u=!0)}}}else{Mp(t,e,s,i)&&(u=!0);let f;for(const d in l)(!e||!Ne(e,d)&&((f=wr(d))===d||!Ne(e,f)))&&(c?n&&(n[d]!==void 0||n[f]!==void 0)&&(s[d]=Ic(c,l,d,void 0,t,!0)):delete s[d]);if(i!==l)for(const d in i)(!e||!Ne(e,d))&&(delete i[d],u=!0)}u&&Un(t.attrs,"set","")}function Mp(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,l;if(e)for(let c in e){if(bi(c))continue;const u=e[c];let f;s&&Ne(s,f=sn(c))?!i||!i.includes(f)?n[f]=u:(l||(l={}))[f]=u:Ga(t.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,o=!0)}if(i){const c=xe(n),u=l||$e;for(let f=0;f<i.length;f++){const d=i[f];n[d]=Ic(s,c,d,u[d],t,!Ne(u,d))}}return o}function Ic(t,e,n,r,s,i){const o=t[n];if(o!=null){const l=Ne(o,"default");if(l&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&me(c)){const{propsDefaults:u}=s;if(n in u)r=u[n];else{const f=no(s);r=u[n]=c.call(null,e),f()}}else r=c;s.ce&&s.ce._setProp(n,r)}o[0]&&(i&&!l?r=!1:o[1]&&(r===""||r===wr(n))&&(r=!0))}return r}const Yv=new WeakMap;function Lp(t,e,n=!1){const r=n?Yv:e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},l=[];let c=!1;if(!me(t)){const f=d=>{c=!0;const[p,g]=Lp(d,e,!0);ct(o,p),g&&l.push(...g)};!n&&e.mixins.length&&e.mixins.forEach(f),t.extends&&f(t.extends),t.mixins&&t.mixins.forEach(f)}if(!i&&!c)return Ge(t)&&r.set(t,ms),ms;if(he(i))for(let f=0;f<i.length;f++){const d=sn(i[f]);Nf(d)&&(o[d]=$e)}else if(i)for(const f in i){const d=sn(f);if(Nf(d)){const p=i[f],g=o[d]=he(p)||me(p)?{type:p}:ct({},p),S=g.type;let R=!1,x=!0;if(he(S))for(let j=0;j<S.length;++j){const D=S[j],O=me(D)&&D.name;if(O==="Boolean"){R=!0;break}else O==="String"&&(x=!1)}else R=me(S)&&S.name==="Boolean";g[0]=R,g[1]=x,(R||Ne(g,"default"))&&l.push(d)}}const u=[o,l];return Ge(t)&&r.set(t,u),u}function Nf(t){return t[0]!=="$"&&!bi(t)}const Fp=t=>t[0]==="_"||t==="$stable",Iu=t=>he(t)?t.map(Cn):[Cn(t)],Zv=(t,e,n)=>{if(e._n)return e;const r=tn((...s)=>Iu(e(...s)),n);return r._c=!1,r},Bp=(t,e,n)=>{const r=t._ctx;for(const s in t){if(Fp(s))continue;const i=t[s];if(me(i))e[s]=Zv(s,i,r);else if(i!=null){const o=Iu(i);e[s]=()=>o}}},Up=(t,e)=>{const n=Iu(e);t.slots.default=()=>n},$p=(t,e,n)=>{for(const r in e)(n||r!=="_")&&(t[r]=e[r])},eE=(t,e,n)=>{const r=t.slots=Np();if(t.vnode.shapeFlag&32){const s=e._;s?($p(r,e,n),n&&qm(r,"_",s,!0)):Bp(e,r)}else e&&Up(t,e)},tE=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=$e;if(r.shapeFlag&32){const l=e._;l?n&&l===1?i=!1:$p(s,e,n):(i=!e.$stable,Bp(e,s)),o=e}else e&&(Up(t,e),o={default:1});if(i)for(const l in s)!Fp(l)&&o[l]==null&&delete s[l]},Gt=pE;function nE(t){return rE(t)}function rE(t,e){const n=La();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:l,createComment:c,setText:u,setElementText:f,parentNode:d,nextSibling:p,setScopeId:g=Rn,insertStaticContent:S}=t,R=(E,C,P,L=null,U=null,F=null,X=void 0,W=null,G=!!C.dynamicChildren)=>{if(E===C)return;E&&!Mr(E,C)&&(L=M(E),Be(E,U,F,!0),E=null),C.patchFlag===-2&&(G=!1,C.dynamicChildren=null);const{type:H,ref:le,shapeFlag:Y}=C;switch(H){case Wa:x(E,C,P,L);break;case Lt:j(E,C,P,L);break;case ql:E==null&&D(C,P,L,X);break;case Ze:I(E,C,P,L,U,F,X,W,G);break;default:Y&1?ne(E,C,P,L,U,F,X,W,G):Y&6?v(E,C,P,L,U,F,X,W,G):(Y&64||Y&128)&&H.process(E,C,P,L,U,F,X,W,G,re)}le!=null&&U&&ua(le,E&&E.ref,F,C||E,!C)},x=(E,C,P,L)=>{if(E==null)r(C.el=l(C.children),P,L);else{const U=C.el=E.el;C.children!==E.children&&u(U,C.children)}},j=(E,C,P,L)=>{E==null?r(C.el=c(C.children||""),P,L):C.el=E.el},D=(E,C,P,L)=>{[E.el,E.anchor]=S(E.children,C,P,L,E.el,E.anchor)},O=({el:E,anchor:C},P,L)=>{let U;for(;E&&E!==C;)U=p(E),r(E,P,L),E=U;r(C,P,L)},N=({el:E,anchor:C})=>{let P;for(;E&&E!==C;)P=p(E),s(E),E=P;s(C)},ne=(E,C,P,L,U,F,X,W,G)=>{C.type==="svg"?X="svg":C.type==="math"&&(X="mathml"),E==null?Q(C,P,L,U,F,X,W,G):y(E,C,U,F,X,W,G)},Q=(E,C,P,L,U,F,X,W)=>{let G,H;const{props:le,shapeFlag:Y,transition:ie,dirs:ue}=E;if(G=E.el=o(E.type,F,le&&le.is,le),Y&8?f(G,E.children):Y&16&&w(E.children,G,null,L,U,jl(E,F),X,W),ue&&Pr(E,null,L,"created"),T(G,E,E.scopeId,X,L),le){for(const _e in le)_e!=="value"&&!bi(_e)&&i(G,_e,null,le[_e],F,L);"value"in le&&i(G,"value",null,le.value,F),(H=le.onVnodeBeforeMount)&&vn(H,L,E)}ue&&Pr(E,null,L,"beforeMount");const ce=sE(U,ie);ce&&ie.beforeEnter(G),r(G,C,P),((H=le&&le.onVnodeMounted)||ce||ue)&&Gt(()=>{H&&vn(H,L,E),ce&&ie.enter(G),ue&&Pr(E,null,L,"mounted")},U)},T=(E,C,P,L,U)=>{if(P&&g(E,P),L)for(let F=0;F<L.length;F++)g(E,L[F]);if(U){let F=U.subTree;if(C===F||Wp(F.type)&&(F.ssContent===C||F.ssFallback===C)){const X=U.vnode;T(E,X,X.scopeId,X.slotScopeIds,U.parent)}}},w=(E,C,P,L,U,F,X,W,G=0)=>{for(let H=G;H<E.length;H++){const le=E[H]=W?sr(E[H]):Cn(E[H]);R(null,le,C,P,L,U,F,X,W)}},y=(E,C,P,L,U,F,X)=>{const W=C.el=E.el;let{patchFlag:G,dynamicChildren:H,dirs:le}=C;G|=E.patchFlag&16;const Y=E.props||$e,ie=C.props||$e;let ue;if(P&&xr(P,!1),(ue=ie.onVnodeBeforeUpdate)&&vn(ue,P,C,E),le&&Pr(C,E,P,"beforeUpdate"),P&&xr(P,!0),(Y.innerHTML&&ie.innerHTML==null||Y.textContent&&ie.textContent==null)&&f(W,""),H?b(E.dynamicChildren,H,W,P,L,jl(C,U),F):X||Z(E,C,W,null,P,L,jl(C,U),F,!1),G>0){if(G&16)A(W,Y,ie,P,U);else if(G&2&&Y.class!==ie.class&&i(W,"class",null,ie.class,U),G&4&&i(W,"style",Y.style,ie.style,U),G&8){const ce=C.dynamicProps;for(let _e=0;_e<ce.length;_e++){const Te=ce[_e],Tt=Y[Te],mt=ie[Te];(mt!==Tt||Te==="value")&&i(W,Te,Tt,mt,U,P)}}G&1&&E.children!==C.children&&f(W,C.children)}else!X&&H==null&&A(W,Y,ie,P,U);((ue=ie.onVnodeUpdated)||le)&&Gt(()=>{ue&&vn(ue,P,C,E),le&&Pr(C,E,P,"updated")},L)},b=(E,C,P,L,U,F,X)=>{for(let W=0;W<C.length;W++){const G=E[W],H=C[W],le=G.el&&(G.type===Ze||!Mr(G,H)||G.shapeFlag&70)?d(G.el):P;R(G,H,le,null,L,U,F,X,!0)}},A=(E,C,P,L,U)=>{if(C!==P){if(C!==$e)for(const F in C)!bi(F)&&!(F in P)&&i(E,F,C[F],null,U,L);for(const F in P){if(bi(F))continue;const X=P[F],W=C[F];X!==W&&F!=="value"&&i(E,F,W,X,U,L)}"value"in P&&i(E,"value",C.value,P.value,U)}},I=(E,C,P,L,U,F,X,W,G)=>{const H=C.el=E?E.el:l(""),le=C.anchor=E?E.anchor:l("");let{patchFlag:Y,dynamicChildren:ie,slotScopeIds:ue}=C;ue&&(W=W?W.concat(ue):ue),E==null?(r(H,P,L),r(le,P,L),w(C.children||[],P,le,U,F,X,W,G)):Y>0&&Y&64&&ie&&E.dynamicChildren?(b(E.dynamicChildren,ie,P,U,F,X,W),(C.key!=null||U&&C===U.subTree)&&jp(E,C,!0)):Z(E,C,P,le,U,F,X,W,G)},v=(E,C,P,L,U,F,X,W,G)=>{C.slotScopeIds=W,E==null?C.shapeFlag&512?U.ctx.activate(C,P,L,X,G):Se(C,P,L,U,F,X,G):We(E,C,G)},Se=(E,C,P,L,U,F,X)=>{const W=E.component=bE(E,L,U);if(qa(E)&&(W.ctx.renderer=re),TE(W,!1,X),W.asyncDep){if(U&&U.registerDep(W,He,X),!E.el){const G=W.subTree=Me(Lt);j(null,G,C,P)}}else He(W,E,C,P,U,F,X)},We=(E,C,P)=>{const L=C.component=E.component;if(dE(E,C,P))if(L.asyncDep&&!L.asyncResolved){z(L,C,P);return}else L.next=C,L.update();else C.el=E.el,L.vnode=C},He=(E,C,P,L,U,F,X)=>{const W=()=>{if(E.isMounted){let{next:Y,bu:ie,u:ue,parent:ce,vnode:_e}=E;{const At=qp(E);if(At){Y&&(Y.el=_e.el,z(E,Y,X)),At.asyncDep.then(()=>{E.isUnmounted||W()});return}}let Te=Y,Tt;xr(E,!1),Y?(Y.el=_e.el,z(E,Y,X)):Y=_e,ie&&qo(ie),(Tt=Y.props&&Y.props.onVnodeBeforeUpdate)&&vn(Tt,ce,Y,_e),xr(E,!0);const mt=Mf(E),Yt=E.subTree;E.subTree=mt,R(Yt,mt,d(Yt.el),M(Yt),E,U,F),Y.el=mt.el,Te===null&&mE(E,mt.el),ue&&Gt(ue,U),(Tt=Y.props&&Y.props.onVnodeUpdated)&&Gt(()=>vn(Tt,ce,Y,_e),U)}else{let Y;const{el:ie,props:ue}=C,{bm:ce,m:_e,parent:Te,root:Tt,type:mt}=E,Yt=ws(C);xr(E,!1),ce&&qo(ce),!Yt&&(Y=ue&&ue.onVnodeBeforeMount)&&vn(Y,Te,C),xr(E,!0);{Tt.ce&&Tt.ce._injectChildStyle(mt);const At=E.subTree=Mf(E);R(null,At,P,L,E,U,F),C.el=At.el}if(_e&&Gt(_e,U),!Yt&&(Y=ue&&ue.onVnodeMounted)){const At=C;Gt(()=>vn(Y,Te,At),U)}(C.shapeFlag&256||Te&&ws(Te.vnode)&&Te.vnode.shapeFlag&256)&&E.a&&Gt(E.a,U),E.isMounted=!0,C=P=L=null}};E.scope.on();const G=E.effect=new Wm(W);E.scope.off();const H=E.update=G.run.bind(G),le=E.job=G.runIfDirty.bind(G);le.i=E,le.id=E.uid,G.scheduler=()=>Tu(le),xr(E,!0),H()},z=(E,C,P)=>{C.component=E;const L=E.vnode.props;E.vnode=C,E.next=null,Jv(E,C.props,L,P),tE(E,C.children,P),vr(),Sf(E),Er()},Z=(E,C,P,L,U,F,X,W,G=!1)=>{const H=E&&E.children,le=E?E.shapeFlag:0,Y=C.children,{patchFlag:ie,shapeFlag:ue}=C;if(ie>0){if(ie&128){Le(H,Y,P,L,U,F,X,W,G);return}else if(ie&256){De(H,Y,P,L,U,F,X,W,G);return}}ue&8?(le&16&&Ft(H,U,F),Y!==H&&f(P,Y)):le&16?ue&16?Le(H,Y,P,L,U,F,X,W,G):Ft(H,U,F,!0):(le&8&&f(P,""),ue&16&&w(Y,P,L,U,F,X,W,G))},De=(E,C,P,L,U,F,X,W,G)=>{E=E||ms,C=C||ms;const H=E.length,le=C.length,Y=Math.min(H,le);let ie;for(ie=0;ie<Y;ie++){const ue=C[ie]=G?sr(C[ie]):Cn(C[ie]);R(E[ie],ue,P,null,U,F,X,W,G)}H>le?Ft(E,U,F,!0,!1,Y):w(C,P,L,U,F,X,W,G,Y)},Le=(E,C,P,L,U,F,X,W,G)=>{let H=0;const le=C.length;let Y=E.length-1,ie=le-1;for(;H<=Y&&H<=ie;){const ue=E[H],ce=C[H]=G?sr(C[H]):Cn(C[H]);if(Mr(ue,ce))R(ue,ce,P,null,U,F,X,W,G);else break;H++}for(;H<=Y&&H<=ie;){const ue=E[Y],ce=C[ie]=G?sr(C[ie]):Cn(C[ie]);if(Mr(ue,ce))R(ue,ce,P,null,U,F,X,W,G);else break;Y--,ie--}if(H>Y){if(H<=ie){const ue=ie+1,ce=ue<le?C[ue].el:L;for(;H<=ie;)R(null,C[H]=G?sr(C[H]):Cn(C[H]),P,ce,U,F,X,W,G),H++}}else if(H>ie)for(;H<=Y;)Be(E[H],U,F,!0),H++;else{const ue=H,ce=H,_e=new Map;for(H=ce;H<=ie;H++){const pt=C[H]=G?sr(C[H]):Cn(C[H]);pt.key!=null&&_e.set(pt.key,H)}let Te,Tt=0;const mt=ie-ce+1;let Yt=!1,At=0;const Kn=new Array(mt);for(H=0;H<mt;H++)Kn[H]=0;for(H=ue;H<=Y;H++){const pt=E[H];if(Tt>=mt){Be(pt,U,F,!0);continue}let Zt;if(pt.key!=null)Zt=_e.get(pt.key);else for(Te=ce;Te<=ie;Te++)if(Kn[Te-ce]===0&&Mr(pt,C[Te])){Zt=Te;break}Zt===void 0?Be(pt,U,F,!0):(Kn[Zt-ce]=H+1,Zt>=At?At=Zt:Yt=!0,R(pt,C[Zt],P,null,U,F,X,W,G),Tt++)}const Ks=Yt?iE(Kn):ms;for(Te=Ks.length-1,H=mt-1;H>=0;H--){const pt=ce+H,Zt=C[pt],fo=pt+1<le?C[pt+1].el:L;Kn[H]===0?R(null,Zt,P,fo,U,F,X,W,G):Yt&&(Te<0||H!==Ks[Te]?nt(Zt,P,fo,2):Te--)}}},nt=(E,C,P,L,U=null)=>{const{el:F,type:X,transition:W,children:G,shapeFlag:H}=E;if(H&6){nt(E.component.subTree,C,P,L);return}if(H&128){E.suspense.move(C,P,L);return}if(H&64){X.move(E,C,P,re);return}if(X===Ze){r(F,C,P);for(let Y=0;Y<G.length;Y++)nt(G[Y],C,P,L);r(E.anchor,C,P);return}if(X===ql){O(E,C,P);return}if(L!==2&&H&1&&W)if(L===0)W.beforeEnter(F),r(F,C,P),Gt(()=>W.enter(F),U);else{const{leave:Y,delayLeave:ie,afterLeave:ue}=W,ce=()=>r(F,C,P),_e=()=>{Y(F,()=>{ce(),ue&&ue()})};ie?ie(F,ce,_e):_e()}else r(F,C,P)},Be=(E,C,P,L=!1,U=!1)=>{const{type:F,props:X,ref:W,children:G,dynamicChildren:H,shapeFlag:le,patchFlag:Y,dirs:ie,cacheIndex:ue}=E;if(Y===-2&&(U=!1),W!=null&&ua(W,null,P,E,!0),ue!=null&&(C.renderCache[ue]=void 0),le&256){C.ctx.deactivate(E);return}const ce=le&1&&ie,_e=!ws(E);let Te;if(_e&&(Te=X&&X.onVnodeBeforeUnmount)&&vn(Te,C,E),le&6)wn(E.component,P,L);else{if(le&128){E.suspense.unmount(P,L);return}ce&&Pr(E,null,C,"beforeUnmount"),le&64?E.type.remove(E,C,P,re,L):H&&!H.hasOnce&&(F!==Ze||Y>0&&Y&64)?Ft(H,C,P,!1,!0):(F===Ze&&Y&384||!U&&le&16)&&Ft(G,C,P),L&&je(E)}(_e&&(Te=X&&X.onVnodeUnmounted)||ce)&&Gt(()=>{Te&&vn(Te,C,E),ce&&Pr(E,null,C,"unmounted")},P)},je=E=>{const{type:C,el:P,anchor:L,transition:U}=E;if(C===Ze){on(P,L);return}if(C===ql){N(E);return}const F=()=>{s(P),U&&!U.persisted&&U.afterLeave&&U.afterLeave()};if(E.shapeFlag&1&&U&&!U.persisted){const{leave:X,delayLeave:W}=U,G=()=>X(P,F);W?W(E.el,F,G):G()}else F()},on=(E,C)=>{let P;for(;E!==C;)P=p(E),s(E),E=P;s(C)},wn=(E,C,P)=>{const{bum:L,scope:U,job:F,subTree:X,um:W,m:G,a:H}=E;Of(G),Of(H),L&&qo(L),U.stop(),F&&(F.flags|=8,Be(X,E,C,P)),W&&Gt(W,C),Gt(()=>{E.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},Ft=(E,C,P,L=!1,U=!1,F=0)=>{for(let X=F;X<E.length;X++)Be(E[X],C,P,L,U)},M=E=>{if(E.shapeFlag&6)return M(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const C=p(E.anchor||E.el),P=C&&C[Cv];return P?p(P):C};let ee=!1;const J=(E,C,P)=>{E==null?C._vnode&&Be(C._vnode,null,null,!0):R(C._vnode||null,E,C,null,null,null,P),C._vnode=E,ee||(ee=!0,Sf(),mp(),ee=!1)},re={p:R,um:Be,m:nt,r:je,mt:Se,mc:w,pc:Z,pbc:b,n:M,o:t};return{render:J,hydrate:void 0,createApp:Qv(J)}}function jl({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function xr({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function sE(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function jp(t,e,n=!1){const r=t.children,s=e.children;if(he(r)&&he(s))for(let i=0;i<r.length;i++){const o=r[i];let l=s[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[i]=sr(s[i]),l.el=o.el),!n&&l.patchFlag!==-2&&jp(o,l)),l.type===Wa&&(l.el=o.el)}}function iE(t){const e=t.slice(),n=[0];let r,s,i,o,l;const c=t.length;for(r=0;r<c;r++){const u=t[r];if(u!==0){if(s=n[n.length-1],t[s]<u){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)l=i+o>>1,t[n[l]]<u?i=l+1:o=l;u<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function qp(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:qp(e)}function Of(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const oE=Symbol.for("v-scx"),aE=()=>dn(oE);function Es(t,e,n){return Hp(t,e,n)}function Hp(t,e,n=$e){const{immediate:r,deep:s,flush:i,once:o}=n,l=ct({},n),c=e&&r||!e&&i!=="post";let u;if($i){if(i==="sync"){const g=aE();u=g.__watcherHandles||(g.__watcherHandles=[])}else if(!c){const g=()=>{};return g.stop=Rn,g.resume=Rn,g.pause=Rn,g}}const f=wt;l.call=(g,S,R)=>mn(g,f,S,R);let d=!1;i==="post"?l.scheduler=g=>{Gt(g,f&&f.suspense)}:i!=="sync"&&(d=!0,l.scheduler=(g,S)=>{S?g():Tu(g)}),l.augmentJob=g=>{e&&(g.flags|=4),d&&(g.flags|=2,f&&(g.id=f.uid,g.i=f))};const p=bv(t,e,l);return $i&&(u?u.push(p):c&&p()),p}function lE(t,e,n){const r=this.proxy,s=et(t)?t.includes(".")?zp(r,t):()=>r[t]:t.bind(r,r);let i;me(e)?i=e:(i=e.handler,n=e);const o=no(this),l=Hp(s,i.bind(r),n);return o(),l}function zp(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}const cE=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${sn(e)}Modifiers`]||t[`${wr(e)}Modifiers`];function uE(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||$e;let s=n;const i=e.startsWith("update:"),o=i&&cE(r,e.slice(7));o&&(o.trim&&(s=n.map(f=>et(f)?f.trim():f)),o.number&&(s=n.map(gc)));let l,c=r[l=Ol(e)]||r[l=Ol(sn(e))];!c&&i&&(c=r[l=Ol(wr(e))]),c&&mn(c,t,6,s);const u=r[l+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,mn(u,t,6,s)}}function Gp(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},l=!1;if(!me(t)){const c=u=>{const f=Gp(u,e,!0);f&&(l=!0,ct(o,f))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!l?(Ge(t)&&r.set(t,null),null):(he(i)?i.forEach(c=>o[c]=null):ct(o,i),Ge(t)&&r.set(t,o),o)}function Ga(t,e){return!t||!ka(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ne(t,e[0].toLowerCase()+e.slice(1))||Ne(t,wr(e))||Ne(t,e))}function Mf(t){const{type:e,vnode:n,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:l,emit:c,render:u,renderCache:f,props:d,data:p,setupState:g,ctx:S,inheritAttrs:R}=t,x=la(t);let j,D;try{if(n.shapeFlag&4){const N=s||r,ne=N;j=Cn(u.call(ne,N,f,d,g,p,S)),D=l}else{const N=e;j=Cn(N.length>1?N(d,{attrs:l,slots:o,emit:c}):N(d,null)),D=e.props?l:hE(l)}}catch(N){Ci.length=0,ja(N,t,1),j=Me(Lt)}let O=j;if(D&&R!==!1){const N=Object.keys(D),{shapeFlag:ne}=O;N.length&&ne&7&&(i&&N.some(du)&&(D=fE(D,i)),O=fr(O,D,!1,!0))}return n.dirs&&(O=fr(O,null,!1,!0),O.dirs=O.dirs?O.dirs.concat(n.dirs):n.dirs),n.transition&&qr(O,n.transition),j=O,la(x),j}const hE=t=>{let e;for(const n in t)(n==="class"||n==="style"||ka(n))&&((e||(e={}))[n]=t[n]);return e},fE=(t,e)=>{const n={};for(const r in t)(!du(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function dE(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:l,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Lf(r,o,u):!!o;if(c&8){const f=e.dynamicProps;for(let d=0;d<f.length;d++){const p=f[d];if(o[p]!==r[p]&&!Ga(u,p))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:r===o?!1:r?o?Lf(r,o,u):!0:!!o;return!1}function Lf(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!Ga(n,i))return!0}return!1}function mE({vnode:t,parent:e},n){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=n,e=e.parent;else break}}const Wp=t=>t.__isSuspense;function pE(t,e){e&&e.pendingBranch?he(t)?e.effects.push(...t):e.effects.push(t):Iv(t)}const Ze=Symbol.for("v-fgt"),Wa=Symbol.for("v-txt"),Lt=Symbol.for("v-cmt"),ql=Symbol.for("v-stc"),Ci=[];let Xt=null;function ge(t=!1){Ci.push(Xt=t?null:[])}function gE(){Ci.pop(),Xt=Ci[Ci.length-1]||null}let Bi=1;function Ff(t,e=!1){Bi+=t,t<0&&Xt&&e&&(Xt.hasOnce=!0)}function Kp(t){return t.dynamicChildren=Bi>0?Xt||ms:null,gE(),Bi>0&&Xt&&Xt.push(t),t}function we(t,e,n,r,s,i){return Kp($(t,e,n,r,s,i,!0))}function Cc(t,e,n,r,s){return Kp(Me(t,e,n,r,s,!0))}function Ui(t){return t?t.__v_isVNode===!0:!1}function Mr(t,e){return t.type===e.type&&t.key===e.key}const Qp=({key:t})=>t??null,Go=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?et(t)||kt(t)||me(t)?{i:dt,r:t,k:e,f:!!n}:t:null);function $(t,e=null,n=null,r=0,s=null,i=t===Ze?0:1,o=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Qp(e),ref:e&&Go(e),scopeId:gp,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:dt};return l?(Cu(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=et(n)?8:16),Bi>0&&!o&&Xt&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&Xt.push(c),c}const Me=_E;function _E(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===Bv)&&(t=Lt),Ui(t)){const l=fr(t,e,!0);return n&&Cu(l,n),Bi>0&&!i&&Xt&&(l.shapeFlag&6?Xt[Xt.indexOf(t)]=l:Xt.push(l)),l.patchFlag=-2,l}if(RE(t)&&(t=t.__vccOpts),e){e=yE(e);let{class:l,style:c}=e;l&&!et(l)&&(e.class=Ba(l)),Ge(c)&&(bu(c)&&!he(c)&&(c=ct({},c)),e.style=Fa(c))}const o=et(t)?1:Wp(t)?128:_p(t)?64:Ge(t)?4:me(t)?2:0;return $(t,e,n,r,s,o,i,!0)}function yE(t){return t?bu(t)||Op(t)?ct({},t):t:null}function fr(t,e,n=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:l,transition:c}=t,u=e?wE(s||{},e):s,f={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&Qp(u),ref:e&&e.ref?n&&i?he(i)?i.concat(Go(e)):[i,Go(e)]:Go(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ze?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&fr(t.ssContent),ssFallback:t.ssFallback&&fr(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&qr(f,c.clone(f)),f}function ft(t=" ",e=0){return Me(Wa,null,t,e)}function Nr(t="",e=!1){return e?(ge(),Cc(Lt,null,t)):Me(Lt,null,t)}function Cn(t){return t==null||typeof t=="boolean"?Me(Lt):he(t)?Me(Ze,null,t.slice()):Ui(t)?sr(t):Me(Wa,null,String(t))}function sr(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:fr(t)}function Cu(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(he(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Cu(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!Op(e)?e._ctx=dt:s===3&&dt&&(dt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else me(e)?(e={default:e,_ctx:dt},n=32):(e=String(e),r&64?(n=16,e=[ft(e)]):n=8);t.children=e,t.shapeFlag|=n}function wE(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Ba([e.class,r.class]));else if(s==="style")e.style=Fa([e.style,r.style]);else if(ka(s)){const i=e[s],o=r[s];o&&i!==o&&!(he(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function vn(t,e,n,r=null){mn(t,e,7,[n,r])}const vE=Dp();let EE=0;function bE(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||vE,i={uid:EE++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Qw(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Lp(r,s),emitsOptions:Gp(r,s),emit:null,emitted:null,propsDefaults:$e,inheritAttrs:r.inheritAttrs,ctx:$e,data:$e,props:$e,attrs:$e,slots:$e,refs:$e,setupState:$e,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=uE.bind(null,i),t.ce&&t.ce(i),i}let wt=null;const Xp=()=>wt||dt;let fa,Sc;{const t=La(),e=(n,r)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};fa=e("__VUE_INSTANCE_SETTERS__",n=>wt=n),Sc=e("__VUE_SSR_SETTERS__",n=>$i=n)}const no=t=>{const e=wt;return fa(t),t.scope.on(),()=>{t.scope.off(),fa(e)}},Bf=()=>{wt&&wt.scope.off(),fa(null)};function Jp(t){return t.vnode.shapeFlag&4}let $i=!1;function TE(t,e=!1,n=!1){e&&Sc(e);const{props:r,children:s}=t.vnode,i=Jp(t);Xv(t,r,i,e),eE(t,s,n);const o=i?AE(t,e):void 0;return e&&Sc(!1),o}function AE(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,jv);const{setup:r}=n;if(r){vr();const s=t.setupContext=r.length>1?CE(t):null,i=no(t),o=to(r,t,0,[t.props,s]),l=Um(o);if(Er(),i(),(l||t.sp)&&!ws(t)&&Ap(t),l){if(o.then(Bf,Bf),e)return o.then(c=>{Uf(t,c)}).catch(c=>{ja(c,t,0)});t.asyncDep=o}else Uf(t,o)}else Yp(t)}function Uf(t,e,n){me(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ge(e)&&(t.setupState=up(e)),Yp(t)}function Yp(t,e,n){const r=t.type;t.render||(t.render=r.render||Rn);{const s=no(t);vr();try{qv(t)}finally{Er(),s()}}}const IE={get(t,e){return xt(t,"get",""),t[e]}};function CE(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,IE),slots:t.slots,emit:t.emit,expose:e}}function Ka(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(up(pv(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Ii)return Ii[n](t)},has(e,n){return n in e||n in Ii}})):t.proxy}function SE(t,e=!0){return me(t)?t.displayName||t.name:t.name||e&&t.__name}function RE(t){return me(t)&&"__vccOpts"in t}const Qt=(t,e)=>vv(t,e,$i);function Su(t,e,n){const r=arguments.length;return r===2?Ge(e)&&!he(e)?Ui(e)?Me(t,null,[e]):Me(t,e):Me(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Ui(n)&&(n=[n]),Me(t,e,n))}const PE="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Rc;const $f=typeof window<"u"&&window.trustedTypes;if($f)try{Rc=$f.createPolicy("vue",{createHTML:t=>t})}catch{}const Zp=Rc?t=>Rc.createHTML(t):t=>t,xE="http://www.w3.org/2000/svg",VE="http://www.w3.org/1998/Math/MathML",Bn=typeof document<"u"?document:null,jf=Bn&&Bn.createElement("template"),DE={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e==="svg"?Bn.createElementNS(xE,t):e==="mathml"?Bn.createElementNS(VE,t):n?Bn.createElement(t,{is:n}):Bn.createElement(t);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>Bn.createTextNode(t),createComment:t=>Bn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Bn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{jf.innerHTML=Zp(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const l=jf.content;if(r==="svg"||r==="mathml"){const c=l.firstChild;for(;c.firstChild;)l.appendChild(c.firstChild);l.removeChild(c)}e.insertBefore(l,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Yn="transition",li="animation",Rs=Symbol("_vtc"),eg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},tg=ct({},wp,eg),kE=t=>(t.displayName="Transition",t.props=tg,t),Hl=kE((t,{slots:e})=>Su(Rv,ng(t),e)),Vr=(t,e=[])=>{he(t)?t.forEach(n=>n(...e)):t&&t(...e)},qf=t=>t?he(t)?t.some(e=>e.length>1):t.length>1:!1;function ng(t){const e={};for(const I in t)I in eg||(e[I]=t[I]);if(t.css===!1)return e;const{name:n="v",type:r,duration:s,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:u=o,appearToClass:f=l,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:g=`${n}-leave-to`}=t,S=NE(s),R=S&&S[0],x=S&&S[1],{onBeforeEnter:j,onEnter:D,onEnterCancelled:O,onLeave:N,onLeaveCancelled:ne,onBeforeAppear:Q=j,onAppear:T=D,onAppearCancelled:w=O}=e,y=(I,v,Se,We)=>{I._enterCancelled=We,tr(I,v?f:l),tr(I,v?u:o),Se&&Se()},b=(I,v)=>{I._isLeaving=!1,tr(I,d),tr(I,g),tr(I,p),v&&v()},A=I=>(v,Se)=>{const We=I?T:D,He=()=>y(v,I,Se);Vr(We,[v,He]),Hf(()=>{tr(v,I?c:i),bn(v,I?f:l),qf(We)||zf(v,r,R,He)})};return ct(e,{onBeforeEnter(I){Vr(j,[I]),bn(I,i),bn(I,o)},onBeforeAppear(I){Vr(Q,[I]),bn(I,c),bn(I,u)},onEnter:A(!1),onAppear:A(!0),onLeave(I,v){I._isLeaving=!0;const Se=()=>b(I,v);bn(I,d),I._enterCancelled?(bn(I,p),Pc()):(Pc(),bn(I,p)),Hf(()=>{I._isLeaving&&(tr(I,d),bn(I,g),qf(N)||zf(I,r,x,Se))}),Vr(N,[I,Se])},onEnterCancelled(I){y(I,!1,void 0,!0),Vr(O,[I])},onAppearCancelled(I){y(I,!0,void 0,!0),Vr(w,[I])},onLeaveCancelled(I){b(I),Vr(ne,[I])}})}function NE(t){if(t==null)return null;if(Ge(t))return[zl(t.enter),zl(t.leave)];{const e=zl(t);return[e,e]}}function zl(t){return jw(t)}function bn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Rs]||(t[Rs]=new Set)).add(e)}function tr(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const n=t[Rs];n&&(n.delete(e),n.size||(t[Rs]=void 0))}function Hf(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let OE=0;function zf(t,e,n,r){const s=t._endId=++OE,i=()=>{s===t._endId&&r()};if(n!=null)return setTimeout(i,n);const{type:o,timeout:l,propCount:c}=rg(t,e);if(!o)return r();const u=o+"end";let f=0;const d=()=>{t.removeEventListener(u,p),i()},p=g=>{g.target===t&&++f>=c&&d()};setTimeout(()=>{f<c&&d()},l+1),t.addEventListener(u,p)}function rg(t,e){const n=window.getComputedStyle(t),r=S=>(n[S]||"").split(", "),s=r(`${Yn}Delay`),i=r(`${Yn}Duration`),o=Gf(s,i),l=r(`${li}Delay`),c=r(`${li}Duration`),u=Gf(l,c);let f=null,d=0,p=0;e===Yn?o>0&&(f=Yn,d=o,p=i.length):e===li?u>0&&(f=li,d=u,p=c.length):(d=Math.max(o,u),f=d>0?o>u?Yn:li:null,p=f?f===Yn?i.length:c.length:0);const g=f===Yn&&/\b(transform|all)(,|$)/.test(r(`${Yn}Property`).toString());return{type:f,timeout:d,propCount:p,hasTransform:g}}function Gf(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>Wf(n)+Wf(t[r])))}function Wf(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Pc(){return document.body.offsetHeight}function ME(t,e,n){const r=t[Rs];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Kf=Symbol("_vod"),LE=Symbol("_vsh"),FE=Symbol(""),BE=/(^|;)\s*display\s*:/;function UE(t,e,n){const r=t.style,s=et(n);let i=!1;if(n&&!s){if(e)if(et(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();n[l]==null&&Wo(r,l,"")}else for(const o in e)n[o]==null&&Wo(r,o,"");for(const o in n)o==="display"&&(i=!0),Wo(r,o,n[o])}else if(s){if(e!==n){const o=r[FE];o&&(n+=";"+o),r.cssText=n,i=BE.test(n)}}else e&&t.removeAttribute("style");Kf in t&&(t[Kf]=i?r.display:"",t[LE]&&(r.display="none"))}const Qf=/\s*!important$/;function Wo(t,e,n){if(he(n))n.forEach(r=>Wo(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=$E(t,e);Qf.test(n)?t.setProperty(wr(r),n.replace(Qf,""),"important"):t[r]=n}}const Xf=["Webkit","Moz","ms"],Gl={};function $E(t,e){const n=Gl[e];if(n)return n;let r=sn(e);if(r!=="filter"&&r in t)return Gl[e]=r;r=Ma(r);for(let s=0;s<Xf.length;s++){const i=Xf[s]+r;if(i in t)return Gl[e]=i}return e}const Jf="http://www.w3.org/1999/xlink";function Yf(t,e,n,r,s,i=Kw(e)){r&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Jf,e.slice(6,e.length)):t.setAttributeNS(Jf,e,n):n==null||i&&!Hm(n)?t.removeAttribute(e):t.setAttribute(e,i?"":Gn(n)?String(n):n)}function Zf(t,e,n,r,s){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Zp(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(l!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=Hm(n):n==null&&l==="string"?(n="",o=!0):l==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(s||e)}function ss(t,e,n,r){t.addEventListener(e,n,r)}function jE(t,e,n,r){t.removeEventListener(e,n,r)}const ed=Symbol("_vei");function qE(t,e,n,r,s=null){const i=t[ed]||(t[ed]={}),o=i[e];if(r&&o)o.value=r;else{const[l,c]=HE(e);if(r){const u=i[e]=WE(r,s);ss(t,l,u,c)}else o&&(jE(t,l,o,c),i[e]=void 0)}}const td=/(?:Once|Passive|Capture)$/;function HE(t){let e;if(td.test(t)){e={};let r;for(;r=t.match(td);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):wr(t.slice(2)),e]}let Wl=0;const zE=Promise.resolve(),GE=()=>Wl||(zE.then(()=>Wl=0),Wl=Date.now());function WE(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;mn(KE(r,n.value),e,5,[r])};return n.value=t,n.attached=GE(),n}function KE(t,e){if(he(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const nd=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,QE=(t,e,n,r,s,i)=>{const o=s==="svg";e==="class"?ME(t,r,o):e==="style"?UE(t,n,r):ka(e)?du(e)||qE(t,e,n,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):XE(t,e,r,o))?(Zf(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Yf(t,e,r,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!et(r))?Zf(t,sn(e),r,i,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),Yf(t,e,r,o))};function XE(t,e,n,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&nd(e)&&me(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return nd(e)&&et(n)?!1:e in t}const sg=new WeakMap,ig=new WeakMap,da=Symbol("_moveCb"),rd=Symbol("_enterCb"),JE=t=>(delete t.props.mode,t),YE=JE({name:"TransitionGroup",props:ct({},tg,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=Xp(),r=yp();let s,i;return Cp(()=>{if(!s.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!rb(s[0].el,n.vnode.el,o))return;s.forEach(eb),s.forEach(tb);const l=s.filter(nb);Pc(),l.forEach(c=>{const u=c.el,f=u.style;bn(u,o),f.transform=f.webkitTransform=f.transitionDuration="";const d=u[da]=p=>{p&&p.target!==u||(!p||/transform$/.test(p.propertyName))&&(u.removeEventListener("transitionend",d),u[da]=null,tr(u,o))};u.addEventListener("transitionend",d)})}),()=>{const o=xe(t),l=ng(o);let c=o.tag||Ze;if(s=[],i)for(let u=0;u<i.length;u++){const f=i[u];f.el&&f.el instanceof Element&&(s.push(f),qr(f,Fi(f,l,r,n)),sg.set(f,f.el.getBoundingClientRect()))}i=e.default?Au(e.default()):[];for(let u=0;u<i.length;u++){const f=i[u];f.key!=null&&qr(f,Fi(f,l,r,n))}return Me(c,null,i)}}}),ZE=YE;function eb(t){const e=t.el;e[da]&&e[da](),e[rd]&&e[rd]()}function tb(t){ig.set(t,t.el.getBoundingClientRect())}function nb(t){const e=sg.get(t),n=ig.get(t),r=e.left-n.left,s=e.top-n.top;if(r||s){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${r}px,${s}px)`,i.transitionDuration="0s",t}}function rb(t,e,n){const r=t.cloneNode(),s=t[Rs];s&&s.forEach(l=>{l.split(/\s+/).forEach(c=>c&&r.classList.remove(c))}),n.split(/\s+/).forEach(l=>l&&r.classList.add(l)),r.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(r);const{hasTransform:o}=rg(r);return i.removeChild(r),o}const sd=t=>{const e=t.props["onUpdate:modelValue"]||!1;return he(e)?n=>qo(e,n):e};function sb(t){t.target.composing=!0}function id(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Kl=Symbol("_assign"),ma={created(t,{modifiers:{lazy:e,trim:n,number:r}},s){t[Kl]=sd(s);const i=r||s.props&&s.props.type==="number";ss(t,e?"change":"input",o=>{if(o.target.composing)return;let l=t.value;n&&(l=l.trim()),i&&(l=gc(l)),t[Kl](l)}),n&&ss(t,"change",()=>{t.value=t.value.trim()}),e||(ss(t,"compositionstart",sb),ss(t,"compositionend",id),ss(t,"change",id))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:r,trim:s,number:i}},o){if(t[Kl]=sd(o),t.composing)return;const l=(i||t.type==="number")&&!/^0\d/.test(t.value)?gc(t.value):t.value,c=e??"";l!==c&&(document.activeElement===t&&t.type!=="range"&&(r&&e===n||s&&t.value.trim()===c)||(t.value=c))}},ib=["ctrl","shift","alt","meta"],ob={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>ib.some(n=>t[`${n}Key`]&&!e.includes(n))},hi=(t,e)=>{const n=t._withMods||(t._withMods={}),r=e.join(".");return n[r]||(n[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const l=ob[e[o]];if(l&&l(s,e))return}return t(s,...i)})},ab={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},od=(t,e)=>{const n=t._withKeys||(t._withKeys={}),r=e.join(".");return n[r]||(n[r]=s=>{if(!("key"in s))return;const i=wr(s.key);if(e.some(o=>o===i||ab[o]===i))return t(s)})},lb=ct({patchProp:QE},DE);let ad;function cb(){return ad||(ad=nE(lb))}const ub=(...t)=>{const e=cb().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=fb(r);if(!s)return;const i=e._component;!me(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,hb(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function hb(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function fb(t){return et(t)?document.querySelector(t):t}const Ps={es:{gameTitle:"Celebdle",questionIconAlt:"Icono de Pregunta",rulesModalTitle:"Reglas del juego",rulesList:["🎮 Regla 1: Solo puedes jugar una vez al día.","🕵️‍♂️ Regla 2: Tienes 6 pistas (4 de texto, 1 de audio, 1 de imagen).","🏆 Regla 3: Intenta adivinar a la celebridad antes de agotar las pistas."],placeholderGuess:"¿Quién crees que es?",guessButton:"Adivinar",skipButton:"Saltar",closeButton:"Cerrar",landingTitle:"¡Bienvenido a Celebdle!",landingTitleWelcome:"¡Bienvenido a ",statsTitle:"ESTADÍSTICAS",statsFoundLabel:"Encontrado",statsCurrentStreakLabel:"Racha actual",statsMaxStreakLabel:"Racha máxima",statsCloseButton:"Cerrar",statsXLabel:"X",landingDescription:"Adivina la celebridad del día con pistas generadas por IA y compite contra tus amigos para ver quién acierta más rápido.",landingPlayButton:"¡Comienza a jugar!",poweredBy:"powered by",footerCopyright(t){return`© ${t} Celebdle. Todos los derechos reservados.`},footerTerms:"Términos y Condiciones",footerPrivacy:"Política de Privacidad",footerCookies:"Política de Cookies",footerDmca:"Créditos / DMCA",clueLabel(t){return`Pista ${t+1} ${t+1<=4?"(Texto)":t+1==5?"(Audio Entrevista)":"(Imagen Borrosa)"}`},correctAnswer(t){return`¡Correcto! Era "${t}"`},wrongAnswer(t){return`Se acabaron las pistas o adivinaste mal. La respuesta era "${t}".`},attemptsLabel(t){return`Te tomó ${t} intento(s)/acción(es).`},nextCelebrityTimer(t){return`La próxima celebridad llegará en ${t}.`}},en:{gameTitle:"Celebdle",questionIconAlt:"Question Mark Icon",rulesModalTitle:"Game Rules",rulesList:["🎮 Rule 1: You can only play once a day.","🕵️‍♂️ Rule 2: You have 6 clues (4 text, 1 audio, 1 image).","🏆 Rule 3: Try to guess the celebrity before you run out of clues."],placeholderGuess:"Who do you think it is?",guessButton:"Guess",skipButton:"Skip",closeButton:"Close",landingTitle:"Welcome to Celebdle!",landingTitleWelcome:"Welcome to",landingDescription:"Guess the celebrity of the day with AI-generated clues and compete against your friends to see who can guess faster.",landingPlayButton:"Start playing!",poweredBy:"powered by",statsTitle:"STATISTICS",statsFoundLabel:"Found",statsCurrentStreakLabel:"Current Streak",statsMaxStreakLabel:"Max Streak",statsCloseButton:"Close",statsXLabel:"X",footerCopyright(t){return`© ${t} Celebdle. All rights reserved.`},footerTerms:"Terms & Conditions",footerPrivacy:"Privacy Policy",footerCookies:"Cookies Policy",footerDmca:"Credits / DMCA",clueLabel(t){return`Clue ${t+1} ${t+1<=4?"(Text)":t+1==5?"(Interview Audio)":"(Blurred Image)"}`},correctAnswer(t){return`Correct! It was "${t}"`},wrongAnswer(t){return`You're out of clues or guessed incorrectly. The answer was "${t}".`},attemptsLabel(t){return`It took you ${t} attempt(s)/action(s).`},nextCelebrityTimer(t){return`The next celebrity will arrive in ${t}.`}}},_n=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n},db={name:"Footer",setup(){dn("lang","es");const t=new Date().getFullYear(),n=new URLSearchParams(window.location.search).get("lang"),r=it(n||localStorage.getItem("lang")||(navigator.language.includes("es")?"es":"en"));return{currentYear:t,t:(o,l=null)=>{const c=Ps[r.value]||Ps.es;return typeof c[o]=="function"?c[o](l):c[o]||o},currentLang:r,changeLanguage:o=>{localStorage.setItem("lang",o),window.location.search=`?lang=${o}`}}}},mb={class:"bg-neutral-800 text-white py-3 px-4 rounded-lg mt-10"},pb={class:"container mx-auto px-4 flex flex-col md:flex-row items-center justify-between gap-2"},gb={class:"text-sm"},_b={class:"lg:flex gap-4 text-sm text-amber-300"},yb=["value"];function wb(t,e,n,r,s,i){const o=hr("router-link");return ge(),we("footer",mb,[$("div",pb,[$("div",gb,ye(r.t("footerCopyright",r.currentYear)),1),$("nav",_b,[Me(o,{to:"/terms",class:"text-amber-300 hover:text-amber-400 transition text-sm"},{default:tn(()=>[ft(ye(r.t("footerTerms")),1)]),_:1}),e[2]||(e[2]=ft(" - ")),Me(o,{to:"/privacy",class:"text-amber-300 hover:text-amber-400 transition text-sm"},{default:tn(()=>[ft(ye(r.t("footerPrivacy")),1)]),_:1}),e[3]||(e[3]=ft(" - ")),Me(o,{to:"/cookies",class:"text-amber-300 hover:text-amber-400 transition text-sm"},{default:tn(()=>[ft(ye(r.t("footerCookies")),1)]),_:1}),e[4]||(e[4]=ft(" - ")),$("select",{class:"text-amber-300 hover:text-amber-400 transition text-sm bg-neutral-800",onChange:e[0]||(e[0]=l=>r.changeLanguage(l.target.value)),value:r.currentLang},e[1]||(e[1]=[$("option",{value:"es"},"Español",-1),$("option",{value:"en"},"English",-1)]),40,yb)])])])}const vb=_n(db,[["render",wb]]),Eb={name:"App",components:{Footer:vb}},bb={class:"flex flex-col"},Tb={class:"flex-1"};function Ab(t,e,n,r,s,i){const o=hr("router-view"),l=hr("Footer");return ge(),we("div",bb,[$("main",Tb,[Me(o)]),Me(l)])}const Ib=_n(Eb,[["render",Ab]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const is=typeof document<"u";function og(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Cb(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&og(t.default)}const ke=Object.assign;function Ql(t,e){const n={};for(const r in e){const s=e[r];n[r]=pn(s)?s.map(t):t(s)}return n}const Si=()=>{},pn=Array.isArray,ag=/#/g,Sb=/&/g,Rb=/\//g,Pb=/=/g,xb=/\?/g,lg=/\+/g,Vb=/%5B/g,Db=/%5D/g,cg=/%5E/g,kb=/%60/g,ug=/%7B/g,Nb=/%7C/g,hg=/%7D/g,Ob=/%20/g;function Ru(t){return encodeURI(""+t).replace(Nb,"|").replace(Vb,"[").replace(Db,"]")}function Mb(t){return Ru(t).replace(ug,"{").replace(hg,"}").replace(cg,"^")}function xc(t){return Ru(t).replace(lg,"%2B").replace(Ob,"+").replace(ag,"%23").replace(Sb,"%26").replace(kb,"`").replace(ug,"{").replace(hg,"}").replace(cg,"^")}function Lb(t){return xc(t).replace(Pb,"%3D")}function Fb(t){return Ru(t).replace(ag,"%23").replace(xb,"%3F")}function Bb(t){return t==null?"":Fb(t).replace(Rb,"%2F")}function ji(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const Ub=/\/$/,$b=t=>t.replace(Ub,"");function Xl(t,e,n="/"){let r,s={},i="",o="";const l=e.indexOf("#");let c=e.indexOf("?");return l<c&&l>=0&&(c=-1),c>-1&&(r=e.slice(0,c),i=e.slice(c+1,l>-1?l:e.length),s=t(i)),l>-1&&(r=r||e.slice(0,l),o=e.slice(l,e.length)),r=zb(r??e,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:ji(o)}}function jb(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function ld(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function qb(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&xs(e.matched[r],n.matched[s])&&fg(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function xs(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function fg(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Hb(t[n],e[n]))return!1;return!0}function Hb(t,e){return pn(t)?cd(t,e):pn(e)?cd(e,t):t===e}function cd(t,e){return pn(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function zb(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=n.length-1,o,l;for(o=0;o<r.length;o++)if(l=r[o],l!==".")if(l==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const Zn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var qi;(function(t){t.pop="pop",t.push="push"})(qi||(qi={}));var Ri;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Ri||(Ri={}));function Gb(t){if(!t)if(is){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),$b(t)}const Wb=/^[^#]+#/;function Kb(t,e){return t.replace(Wb,"#")+e}function Qb(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Qa=()=>({left:window.scrollX,top:window.scrollY});function Xb(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=Qb(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function ud(t,e){return(history.state?history.state.position-e:-1)+t}const Vc=new Map;function Jb(t,e){Vc.set(t,e)}function Yb(t){const e=Vc.get(t);return Vc.delete(t),e}let Zb=()=>location.protocol+"//"+location.host;function dg(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let l=s.includes(t.slice(i))?t.slice(i).length:1,c=s.slice(l);return c[0]!=="/"&&(c="/"+c),ld(c,"")}return ld(n,t)+r+s}function eT(t,e,n,r){let s=[],i=[],o=null;const l=({state:p})=>{const g=dg(t,location),S=n.value,R=e.value;let x=0;if(p){if(n.value=g,e.value=p,o&&o===S){o=null;return}x=R?p.position-R.position:0}else r(g);s.forEach(j=>{j(n.value,S,{delta:x,type:qi.pop,direction:x?x>0?Ri.forward:Ri.back:Ri.unknown})})};function c(){o=n.value}function u(p){s.push(p);const g=()=>{const S=s.indexOf(p);S>-1&&s.splice(S,1)};return i.push(g),g}function f(){const{history:p}=window;p.state&&p.replaceState(ke({},p.state,{scroll:Qa()}),"")}function d(){for(const p of i)p();i=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",f)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",f,{passive:!0}),{pauseListeners:c,listen:u,destroy:d}}function hd(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?Qa():null}}function tT(t){const{history:e,location:n}=window,r={value:dg(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,f){const d=t.indexOf("#"),p=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+c:Zb()+t+c;try{e[f?"replaceState":"pushState"](u,"",p),s.value=u}catch(g){console.error(g),n[f?"replace":"assign"](p)}}function o(c,u){const f=ke({},e.state,hd(s.value.back,c,s.value.forward,!0),u,{position:s.value.position});i(c,f,!0),r.value=c}function l(c,u){const f=ke({},s.value,e.state,{forward:c,scroll:Qa()});i(f.current,f,!0);const d=ke({},hd(r.value,c,null),{position:f.position+1},u);i(c,d,!1),r.value=c}return{location:r,state:s,push:l,replace:o}}function nT(t){t=Gb(t);const e=tT(t),n=eT(t,e.state,e.location,e.replace);function r(i,o=!0){o||n.pauseListeners(),history.go(i)}const s=ke({location:"",base:t,go:r,createHref:Kb.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function rT(t){return typeof t=="string"||t&&typeof t=="object"}function mg(t){return typeof t=="string"||typeof t=="symbol"}const pg=Symbol("");var fd;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(fd||(fd={}));function Vs(t,e){return ke(new Error,{type:t,[pg]:!0},e)}function Mn(t,e){return t instanceof Error&&pg in t&&(e==null||!!(t.type&e))}const dd="[^/]+?",sT={sensitive:!1,strict:!1,start:!0,end:!0},iT=/[.+*?^${}()[\]/\\]/g;function oT(t,e){const n=ke({},sT,e),r=[];let s=n.start?"^":"";const i=[];for(const u of t){const f=u.length?[]:[90];n.strict&&!u.length&&(s+="/");for(let d=0;d<u.length;d++){const p=u[d];let g=40+(n.sensitive?.25:0);if(p.type===0)d||(s+="/"),s+=p.value.replace(iT,"\\$&"),g+=40;else if(p.type===1){const{value:S,repeatable:R,optional:x,regexp:j}=p;i.push({name:S,repeatable:R,optional:x});const D=j||dd;if(D!==dd){g+=10;try{new RegExp(`(${D})`)}catch(N){throw new Error(`Invalid custom RegExp for param "${S}" (${D}): `+N.message)}}let O=R?`((?:${D})(?:/(?:${D}))*)`:`(${D})`;d||(O=x&&u.length<2?`(?:/${O})`:"/"+O),x&&(O+="?"),s+=O,g+=20,x&&(g+=-8),R&&(g+=-20),D===".*"&&(g+=-50)}f.push(g)}r.push(f)}if(n.strict&&n.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function l(u){const f=u.match(o),d={};if(!f)return null;for(let p=1;p<f.length;p++){const g=f[p]||"",S=i[p-1];d[S.name]=g&&S.repeatable?g.split("/"):g}return d}function c(u){let f="",d=!1;for(const p of t){(!d||!f.endsWith("/"))&&(f+="/"),d=!1;for(const g of p)if(g.type===0)f+=g.value;else if(g.type===1){const{value:S,repeatable:R,optional:x}=g,j=S in u?u[S]:"";if(pn(j)&&!R)throw new Error(`Provided param "${S}" is an array but it is not repeatable (* or + modifiers)`);const D=pn(j)?j.join("/"):j;if(!D)if(x)p.length<2&&(f.endsWith("/")?f=f.slice(0,-1):d=!0);else throw new Error(`Missing required param "${S}"`);f+=D}}return f||"/"}return{re:o,score:r,keys:i,parse:l,stringify:c}}function aT(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function gg(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=aT(r[n],s[n]);if(i)return i;n++}if(Math.abs(s.length-r.length)===1){if(md(r))return 1;if(md(s))return-1}return s.length-r.length}function md(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const lT={type:0,value:""},cT=/[a-zA-Z0-9_]/;function uT(t){if(!t)return[[]];if(t==="/")return[[lT]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(g){throw new Error(`ERR (${n})/"${u}": ${g}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let l=0,c,u="",f="";function d(){u&&(n===0?i.push({type:0,value:u}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:f,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function p(){u+=c}for(;l<t.length;){if(c=t[l++],c==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:c==="/"?(u&&d(),o()):c===":"?(d(),n=1):p();break;case 4:p(),n=r;break;case 1:c==="("?n=2:cT.test(c)?p():(d(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&l--);break;case 2:c===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+c:n=3:f+=c;break;case 3:d(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&l--,f="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),d(),o(),s}function hT(t,e,n){const r=oT(uT(t.path),n),s=ke(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function fT(t,e){const n=[],r=new Map;e=yd({strict:!1,end:!0,sensitive:!1},e);function s(d){return r.get(d)}function i(d,p,g){const S=!g,R=gd(d);R.aliasOf=g&&g.record;const x=yd(e,d),j=[R];if("alias"in d){const N=typeof d.alias=="string"?[d.alias]:d.alias;for(const ne of N)j.push(gd(ke({},R,{components:g?g.record.components:R.components,path:ne,aliasOf:g?g.record:R})))}let D,O;for(const N of j){const{path:ne}=N;if(p&&ne[0]!=="/"){const Q=p.record.path,T=Q[Q.length-1]==="/"?"":"/";N.path=p.record.path+(ne&&T+ne)}if(D=hT(N,p,x),g?g.alias.push(D):(O=O||D,O!==D&&O.alias.push(D),S&&d.name&&!_d(D)&&o(d.name)),_g(D)&&c(D),R.children){const Q=R.children;for(let T=0;T<Q.length;T++)i(Q[T],D,g&&g.children[T])}g=g||D}return O?()=>{o(O)}:Si}function o(d){if(mg(d)){const p=r.get(d);p&&(r.delete(d),n.splice(n.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=n.indexOf(d);p>-1&&(n.splice(p,1),d.record.name&&r.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function l(){return n}function c(d){const p=pT(d,n);n.splice(p,0,d),d.record.name&&!_d(d)&&r.set(d.record.name,d)}function u(d,p){let g,S={},R,x;if("name"in d&&d.name){if(g=r.get(d.name),!g)throw Vs(1,{location:d});x=g.record.name,S=ke(pd(p.params,g.keys.filter(O=>!O.optional).concat(g.parent?g.parent.keys.filter(O=>O.optional):[]).map(O=>O.name)),d.params&&pd(d.params,g.keys.map(O=>O.name))),R=g.stringify(S)}else if(d.path!=null)R=d.path,g=n.find(O=>O.re.test(R)),g&&(S=g.parse(R),x=g.record.name);else{if(g=p.name?r.get(p.name):n.find(O=>O.re.test(p.path)),!g)throw Vs(1,{location:d,currentLocation:p});x=g.record.name,S=ke({},p.params,d.params),R=g.stringify(S)}const j=[];let D=g;for(;D;)j.unshift(D.record),D=D.parent;return{name:x,path:R,params:S,matched:j,meta:mT(j)}}t.forEach(d=>i(d));function f(){n.length=0,r.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:f,getRoutes:l,getRecordMatcher:s}}function pd(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function gd(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:dT(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function dT(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function _d(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function mT(t){return t.reduce((e,n)=>ke(e,n.meta),{})}function yd(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function pT(t,e){let n=0,r=e.length;for(;n!==r;){const i=n+r>>1;gg(t,e[i])<0?r=i:n=i+1}const s=gT(t);return s&&(r=e.lastIndexOf(s,r-1)),r}function gT(t){let e=t;for(;e=e.parent;)if(_g(e)&&gg(t,e)===0)return e}function _g({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function _T(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(lg," "),o=i.indexOf("="),l=ji(o<0?i:i.slice(0,o)),c=o<0?null:ji(i.slice(o+1));if(l in e){let u=e[l];pn(u)||(u=e[l]=[u]),u.push(c)}else e[l]=c}return e}function wd(t){let e="";for(let n in t){const r=t[n];if(n=Lb(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(pn(r)?r.map(i=>i&&xc(i)):[r&&xc(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function yT(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=pn(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const wT=Symbol(""),vd=Symbol(""),Xa=Symbol(""),yg=Symbol(""),Dc=Symbol("");function ci(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function ir(t,e,n,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((l,c)=>{const u=p=>{p===!1?c(Vs(4,{from:n,to:e})):p instanceof Error?c(p):rT(p)?c(Vs(2,{from:e,to:p})):(o&&r.enterCallbacks[s]===o&&typeof p=="function"&&o.push(p),l())},f=i(()=>t.call(r&&r.instances[s],e,n,u));let d=Promise.resolve(f);t.length<3&&(d=d.then(u)),d.catch(p=>c(p))})}function Jl(t,e,n,r,s=i=>i()){const i=[];for(const o of t)for(const l in o.components){let c=o.components[l];if(!(e!=="beforeRouteEnter"&&!o.instances[l]))if(og(c)){const f=(c.__vccOpts||c)[e];f&&i.push(ir(f,n,r,o,l,s))}else{let u=c();i.push(()=>u.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${l}" at "${o.path}"`);const d=Cb(f)?f.default:f;o.mods[l]=f,o.components[l]=d;const g=(d.__vccOpts||d)[e];return g&&ir(g,n,r,o,l,s)()}))}}return i}function Ed(t){const e=dn(Xa),n=dn(yg),r=Qt(()=>{const c=_s(t.to);return e.resolve(c)}),s=Qt(()=>{const{matched:c}=r.value,{length:u}=c,f=c[u-1],d=n.matched;if(!f||!d.length)return-1;const p=d.findIndex(xs.bind(null,f));if(p>-1)return p;const g=bd(c[u-2]);return u>1&&bd(f)===g&&d[d.length-1].path!==g?d.findIndex(xs.bind(null,c[u-2])):p}),i=Qt(()=>s.value>-1&&AT(n.params,r.value.params)),o=Qt(()=>s.value>-1&&s.value===n.matched.length-1&&fg(n.params,r.value.params));function l(c={}){if(TT(c)){const u=e[_s(t.replace)?"replace":"push"](_s(t.to)).catch(Si);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:r,href:Qt(()=>r.value.href),isActive:i,isExactActive:o,navigate:l}}function vT(t){return t.length===1?t[0]:t}const ET=Tp({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ed,setup(t,{slots:e}){const n=$a(Ed(t)),{options:r}=dn(Xa),s=Qt(()=>({[Td(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Td(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&vT(e.default(n));return t.custom?i:Su("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),bT=ET;function TT(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function AT(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!pn(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function bd(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Td=(t,e,n)=>t??e??n,IT=Tp({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=dn(Dc),s=Qt(()=>t.route||r.value),i=dn(vd,0),o=Qt(()=>{let u=_s(i);const{matched:f}=s.value;let d;for(;(d=f[u])&&!d.components;)u++;return u}),l=Qt(()=>s.value.matched[o.value]);zo(vd,Qt(()=>o.value+1)),zo(wT,l),zo(Dc,s);const c=it();return Es(()=>[c.value,l.value,t.name],([u,f,d],[p,g,S])=>{f&&(f.instances[d]=u,g&&g!==f&&u&&u===p&&(f.leaveGuards.size||(f.leaveGuards=g.leaveGuards),f.updateGuards.size||(f.updateGuards=g.updateGuards))),u&&f&&(!g||!xs(f,g)||!p)&&(f.enterCallbacks[d]||[]).forEach(R=>R(u))},{flush:"post"}),()=>{const u=s.value,f=t.name,d=l.value,p=d&&d.components[f];if(!p)return Ad(n.default,{Component:p,route:u});const g=d.props[f],S=g?g===!0?u.params:typeof g=="function"?g(u):g:null,x=Su(p,ke({},S,e,{onVnodeUnmounted:j=>{j.component.isUnmounted&&(d.instances[f]=null)},ref:c}));return Ad(n.default,{Component:x,route:u})||x}}});function Ad(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const CT=IT;function ST(t){const e=fT(t.routes,t),n=t.parseQuery||_T,r=t.stringifyQuery||wd,s=t.history,i=ci(),o=ci(),l=ci(),c=gv(Zn);let u=Zn;is&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ql.bind(null,M=>""+M),d=Ql.bind(null,Bb),p=Ql.bind(null,ji);function g(M,ee){let J,re;return mg(M)?(J=e.getRecordMatcher(M),re=ee):re=M,e.addRoute(re,J)}function S(M){const ee=e.getRecordMatcher(M);ee&&e.removeRoute(ee)}function R(){return e.getRoutes().map(M=>M.record)}function x(M){return!!e.getRecordMatcher(M)}function j(M,ee){if(ee=ke({},ee||c.value),typeof M=="string"){const P=Xl(n,M,ee.path),L=e.resolve({path:P.path},ee),U=s.createHref(P.fullPath);return ke(P,L,{params:p(L.params),hash:ji(P.hash),redirectedFrom:void 0,href:U})}let J;if(M.path!=null)J=ke({},M,{path:Xl(n,M.path,ee.path).path});else{const P=ke({},M.params);for(const L in P)P[L]==null&&delete P[L];J=ke({},M,{params:d(P)}),ee.params=d(ee.params)}const re=e.resolve(J,ee),Re=M.hash||"";re.params=f(p(re.params));const E=jb(r,ke({},M,{hash:Mb(Re),path:re.path})),C=s.createHref(E);return ke({fullPath:E,hash:Re,query:r===wd?yT(M.query):M.query||{}},re,{redirectedFrom:void 0,href:C})}function D(M){return typeof M=="string"?Xl(n,M,c.value.path):ke({},M)}function O(M,ee){if(u!==M)return Vs(8,{from:ee,to:M})}function N(M){return T(M)}function ne(M){return N(ke(D(M),{replace:!0}))}function Q(M){const ee=M.matched[M.matched.length-1];if(ee&&ee.redirect){const{redirect:J}=ee;let re=typeof J=="function"?J(M):J;return typeof re=="string"&&(re=re.includes("?")||re.includes("#")?re=D(re):{path:re},re.params={}),ke({query:M.query,hash:M.hash,params:re.path!=null?{}:M.params},re)}}function T(M,ee){const J=u=j(M),re=c.value,Re=M.state,E=M.force,C=M.replace===!0,P=Q(J);if(P)return T(ke(D(P),{state:typeof P=="object"?ke({},Re,P.state):Re,force:E,replace:C}),ee||J);const L=J;L.redirectedFrom=ee;let U;return!E&&qb(r,re,J)&&(U=Vs(16,{to:L,from:re}),nt(re,re,!0,!1)),(U?Promise.resolve(U):b(L,re)).catch(F=>Mn(F)?Mn(F,2)?F:Le(F):Z(F,L,re)).then(F=>{if(F){if(Mn(F,2))return T(ke({replace:C},D(F.to),{state:typeof F.to=="object"?ke({},Re,F.to.state):Re,force:E}),ee||L)}else F=I(L,re,!0,C,Re);return A(L,re,F),F})}function w(M,ee){const J=O(M,ee);return J?Promise.reject(J):Promise.resolve()}function y(M){const ee=on.values().next().value;return ee&&typeof ee.runWithContext=="function"?ee.runWithContext(M):M()}function b(M,ee){let J;const[re,Re,E]=RT(M,ee);J=Jl(re.reverse(),"beforeRouteLeave",M,ee);for(const P of re)P.leaveGuards.forEach(L=>{J.push(ir(L,M,ee))});const C=w.bind(null,M,ee);return J.push(C),Ft(J).then(()=>{J=[];for(const P of i.list())J.push(ir(P,M,ee));return J.push(C),Ft(J)}).then(()=>{J=Jl(Re,"beforeRouteUpdate",M,ee);for(const P of Re)P.updateGuards.forEach(L=>{J.push(ir(L,M,ee))});return J.push(C),Ft(J)}).then(()=>{J=[];for(const P of E)if(P.beforeEnter)if(pn(P.beforeEnter))for(const L of P.beforeEnter)J.push(ir(L,M,ee));else J.push(ir(P.beforeEnter,M,ee));return J.push(C),Ft(J)}).then(()=>(M.matched.forEach(P=>P.enterCallbacks={}),J=Jl(E,"beforeRouteEnter",M,ee,y),J.push(C),Ft(J))).then(()=>{J=[];for(const P of o.list())J.push(ir(P,M,ee));return J.push(C),Ft(J)}).catch(P=>Mn(P,8)?P:Promise.reject(P))}function A(M,ee,J){l.list().forEach(re=>y(()=>re(M,ee,J)))}function I(M,ee,J,re,Re){const E=O(M,ee);if(E)return E;const C=ee===Zn,P=is?history.state:{};J&&(re||C?s.replace(M.fullPath,ke({scroll:C&&P&&P.scroll},Re)):s.push(M.fullPath,Re)),c.value=M,nt(M,ee,J,C),Le()}let v;function Se(){v||(v=s.listen((M,ee,J)=>{if(!wn.listening)return;const re=j(M),Re=Q(re);if(Re){T(ke(Re,{replace:!0,force:!0}),re).catch(Si);return}u=re;const E=c.value;is&&Jb(ud(E.fullPath,J.delta),Qa()),b(re,E).catch(C=>Mn(C,12)?C:Mn(C,2)?(T(ke(D(C.to),{force:!0}),re).then(P=>{Mn(P,20)&&!J.delta&&J.type===qi.pop&&s.go(-1,!1)}).catch(Si),Promise.reject()):(J.delta&&s.go(-J.delta,!1),Z(C,re,E))).then(C=>{C=C||I(re,E,!1),C&&(J.delta&&!Mn(C,8)?s.go(-J.delta,!1):J.type===qi.pop&&Mn(C,20)&&s.go(-1,!1)),A(re,E,C)}).catch(Si)}))}let We=ci(),He=ci(),z;function Z(M,ee,J){Le(M);const re=He.list();return re.length?re.forEach(Re=>Re(M,ee,J)):console.error(M),Promise.reject(M)}function De(){return z&&c.value!==Zn?Promise.resolve():new Promise((M,ee)=>{We.add([M,ee])})}function Le(M){return z||(z=!M,Se(),We.list().forEach(([ee,J])=>M?J(M):ee()),We.reset()),M}function nt(M,ee,J,re){const{scrollBehavior:Re}=t;if(!is||!Re)return Promise.resolve();const E=!J&&Yb(ud(M.fullPath,0))||(re||!J)&&history.state&&history.state.scroll||null;return fp().then(()=>Re(M,ee,E)).then(C=>C&&Xb(C)).catch(C=>Z(C,M,ee))}const Be=M=>s.go(M);let je;const on=new Set,wn={currentRoute:c,listening:!0,addRoute:g,removeRoute:S,clearRoutes:e.clearRoutes,hasRoute:x,getRoutes:R,resolve:j,options:t,push:N,replace:ne,go:Be,back:()=>Be(-1),forward:()=>Be(1),beforeEach:i.add,beforeResolve:o.add,afterEach:l.add,onError:He.add,isReady:De,install(M){const ee=this;M.component("RouterLink",bT),M.component("RouterView",CT),M.config.globalProperties.$router=ee,Object.defineProperty(M.config.globalProperties,"$route",{enumerable:!0,get:()=>_s(c)}),is&&!je&&c.value===Zn&&(je=!0,N(s.location).catch(Re=>{}));const J={};for(const Re in Zn)Object.defineProperty(J,Re,{get:()=>c.value[Re],enumerable:!0});M.provide(Xa,ee),M.provide(yg,ap(J)),M.provide(Dc,c);const re=M.unmount;on.add(M),M.unmount=function(){on.delete(M),on.size<1&&(u=Zn,v&&v(),v=null,c.value=Zn,je=!1,z=!1),re()}}};function Ft(M){return M.reduce((ee,J)=>ee.then(()=>y(J)),Promise.resolve())}return wn}function RT(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const l=e.matched[o];l&&(t.matched.find(u=>xs(u,l))?r.push(l):n.push(l));const c=t.matched[o];c&&(e.matched.find(u=>xs(u,c))||s.push(c))}return[n,r,s]}function PT(){return dn(Xa)}const xT="/img/celeb-dle-logo.png",VT="/img/openai.png",DT={name:"LandingPage",props:{lang:{type:String,default:"es"}},setup(t){const e=PT();return{t:s=>(Ps[t.lang]||Ps.es)[s]||s,goToGame:()=>{e.push("/play")}}}},kT={class:"dark text-white flex flex-col items-center justify-center cursor-default"},NT=["alt"],OT={class:"font-montserrat transition text-3xl font-bold mb-4 hover:scale-110"},MT={class:"font-montserrat text-lg text-center max-w-prose mb-8"},LT={class:"flex items-center font-montserrat text-neutral-400 mt-20"};function FT(t,e,n,r,s,i){return ge(),we("div",kT,[$("img",{src:xT,alt:r.t("gameTitle"),class:"animate-float w-80 h-auto"},null,8,NT),$("h1",OT,[ft(ye(r.t("landingTitleWelcome"))+" ",1),e[1]||(e[1]=$("span",{class:"text-amber-300"},"Celebdle",-1)),e[2]||(e[2]=ft("! "))]),$("p",MT,ye(r.t("landingDescription")),1),$("div",null,[$("button",{onClick:e[0]||(e[0]=(...o)=>r.goToGame&&r.goToGame(...o)),class:"font-montserrat transition bg-amber-300 px-6 py-3 text-black rounded-lg hover:bg-amber-300 hover:scale-110"},ye(r.t("landingPlayButton")),1)]),$("p",LT,[ft(ye(r.t("poweredBy"))+" ",1),e[3]||(e[3]=$("a",{target:"_blank",href:"https://openai.com"},[$("img",{class:"w-16 ms-2 transition hover:scale-110",src:VT,alt:"OpenAI Logo"})],-1))])])}const BT=_n(DT,[["render",FT],["__scopeId","data-v-80351919"]]);var Id={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wg=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},UT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},vg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,f=i>>2,d=(i&3)<<4|l>>4;let p=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(p=64)),r.push(n[f],n[d],n[p],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wg(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):UT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||d==null)throw new $T;const p=i<<2|l>>4;if(r.push(p),u!==64){const g=l<<4&240|u>>2;if(r.push(g),d!==64){const S=u<<6&192|d;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class $T extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jT=function(t){const e=wg(t);return vg.encodeByteArray(e,!0)},pa=function(t){return jT(t).replace(/\./g,"")},qT=function(t){try{return vg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT=()=>HT().__FIREBASE_DEFAULTS__,GT=()=>{if(typeof process>"u"||typeof Id>"u")return;const t=Id.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},WT=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qT(t[1]);return e&&JSON.parse(e)},Pu=()=>{try{return zT()||GT()||WT()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},KT=t=>{var e,n;return(n=(e=Pu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},QT=t=>{const e=KT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Eg=()=>{var t;return(t=Pu())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[pa(JSON.stringify(n)),pa(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZT(){var t;const e=(t=Pu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eA(){return!ZT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tA(){try{return typeof indexedDB=="object"}catch{return!1}}function nA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="FirebaseError";class Us extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=rA,Object.setPrototypeOf(this,Us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bg.prototype.create)}}class bg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?sA(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Us(s,l,r)}}function sA(t,e){return t.replace(iA,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const iA=/\{\$([^}]+)}/g;function kc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Cd(i)&&Cd(o)){if(!kc(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Cd(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class Hi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new XT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lA(e))try{this.getOrInitializeService({instanceIdentifier:Or})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Or){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Or){return this.instances.has(e)}getOptions(e=Or){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Or){return this.component?this.component.multipleInstances?e:Or:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aA(t){return t===Or?void 0:t}function lA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new oA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const uA={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},hA=Ie.INFO,fA={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},dA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=fA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Tg{constructor(e){this.name=e,this._logLevel=hA,this._logHandler=dA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?uA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const mA=(t,e)=>e.some(n=>t instanceof n);let Sd,Rd;function pA(){return Sd||(Sd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gA(){return Rd||(Rd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ag=new WeakMap,Nc=new WeakMap,Ig=new WeakMap,Yl=new WeakMap,xu=new WeakMap;function _A(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(lr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Ag.set(n,t)}).catch(()=>{}),xu.set(e,t),e}function yA(t){if(Nc.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Nc.set(t,e)}let Oc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Nc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ig.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return lr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wA(t){Oc=t(Oc)}function vA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Zl(this),e,...n);return Ig.set(r,e.sort?e.sort():[e]),lr(r)}:gA().includes(t)?function(...e){return t.apply(Zl(this),e),lr(Ag.get(this))}:function(...e){return lr(t.apply(Zl(this),e))}}function EA(t){return typeof t=="function"?vA(t):(t instanceof IDBTransaction&&yA(t),mA(t,pA())?new Proxy(t,Oc):t)}function lr(t){if(t instanceof IDBRequest)return _A(t);if(Yl.has(t))return Yl.get(t);const e=EA(t);return e!==t&&(Yl.set(t,e),xu.set(e,t)),e}const Zl=t=>xu.get(t);function bA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=lr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(lr(o.result),c.oldVersion,c.newVersion,lr(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const TA=["get","getKey","getAll","getAllKeys","count"],AA=["put","add","delete","clear"],ec=new Map;function Pd(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ec.get(e))return ec.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=AA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||TA.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return ec.set(e,i),i}wA(t=>({...t,get:(e,n,r)=>Pd(e,n)||t.get(e,n,r),has:(e,n)=>!!Pd(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(CA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function CA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mc="@firebase/app",xd="0.10.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=new Tg("@firebase/app"),SA="@firebase/app-compat",RA="@firebase/analytics-compat",PA="@firebase/analytics",xA="@firebase/app-check-compat",VA="@firebase/app-check",DA="@firebase/auth",kA="@firebase/auth-compat",NA="@firebase/database",OA="@firebase/data-connect",MA="@firebase/database-compat",LA="@firebase/functions",FA="@firebase/functions-compat",BA="@firebase/installations",UA="@firebase/installations-compat",$A="@firebase/messaging",jA="@firebase/messaging-compat",qA="@firebase/performance",HA="@firebase/performance-compat",zA="@firebase/remote-config",GA="@firebase/remote-config-compat",WA="@firebase/storage",KA="@firebase/storage-compat",QA="@firebase/firestore",XA="@firebase/vertexai",JA="@firebase/firestore-compat",YA="firebase",ZA="11.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc="[DEFAULT]",eI={[Mc]:"fire-core",[SA]:"fire-core-compat",[PA]:"fire-analytics",[RA]:"fire-analytics-compat",[VA]:"fire-app-check",[xA]:"fire-app-check-compat",[DA]:"fire-auth",[kA]:"fire-auth-compat",[NA]:"fire-rtdb",[OA]:"fire-data-connect",[MA]:"fire-rtdb-compat",[LA]:"fire-fn",[FA]:"fire-fn-compat",[BA]:"fire-iid",[UA]:"fire-iid-compat",[$A]:"fire-fcm",[jA]:"fire-fcm-compat",[qA]:"fire-perf",[HA]:"fire-perf-compat",[zA]:"fire-rc",[GA]:"fire-rc-compat",[WA]:"fire-gcs",[KA]:"fire-gcs-compat",[QA]:"fire-fst",[JA]:"fire-fst-compat",[XA]:"fire-vertex","fire-js":"fire-js",[YA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=new Map,tI=new Map,Fc=new Map;function Vd(t,e){try{t.container.addComponent(e)}catch(n){qn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function _a(t){const e=t.name;if(Fc.has(e))return qn.debug(`There were multiple attempts to register component ${e}.`),!1;Fc.set(e,t);for(const n of ga.values())Vd(n,t);for(const n of tI.values())Vd(n,t);return!0}function nI(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cr=new bg("app","Firebase",rI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Hi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=ZA;function Cg(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Lc,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw cr.create("bad-app-name",{appName:String(s)});if(n||(n=Eg()),!n)throw cr.create("no-options");const i=ga.get(s);if(i){if(kc(n,i.options)&&kc(r,i.config))return i;throw cr.create("duplicate-app",{appName:s})}const o=new cA(s);for(const c of Fc.values())o.addComponent(c);const l=new sI(n,r,o);return ga.set(s,l),l}function oI(t=Lc){const e=ga.get(t);if(!e&&t===Lc&&Eg())return Cg();if(!e)throw cr.create("no-app",{appName:t});return e}function bs(t,e,n){var r;let s=(r=eI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qn.warn(l.join(" "));return}_a(new Hi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="firebase-heartbeat-database",lI=1,zi="firebase-heartbeat-store";let tc=null;function Sg(){return tc||(tc=bA(aI,lI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(zi)}catch(n){console.warn(n)}}}}).catch(t=>{throw cr.create("idb-open",{originalErrorMessage:t.message})})),tc}async function cI(t){try{const n=(await Sg()).transaction(zi),r=await n.objectStore(zi).get(Rg(t));return await n.done,r}catch(e){if(e instanceof Us)qn.warn(e.message);else{const n=cr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qn.warn(n.message)}}}async function Dd(t,e){try{const r=(await Sg()).transaction(zi,"readwrite");await r.objectStore(zi).put(e,Rg(t)),await r.done}catch(n){if(n instanceof Us)qn.warn(n.message);else{const r=cr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});qn.warn(r.message)}}}function Rg(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=1024,hI=30*24*60*60*1e3;class fI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new mI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=kd();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=hI}),this._storage.overwrite(this._heartbeatsCache))}catch(r){qn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=kd(),{heartbeatsToSend:r,unsentEntries:s}=dI(this._heartbeatsCache.heartbeats),i=pa(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return qn.warn(n),""}}}function kd(){return new Date().toISOString().substring(0,10)}function dI(t,e=uI){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Nd(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Nd(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class mI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return tA()?nA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await cI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dd(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dd(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Nd(t){return pa(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t){_a(new Hi("platform-logger",e=>new IA(e),"PRIVATE")),_a(new Hi("heartbeat",e=>new fI(e),"PRIVATE")),bs(Mc,xd,t),bs(Mc,xd,"esm2017"),bs("fire-js","")}pI("");var Od=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $r,Pg;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,w){function y(){}y.prototype=w.prototype,T.D=w.prototype,T.prototype=new y,T.prototype.constructor=T,T.C=function(b,A,I){for(var v=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)v[Se-2]=arguments[Se];return w.prototype[A].apply(b,v)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,w,y){y||(y=0);var b=Array(16);if(typeof w=="string")for(var A=0;16>A;++A)b[A]=w.charCodeAt(y++)|w.charCodeAt(y++)<<8|w.charCodeAt(y++)<<16|w.charCodeAt(y++)<<24;else for(A=0;16>A;++A)b[A]=w[y++]|w[y++]<<8|w[y++]<<16|w[y++]<<24;w=T.g[0],y=T.g[1],A=T.g[2];var I=T.g[3],v=w+(I^y&(A^I))+b[0]+3614090360&4294967295;w=y+(v<<7&4294967295|v>>>25),v=I+(A^w&(y^A))+b[1]+3905402710&4294967295,I=w+(v<<12&4294967295|v>>>20),v=A+(y^I&(w^y))+b[2]+606105819&4294967295,A=I+(v<<17&4294967295|v>>>15),v=y+(w^A&(I^w))+b[3]+3250441966&4294967295,y=A+(v<<22&4294967295|v>>>10),v=w+(I^y&(A^I))+b[4]+4118548399&4294967295,w=y+(v<<7&4294967295|v>>>25),v=I+(A^w&(y^A))+b[5]+1200080426&4294967295,I=w+(v<<12&4294967295|v>>>20),v=A+(y^I&(w^y))+b[6]+2821735955&4294967295,A=I+(v<<17&4294967295|v>>>15),v=y+(w^A&(I^w))+b[7]+4249261313&4294967295,y=A+(v<<22&4294967295|v>>>10),v=w+(I^y&(A^I))+b[8]+1770035416&4294967295,w=y+(v<<7&4294967295|v>>>25),v=I+(A^w&(y^A))+b[9]+2336552879&4294967295,I=w+(v<<12&4294967295|v>>>20),v=A+(y^I&(w^y))+b[10]+4294925233&4294967295,A=I+(v<<17&4294967295|v>>>15),v=y+(w^A&(I^w))+b[11]+2304563134&4294967295,y=A+(v<<22&4294967295|v>>>10),v=w+(I^y&(A^I))+b[12]+1804603682&4294967295,w=y+(v<<7&4294967295|v>>>25),v=I+(A^w&(y^A))+b[13]+4254626195&4294967295,I=w+(v<<12&4294967295|v>>>20),v=A+(y^I&(w^y))+b[14]+2792965006&4294967295,A=I+(v<<17&4294967295|v>>>15),v=y+(w^A&(I^w))+b[15]+1236535329&4294967295,y=A+(v<<22&4294967295|v>>>10),v=w+(A^I&(y^A))+b[1]+4129170786&4294967295,w=y+(v<<5&4294967295|v>>>27),v=I+(y^A&(w^y))+b[6]+3225465664&4294967295,I=w+(v<<9&4294967295|v>>>23),v=A+(w^y&(I^w))+b[11]+643717713&4294967295,A=I+(v<<14&4294967295|v>>>18),v=y+(I^w&(A^I))+b[0]+3921069994&4294967295,y=A+(v<<20&4294967295|v>>>12),v=w+(A^I&(y^A))+b[5]+3593408605&4294967295,w=y+(v<<5&4294967295|v>>>27),v=I+(y^A&(w^y))+b[10]+38016083&4294967295,I=w+(v<<9&4294967295|v>>>23),v=A+(w^y&(I^w))+b[15]+3634488961&4294967295,A=I+(v<<14&4294967295|v>>>18),v=y+(I^w&(A^I))+b[4]+3889429448&4294967295,y=A+(v<<20&4294967295|v>>>12),v=w+(A^I&(y^A))+b[9]+568446438&4294967295,w=y+(v<<5&4294967295|v>>>27),v=I+(y^A&(w^y))+b[14]+3275163606&4294967295,I=w+(v<<9&4294967295|v>>>23),v=A+(w^y&(I^w))+b[3]+4107603335&4294967295,A=I+(v<<14&4294967295|v>>>18),v=y+(I^w&(A^I))+b[8]+1163531501&4294967295,y=A+(v<<20&4294967295|v>>>12),v=w+(A^I&(y^A))+b[13]+2850285829&4294967295,w=y+(v<<5&4294967295|v>>>27),v=I+(y^A&(w^y))+b[2]+4243563512&4294967295,I=w+(v<<9&4294967295|v>>>23),v=A+(w^y&(I^w))+b[7]+1735328473&4294967295,A=I+(v<<14&4294967295|v>>>18),v=y+(I^w&(A^I))+b[12]+2368359562&4294967295,y=A+(v<<20&4294967295|v>>>12),v=w+(y^A^I)+b[5]+4294588738&4294967295,w=y+(v<<4&4294967295|v>>>28),v=I+(w^y^A)+b[8]+2272392833&4294967295,I=w+(v<<11&4294967295|v>>>21),v=A+(I^w^y)+b[11]+1839030562&4294967295,A=I+(v<<16&4294967295|v>>>16),v=y+(A^I^w)+b[14]+4259657740&4294967295,y=A+(v<<23&4294967295|v>>>9),v=w+(y^A^I)+b[1]+2763975236&4294967295,w=y+(v<<4&4294967295|v>>>28),v=I+(w^y^A)+b[4]+1272893353&4294967295,I=w+(v<<11&4294967295|v>>>21),v=A+(I^w^y)+b[7]+4139469664&4294967295,A=I+(v<<16&4294967295|v>>>16),v=y+(A^I^w)+b[10]+3200236656&4294967295,y=A+(v<<23&4294967295|v>>>9),v=w+(y^A^I)+b[13]+681279174&4294967295,w=y+(v<<4&4294967295|v>>>28),v=I+(w^y^A)+b[0]+3936430074&4294967295,I=w+(v<<11&4294967295|v>>>21),v=A+(I^w^y)+b[3]+3572445317&4294967295,A=I+(v<<16&4294967295|v>>>16),v=y+(A^I^w)+b[6]+76029189&4294967295,y=A+(v<<23&4294967295|v>>>9),v=w+(y^A^I)+b[9]+3654602809&4294967295,w=y+(v<<4&4294967295|v>>>28),v=I+(w^y^A)+b[12]+3873151461&4294967295,I=w+(v<<11&4294967295|v>>>21),v=A+(I^w^y)+b[15]+530742520&4294967295,A=I+(v<<16&4294967295|v>>>16),v=y+(A^I^w)+b[2]+3299628645&4294967295,y=A+(v<<23&4294967295|v>>>9),v=w+(A^(y|~I))+b[0]+4096336452&4294967295,w=y+(v<<6&4294967295|v>>>26),v=I+(y^(w|~A))+b[7]+1126891415&4294967295,I=w+(v<<10&4294967295|v>>>22),v=A+(w^(I|~y))+b[14]+2878612391&4294967295,A=I+(v<<15&4294967295|v>>>17),v=y+(I^(A|~w))+b[5]+4237533241&4294967295,y=A+(v<<21&4294967295|v>>>11),v=w+(A^(y|~I))+b[12]+1700485571&4294967295,w=y+(v<<6&4294967295|v>>>26),v=I+(y^(w|~A))+b[3]+2399980690&4294967295,I=w+(v<<10&4294967295|v>>>22),v=A+(w^(I|~y))+b[10]+4293915773&4294967295,A=I+(v<<15&4294967295|v>>>17),v=y+(I^(A|~w))+b[1]+2240044497&4294967295,y=A+(v<<21&4294967295|v>>>11),v=w+(A^(y|~I))+b[8]+1873313359&4294967295,w=y+(v<<6&4294967295|v>>>26),v=I+(y^(w|~A))+b[15]+4264355552&4294967295,I=w+(v<<10&4294967295|v>>>22),v=A+(w^(I|~y))+b[6]+2734768916&4294967295,A=I+(v<<15&4294967295|v>>>17),v=y+(I^(A|~w))+b[13]+1309151649&4294967295,y=A+(v<<21&4294967295|v>>>11),v=w+(A^(y|~I))+b[4]+4149444226&4294967295,w=y+(v<<6&4294967295|v>>>26),v=I+(y^(w|~A))+b[11]+3174756917&4294967295,I=w+(v<<10&4294967295|v>>>22),v=A+(w^(I|~y))+b[2]+718787259&4294967295,A=I+(v<<15&4294967295|v>>>17),v=y+(I^(A|~w))+b[9]+3951481745&4294967295,T.g[0]=T.g[0]+w&4294967295,T.g[1]=T.g[1]+(A+(v<<21&4294967295|v>>>11))&4294967295,T.g[2]=T.g[2]+A&4294967295,T.g[3]=T.g[3]+I&4294967295}r.prototype.u=function(T,w){w===void 0&&(w=T.length);for(var y=w-this.blockSize,b=this.B,A=this.h,I=0;I<w;){if(A==0)for(;I<=y;)s(this,T,I),I+=this.blockSize;if(typeof T=="string"){for(;I<w;)if(b[A++]=T.charCodeAt(I++),A==this.blockSize){s(this,b),A=0;break}}else for(;I<w;)if(b[A++]=T[I++],A==this.blockSize){s(this,b),A=0;break}}this.h=A,this.o+=w},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var w=1;w<T.length-8;++w)T[w]=0;var y=8*this.o;for(w=T.length-8;w<T.length;++w)T[w]=y&255,y/=256;for(this.u(T),T=Array(16),w=y=0;4>w;++w)for(var b=0;32>b;b+=8)T[y++]=this.g[w]>>>b&255;return T};function i(T,w){var y=l;return Object.prototype.hasOwnProperty.call(y,T)?y[T]:y[T]=w(T)}function o(T,w){this.h=w;for(var y=[],b=!0,A=T.length-1;0<=A;A--){var I=T[A]|0;b&&I==w||(y[A]=I,b=!1)}this.g=y}var l={};function c(T){return-128<=T&&128>T?i(T,function(w){return new o([w|0],0>w?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return d;if(0>T)return x(u(-T));for(var w=[],y=1,b=0;T>=y;b++)w[b]=T/y|0,y*=4294967296;return new o(w,0)}function f(T,w){if(T.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(T.charAt(0)=="-")return x(f(T.substring(1),w));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=u(Math.pow(w,8)),b=d,A=0;A<T.length;A+=8){var I=Math.min(8,T.length-A),v=parseInt(T.substring(A,A+I),w);8>I?(I=u(Math.pow(w,I)),b=b.j(I).add(u(v))):(b=b.j(y),b=b.add(u(v)))}return b}var d=c(0),p=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(R(this))return-x(this).m();for(var T=0,w=1,y=0;y<this.g.length;y++){var b=this.i(y);T+=(0<=b?b:4294967296+b)*w,w*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(S(this))return"0";if(R(this))return"-"+x(this).toString(T);for(var w=u(Math.pow(T,6)),y=this,b="";;){var A=N(y,w).g;y=j(y,A.j(w));var I=((0<y.g.length?y.g[0]:y.h)>>>0).toString(T);if(y=A,S(y))return I+b;for(;6>I.length;)I="0"+I;b=I+b}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function S(T){if(T.h!=0)return!1;for(var w=0;w<T.g.length;w++)if(T.g[w]!=0)return!1;return!0}function R(T){return T.h==-1}t.l=function(T){return T=j(this,T),R(T)?-1:S(T)?0:1};function x(T){for(var w=T.g.length,y=[],b=0;b<w;b++)y[b]=~T.g[b];return new o(y,~T.h).add(p)}t.abs=function(){return R(this)?x(this):this},t.add=function(T){for(var w=Math.max(this.g.length,T.g.length),y=[],b=0,A=0;A<=w;A++){var I=b+(this.i(A)&65535)+(T.i(A)&65535),v=(I>>>16)+(this.i(A)>>>16)+(T.i(A)>>>16);b=v>>>16,I&=65535,v&=65535,y[A]=v<<16|I}return new o(y,y[y.length-1]&-2147483648?-1:0)};function j(T,w){return T.add(x(w))}t.j=function(T){if(S(this)||S(T))return d;if(R(this))return R(T)?x(this).j(x(T)):x(x(this).j(T));if(R(T))return x(this.j(x(T)));if(0>this.l(g)&&0>T.l(g))return u(this.m()*T.m());for(var w=this.g.length+T.g.length,y=[],b=0;b<2*w;b++)y[b]=0;for(b=0;b<this.g.length;b++)for(var A=0;A<T.g.length;A++){var I=this.i(b)>>>16,v=this.i(b)&65535,Se=T.i(A)>>>16,We=T.i(A)&65535;y[2*b+2*A]+=v*We,D(y,2*b+2*A),y[2*b+2*A+1]+=I*We,D(y,2*b+2*A+1),y[2*b+2*A+1]+=v*Se,D(y,2*b+2*A+1),y[2*b+2*A+2]+=I*Se,D(y,2*b+2*A+2)}for(b=0;b<w;b++)y[b]=y[2*b+1]<<16|y[2*b];for(b=w;b<2*w;b++)y[b]=0;return new o(y,0)};function D(T,w){for(;(T[w]&65535)!=T[w];)T[w+1]+=T[w]>>>16,T[w]&=65535,w++}function O(T,w){this.g=T,this.h=w}function N(T,w){if(S(w))throw Error("division by zero");if(S(T))return new O(d,d);if(R(T))return w=N(x(T),w),new O(x(w.g),x(w.h));if(R(w))return w=N(T,x(w)),new O(x(w.g),w.h);if(30<T.g.length){if(R(T)||R(w))throw Error("slowDivide_ only works with positive integers.");for(var y=p,b=w;0>=b.l(T);)y=ne(y),b=ne(b);var A=Q(y,1),I=Q(b,1);for(b=Q(b,2),y=Q(y,2);!S(b);){var v=I.add(b);0>=v.l(T)&&(A=A.add(y),I=v),b=Q(b,1),y=Q(y,1)}return w=j(T,A.j(w)),new O(A,w)}for(A=d;0<=T.l(w);){for(y=Math.max(1,Math.floor(T.m()/w.m())),b=Math.ceil(Math.log(y)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),I=u(y),v=I.j(w);R(v)||0<v.l(T);)y-=b,I=u(y),v=I.j(w);S(I)&&(I=p),A=A.add(I),T=j(T,v)}return new O(A,T)}t.A=function(T){return N(this,T).h},t.and=function(T){for(var w=Math.max(this.g.length,T.g.length),y=[],b=0;b<w;b++)y[b]=this.i(b)&T.i(b);return new o(y,this.h&T.h)},t.or=function(T){for(var w=Math.max(this.g.length,T.g.length),y=[],b=0;b<w;b++)y[b]=this.i(b)|T.i(b);return new o(y,this.h|T.h)},t.xor=function(T){for(var w=Math.max(this.g.length,T.g.length),y=[],b=0;b<w;b++)y[b]=this.i(b)^T.i(b);return new o(y,this.h^T.h)};function ne(T){for(var w=T.g.length+1,y=[],b=0;b<w;b++)y[b]=T.i(b)<<1|T.i(b-1)>>>31;return new o(y,T.h)}function Q(T,w){var y=w>>5;w%=32;for(var b=T.g.length-y,A=[],I=0;I<b;I++)A[I]=0<w?T.i(I+y)>>>w|T.i(I+y+1)<<32-w:T.i(I+y);return new o(A,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Pg=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,$r=o}).apply(typeof Od<"u"?Od:typeof self<"u"?self:typeof window<"u"?window:{});var ko=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xg,fi,Vg,Ko,Bc,Dg,kg,Ng;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,m){return a==Array.prototype||a==Object.prototype||(a[h]=m.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ko=="object"&&ko];for(var h=0;h<a.length;++h){var m=a[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var m=r;a=a.split(".");for(var _=0;_<a.length-1;_++){var V=a[_];if(!(V in m))break e;m=m[V]}a=a[a.length-1],_=m[a],h=h(_),h!=_&&h!=null&&e(m,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var m=0,_=!1,V={next:function(){if(!_&&m<a.length){var k=m++;return{value:h(k,a[k]),done:!1}}return _=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function u(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,m){return a.call.apply(a.bind,arguments)}function d(a,h,m){if(!a)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,_),a.apply(h,V)}}return function(){return a.apply(h,arguments)}}function p(a,h,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:d,p.apply(null,arguments)}function g(a,h){var m=Array.prototype.slice.call(arguments,1);return function(){var _=m.slice();return _.push.apply(_,arguments),a.apply(this,_)}}function S(a,h){function m(){}m.prototype=h.prototype,a.aa=h.prototype,a.prototype=new m,a.prototype.constructor=a,a.Qb=function(_,V,k){for(var K=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)K[Ue-2]=arguments[Ue];return h.prototype[V].apply(_,K)}}function R(a){const h=a.length;if(0<h){const m=Array(h);for(let _=0;_<h;_++)m[_]=a[_];return m}return[]}function x(a,h){for(let m=1;m<arguments.length;m++){const _=arguments[m];if(c(_)){const V=a.length||0,k=_.length||0;a.length=V+k;for(let K=0;K<k;K++)a[V+K]=_[K]}else a.push(_)}}class j{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function D(a){return/^[\s\xa0]*$/.test(a)}function O(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function N(a){return N[" "](a),a}N[" "]=function(){};var ne=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function Q(a,h,m){for(const _ in a)h.call(m,a[_],_,a)}function T(a,h){for(const m in a)h.call(void 0,a[m],m,a)}function w(a){const h={};for(const m in a)h[m]=a[m];return h}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(a,h){let m,_;for(let V=1;V<arguments.length;V++){_=arguments[V];for(m in _)a[m]=_[m];for(let k=0;k<y.length;k++)m=y[k],Object.prototype.hasOwnProperty.call(_,m)&&(a[m]=_[m])}}function A(a){var h=1;a=a.split(":");const m=[];for(;0<h&&a.length;)m.push(a.shift()),h--;return a.length&&m.push(a.join(":")),m}function I(a){l.setTimeout(()=>{throw a},0)}function v(){var a=De;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class Se{constructor(){this.h=this.g=null}add(h,m){const _=We.get();_.set(h,m),this.h?this.h.next=_:this.g=_,this.h=_}}var We=new j(()=>new He,a=>a.reset());class He{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let z,Z=!1,De=new Se,Le=()=>{const a=l.Promise.resolve(void 0);z=()=>{a.then(nt)}};var nt=()=>{for(var a;a=v();){try{a.h.call(a.g)}catch(m){I(m)}var h=We;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}Z=!1};function Be(){this.s=this.s,this.C=this.C}Be.prototype.s=!1,Be.prototype.ma=function(){this.s||(this.s=!0,this.N())},Be.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function je(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}je.prototype.h=function(){this.defaultPrevented=!0};var on=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const m=()=>{};l.addEventListener("test",m,h),l.removeEventListener("test",m,h)}catch{}return a}();function wn(a,h){if(je.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var m=this.type=a.type,_=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(ne){e:{try{N(h.nodeName);var V=!0;break e}catch{}V=!1}V||(h=null)}}else m=="mouseover"?h=a.fromElement:m=="mouseout"&&(h=a.toElement);this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Ft[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&wn.aa.h.call(this)}}S(wn,je);var Ft={2:"touch",3:"pen",4:"mouse"};wn.prototype.h=function(){wn.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),ee=0;function J(a,h,m,_,V){this.listener=a,this.proxy=null,this.src=h,this.type=m,this.capture=!!_,this.ha=V,this.key=++ee,this.da=this.fa=!1}function re(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Re(a){this.src=a,this.g={},this.h=0}Re.prototype.add=function(a,h,m,_,V){var k=a.toString();a=this.g[k],a||(a=this.g[k]=[],this.h++);var K=C(a,h,_,V);return-1<K?(h=a[K],m||(h.fa=!1)):(h=new J(h,this.src,k,!!_,V),h.fa=m,a.push(h)),h};function E(a,h){var m=h.type;if(m in a.g){var _=a.g[m],V=Array.prototype.indexOf.call(_,h,void 0),k;(k=0<=V)&&Array.prototype.splice.call(_,V,1),k&&(re(h),a.g[m].length==0&&(delete a.g[m],a.h--))}}function C(a,h,m,_){for(var V=0;V<a.length;++V){var k=a[V];if(!k.da&&k.listener==h&&k.capture==!!m&&k.ha==_)return V}return-1}var P="closure_lm_"+(1e6*Math.random()|0),L={};function U(a,h,m,_,V){if(Array.isArray(h)){for(var k=0;k<h.length;k++)U(a,h[k],m,_,V);return null}return m=ue(m),a&&a[M]?a.K(h,m,u(_)?!!_.capture:!1,V):F(a,h,m,!1,_,V)}function F(a,h,m,_,V,k){if(!h)throw Error("Invalid event type");var K=u(V)?!!V.capture:!!V,Ue=Y(a);if(Ue||(a[P]=Ue=new Re(a)),m=Ue.add(h,m,_,K,k),m.proxy)return m;if(_=X(),m.proxy=_,_.src=a,_.listener=m,a.addEventListener)on||(V=K),V===void 0&&(V=!1),a.addEventListener(h.toString(),_,V);else if(a.attachEvent)a.attachEvent(H(h.toString()),_);else if(a.addListener&&a.removeListener)a.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return m}function X(){function a(m){return h.call(a.src,a.listener,m)}const h=le;return a}function W(a,h,m,_,V){if(Array.isArray(h))for(var k=0;k<h.length;k++)W(a,h[k],m,_,V);else _=u(_)?!!_.capture:!!_,m=ue(m),a&&a[M]?(a=a.i,h=String(h).toString(),h in a.g&&(k=a.g[h],m=C(k,m,_,V),-1<m&&(re(k[m]),Array.prototype.splice.call(k,m,1),k.length==0&&(delete a.g[h],a.h--)))):a&&(a=Y(a))&&(h=a.g[h.toString()],a=-1,h&&(a=C(h,m,_,V)),(m=-1<a?h[a]:null)&&G(m))}function G(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[M])E(h.i,a);else{var m=a.type,_=a.proxy;h.removeEventListener?h.removeEventListener(m,_,a.capture):h.detachEvent?h.detachEvent(H(m),_):h.addListener&&h.removeListener&&h.removeListener(_),(m=Y(h))?(E(m,a),m.h==0&&(m.src=null,h[P]=null)):re(a)}}}function H(a){return a in L?L[a]:L[a]="on"+a}function le(a,h){if(a.da)a=!0;else{h=new wn(h,this);var m=a.listener,_=a.ha||a.src;a.fa&&G(a),a=m.call(_,h)}return a}function Y(a){return a=a[P],a instanceof Re?a:null}var ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function ue(a){return typeof a=="function"?a:(a[ie]||(a[ie]=function(h){return a.handleEvent(h)}),a[ie])}function ce(){Be.call(this),this.i=new Re(this),this.M=this,this.F=null}S(ce,Be),ce.prototype[M]=!0,ce.prototype.removeEventListener=function(a,h,m,_){W(this,a,h,m,_)};function _e(a,h){var m,_=a.F;if(_)for(m=[];_;_=_.F)m.push(_);if(a=a.M,_=h.type||h,typeof h=="string")h=new je(h,a);else if(h instanceof je)h.target=h.target||a;else{var V=h;h=new je(_,a),b(h,V)}if(V=!0,m)for(var k=m.length-1;0<=k;k--){var K=h.g=m[k];V=Te(K,_,!0,h)&&V}if(K=h.g=a,V=Te(K,_,!0,h)&&V,V=Te(K,_,!1,h)&&V,m)for(k=0;k<m.length;k++)K=h.g=m[k],V=Te(K,_,!1,h)&&V}ce.prototype.N=function(){if(ce.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var m=a.g[h],_=0;_<m.length;_++)re(m[_]);delete a.g[h],a.h--}}this.F=null},ce.prototype.K=function(a,h,m,_){return this.i.add(String(a),h,!1,m,_)},ce.prototype.L=function(a,h,m,_){return this.i.add(String(a),h,!0,m,_)};function Te(a,h,m,_){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var V=!0,k=0;k<h.length;++k){var K=h[k];if(K&&!K.da&&K.capture==m){var Ue=K.listener,gt=K.ha||K.src;K.fa&&E(a.i,K),V=Ue.call(gt,_)!==!1&&V}}return V&&!_.defaultPrevented}function Tt(a,h,m){if(typeof a=="function")m&&(a=p(a,m));else if(a&&typeof a.handleEvent=="function")a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function mt(a){a.g=Tt(()=>{a.g=null,a.i&&(a.i=!1,mt(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Yt extends Be{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:mt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function At(a){Be.call(this),this.h=a,this.g={}}S(At,Be);var Kn=[];function Ks(a){Q(a.g,function(h,m){this.g.hasOwnProperty(m)&&G(h)},a),a.g={}}At.prototype.N=function(){At.aa.N.call(this),Ks(this)},At.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pt=l.JSON.stringify,Zt=l.JSON.parse,fo=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function vl(){}vl.prototype.h=null;function Dh(a){return a.h||(a.h=a.i())}function kh(){}var Qs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function El(){je.call(this,"d")}S(El,je);function bl(){je.call(this,"c")}S(bl,je);var Ir={},Nh=null;function mo(){return Nh=Nh||new ce}Ir.La="serverreachability";function Oh(a){je.call(this,Ir.La,a)}S(Oh,je);function Xs(a){const h=mo();_e(h,new Oh(h))}Ir.STAT_EVENT="statevent";function Mh(a,h){je.call(this,Ir.STAT_EVENT,a),this.stat=h}S(Mh,je);function Nt(a){const h=mo();_e(h,new Mh(h,a))}Ir.Ma="timingevent";function Lh(a,h){je.call(this,Ir.Ma,a),this.size=h}S(Lh,je);function Js(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function Ys(){this.g=!0}Ys.prototype.xa=function(){this.g=!1};function mw(a,h,m,_,V,k){a.info(function(){if(a.g)if(k)for(var K="",Ue=k.split("&"),gt=0;gt<Ue.length;gt++){var Pe=Ue[gt].split("=");if(1<Pe.length){var It=Pe[0];Pe=Pe[1];var Ct=It.split("_");K=2<=Ct.length&&Ct[1]=="type"?K+(It+"="+Pe+"&"):K+(It+"=redacted&")}}else K=null;else K=k;return"XMLHTTP REQ ("+_+") [attempt "+V+"]: "+h+`
`+m+`
`+K})}function pw(a,h,m,_,V,k,K){a.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+V+"]: "+h+`
`+m+`
`+k+" "+K})}function Qr(a,h,m,_){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+_w(a,m)+(_?" "+_:"")})}function gw(a,h){a.info(function(){return"TIMEOUT: "+h})}Ys.prototype.info=function(){};function _w(a,h){if(!a.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(a=0;a<m.length;a++)if(Array.isArray(m[a])){var _=m[a];if(!(2>_.length)){var V=_[1];if(Array.isArray(V)&&!(1>V.length)){var k=V[0];if(k!="noop"&&k!="stop"&&k!="close")for(var K=1;K<V.length;K++)V[K]=""}}}}return pt(m)}catch{return h}}var po={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tl;function go(){}S(go,vl),go.prototype.g=function(){return new XMLHttpRequest},go.prototype.i=function(){return{}},Tl=new go;function Qn(a,h,m,_){this.j=a,this.i=h,this.l=m,this.R=_||1,this.U=new At(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bh}function Bh(){this.i=null,this.g="",this.h=!1}var Uh={},Al={};function Il(a,h,m){a.L=1,a.v=vo(kn(h)),a.m=m,a.P=!0,$h(a,null)}function $h(a,h){a.F=Date.now(),_o(a),a.A=kn(a.v);var m=a.A,_=a.R;Array.isArray(_)||(_=[String(_)]),tf(m.i,"t",_),a.C=0,m=a.j.J,a.h=new Bh,a.g=vf(a.j,m?h:null,!a.m),0<a.O&&(a.M=new Yt(p(a.Y,a,a.g),a.O)),h=a.U,m=a.g,_=a.ca;var V="readystatechange";Array.isArray(V)||(V&&(Kn[0]=V.toString()),V=Kn);for(var k=0;k<V.length;k++){var K=U(m,V[k],_||h.handleEvent,!1,h.h||h);if(!K)break;h.g[K.key]=K}h=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Xs(),mw(a.i,a.u,a.A,a.l,a.R,a.m)}Qn.prototype.ca=function(a){a=a.target;const h=this.M;h&&Nn(a)==3?h.j():this.Y(a)},Qn.prototype.Y=function(a){try{if(a==this.g)e:{const Ct=Nn(this.g);var h=this.g.Ba();const Yr=this.g.Z();if(!(3>Ct)&&(Ct!=3||this.g&&(this.h.h||this.g.oa()||cf(this.g)))){this.J||Ct!=4||h==7||(h==8||0>=Yr?Xs(3):Xs(2)),Cl(this);var m=this.g.Z();this.X=m;t:if(jh(this)){var _=cf(this.g);a="";var V=_.length,k=Nn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Cr(this),Zs(this);var K="";break t}this.h.i=new l.TextDecoder}for(h=0;h<V;h++)this.h.h=!0,a+=this.h.i.decode(_[h],{stream:!(k&&h==V-1)});_.length=0,this.h.g+=a,this.C=0,K=this.h.g}else K=this.g.oa();if(this.o=m==200,pw(this.i,this.u,this.A,this.l,this.R,Ct,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ue,gt=this.g;if((Ue=gt.g?gt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(Ue)){var Pe=Ue;break t}}Pe=null}if(m=Pe)Qr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sl(this,m);else{this.o=!1,this.s=3,Nt(12),Cr(this),Zs(this);break e}}if(this.P){m=!0;let an;for(;!this.J&&this.C<K.length;)if(an=yw(this,K),an==Al){Ct==4&&(this.s=4,Nt(14),m=!1),Qr(this.i,this.l,null,"[Incomplete Response]");break}else if(an==Uh){this.s=4,Nt(15),Qr(this.i,this.l,K,"[Invalid Chunk]"),m=!1;break}else Qr(this.i,this.l,an,null),Sl(this,an);if(jh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ct!=4||K.length!=0||this.h.h||(this.s=1,Nt(16),m=!1),this.o=this.o&&m,!m)Qr(this.i,this.l,K,"[Invalid Chunked Response]"),Cr(this),Zs(this);else if(0<K.length&&!this.W){this.W=!0;var It=this.j;It.g==this&&It.ba&&!It.M&&(It.j.info("Great, no buffering proxy detected. Bytes received: "+K.length),kl(It),It.M=!0,Nt(11))}}else Qr(this.i,this.l,K,null),Sl(this,K);Ct==4&&Cr(this),this.o&&!this.J&&(Ct==4?gf(this.j,this):(this.o=!1,_o(this)))}else Ow(this.g),m==400&&0<K.indexOf("Unknown SID")?(this.s=3,Nt(12)):(this.s=0,Nt(13)),Cr(this),Zs(this)}}}catch{}finally{}};function jh(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function yw(a,h){var m=a.C,_=h.indexOf(`
`,m);return _==-1?Al:(m=Number(h.substring(m,_)),isNaN(m)?Uh:(_+=1,_+m>h.length?Al:(h=h.slice(_,_+m),a.C=_+m,h)))}Qn.prototype.cancel=function(){this.J=!0,Cr(this)};function _o(a){a.S=Date.now()+a.I,qh(a,a.I)}function qh(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Js(p(a.ba,a),h)}function Cl(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Qn.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(gw(this.i,this.A),this.L!=2&&(Xs(),Nt(17)),Cr(this),this.s=2,Zs(this)):qh(this,this.S-a)};function Zs(a){a.j.G==0||a.J||gf(a.j,a)}function Cr(a){Cl(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Ks(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Sl(a,h){try{var m=a.j;if(m.G!=0&&(m.g==a||Rl(m.h,a))){if(!a.K&&Rl(m.h,a)&&m.G==3){try{var _=m.Da.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var V=_;if(V[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<a.F)Co(m),Ao(m);else break e;Dl(m),Nt(18)}}else m.za=V[1],0<m.za-m.T&&37500>V[2]&&m.F&&m.v==0&&!m.C&&(m.C=Js(p(m.Za,m),6e3));if(1>=Gh(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Rr(m,11)}else if((a.K||m.g==a)&&Co(m),!D(h))for(V=m.Da.g.parse(h),h=0;h<V.length;h++){let Pe=V[h];if(m.T=Pe[0],Pe=Pe[1],m.G==2)if(Pe[0]=="c"){m.K=Pe[1],m.ia=Pe[2];const It=Pe[3];It!=null&&(m.la=It,m.j.info("VER="+m.la));const Ct=Pe[4];Ct!=null&&(m.Aa=Ct,m.j.info("SVER="+m.Aa));const Yr=Pe[5];Yr!=null&&typeof Yr=="number"&&0<Yr&&(_=1.5*Yr,m.L=_,m.j.info("backChannelRequestTimeoutMs_="+_)),_=m;const an=a.g;if(an){const Ro=an.g?an.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ro){var k=_.h;k.g||Ro.indexOf("spdy")==-1&&Ro.indexOf("quic")==-1&&Ro.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(Pl(k,k.h),k.h=null))}if(_.D){const Nl=an.g?an.g.getResponseHeader("X-HTTP-Session-Id"):null;Nl&&(_.ya=Nl,ze(_.I,_.D,Nl))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-a.F,m.j.info("Handshake RTT: "+m.R+"ms")),_=m;var K=a;if(_.qa=wf(_,_.J?_.ia:null,_.W),K.K){Wh(_.h,K);var Ue=K,gt=_.L;gt&&(Ue.I=gt),Ue.B&&(Cl(Ue),_o(Ue)),_.g=K}else mf(_);0<m.i.length&&Io(m)}else Pe[0]!="stop"&&Pe[0]!="close"||Rr(m,7);else m.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?Rr(m,7):Vl(m):Pe[0]!="noop"&&m.l&&m.l.ta(Pe),m.v=0)}}Xs(4)}catch{}}var ww=class{constructor(a,h){this.g=a,this.map=h}};function Hh(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zh(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Gh(a){return a.h?1:a.g?a.g.size:0}function Rl(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Pl(a,h){a.g?a.g.add(h):a.h=h}function Wh(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Hh.prototype.cancel=function(){if(this.i=Kh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Kh(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const m of a.g.values())h=h.concat(m.D);return h}return R(a.i)}function vw(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],m=a.length,_=0;_<m;_++)h.push(a[_]);return h}h=[],m=0;for(_ in a)h[m++]=a[_];return h}function Ew(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var m=0;m<a;m++)h.push(m);return h}h=[],m=0;for(const _ in a)h[m++]=_;return h}}}function Qh(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var m=Ew(a),_=vw(a),V=_.length,k=0;k<V;k++)h.call(void 0,_[k],m&&m[k],a)}var Xh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bw(a,h){if(a){a=a.split("&");for(var m=0;m<a.length;m++){var _=a[m].indexOf("="),V=null;if(0<=_){var k=a[m].substring(0,_);V=a[m].substring(_+1)}else k=a[m];h(k,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Sr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Sr){this.h=a.h,yo(this,a.j),this.o=a.o,this.g=a.g,wo(this,a.s),this.l=a.l;var h=a.i,m=new ni;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),Jh(this,m),this.m=a.m}else a&&(h=String(a).match(Xh))?(this.h=!1,yo(this,h[1]||"",!0),this.o=ei(h[2]||""),this.g=ei(h[3]||"",!0),wo(this,h[4]),this.l=ei(h[5]||"",!0),Jh(this,h[6]||"",!0),this.m=ei(h[7]||"")):(this.h=!1,this.i=new ni(null,this.h))}Sr.prototype.toString=function(){var a=[],h=this.j;h&&a.push(ti(h,Yh,!0),":");var m=this.g;return(m||h=="file")&&(a.push("//"),(h=this.o)&&a.push(ti(h,Yh,!0),"@"),a.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&a.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&a.push("/"),a.push(ti(m,m.charAt(0)=="/"?Iw:Aw,!0))),(m=this.i.toString())&&a.push("?",m),(m=this.m)&&a.push("#",ti(m,Sw)),a.join("")};function kn(a){return new Sr(a)}function yo(a,h,m){a.j=m?ei(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function wo(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function Jh(a,h,m){h instanceof ni?(a.i=h,Rw(a.i,a.h)):(m||(h=ti(h,Cw)),a.i=new ni(h,a.h))}function ze(a,h,m){a.i.set(h,m)}function vo(a){return ze(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function ei(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ti(a,h,m){return typeof a=="string"?(a=encodeURI(a).replace(h,Tw),m&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Tw(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Yh=/[#\/\?@]/g,Aw=/[#\?:]/g,Iw=/[#\?]/g,Cw=/[#\?@]/g,Sw=/#/g;function ni(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function Xn(a){a.g||(a.g=new Map,a.h=0,a.i&&bw(a.i,function(h,m){a.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=ni.prototype,t.add=function(a,h){Xn(this),this.i=null,a=Xr(this,a);var m=this.g.get(a);return m||this.g.set(a,m=[]),m.push(h),this.h+=1,this};function Zh(a,h){Xn(a),h=Xr(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function ef(a,h){return Xn(a),h=Xr(a,h),a.g.has(h)}t.forEach=function(a,h){Xn(this),this.g.forEach(function(m,_){m.forEach(function(V){a.call(h,V,_,this)},this)},this)},t.na=function(){Xn(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let _=0;_<h.length;_++){const V=a[_];for(let k=0;k<V.length;k++)m.push(h[_])}return m},t.V=function(a){Xn(this);let h=[];if(typeof a=="string")ef(this,a)&&(h=h.concat(this.g.get(Xr(this,a))));else{a=Array.from(this.g.values());for(let m=0;m<a.length;m++)h=h.concat(a[m])}return h},t.set=function(a,h){return Xn(this),this.i=null,a=Xr(this,a),ef(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function tf(a,h,m){Zh(a,h),0<m.length&&(a.i=null,a.g.set(Xr(a,h),R(m)),a.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var _=h[m];const k=encodeURIComponent(String(_)),K=this.V(_);for(_=0;_<K.length;_++){var V=k;K[_]!==""&&(V+="="+encodeURIComponent(String(K[_]))),a.push(V)}}return this.i=a.join("&")};function Xr(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function Rw(a,h){h&&!a.j&&(Xn(a),a.i=null,a.g.forEach(function(m,_){var V=_.toLowerCase();_!=V&&(Zh(this,_),tf(this,V,m))},a)),a.j=h}function Pw(a,h){const m=new Ys;if(l.Image){const _=new Image;_.onload=g(Jn,m,"TestLoadImage: loaded",!0,h,_),_.onerror=g(Jn,m,"TestLoadImage: error",!1,h,_),_.onabort=g(Jn,m,"TestLoadImage: abort",!1,h,_),_.ontimeout=g(Jn,m,"TestLoadImage: timeout",!1,h,_),l.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=a}else h(!1)}function xw(a,h){const m=new Ys,_=new AbortController,V=setTimeout(()=>{_.abort(),Jn(m,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:_.signal}).then(k=>{clearTimeout(V),k.ok?Jn(m,"TestPingServer: ok",!0,h):Jn(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(V),Jn(m,"TestPingServer: error",!1,h)})}function Jn(a,h,m,_,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),_(m)}catch{}}function Vw(){this.g=new fo}function Dw(a,h,m){const _=m||"";try{Qh(a,function(V,k){let K=V;u(V)&&(K=pt(V)),h.push(_+k+"="+encodeURIComponent(K))})}catch(V){throw h.push(_+"type="+encodeURIComponent("_badmap")),V}}function Eo(a){this.l=a.Ub||null,this.j=a.eb||!1}S(Eo,vl),Eo.prototype.g=function(){return new bo(this.l,this.j)},Eo.prototype.i=function(a){return function(){return a}}({});function bo(a,h){ce.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(bo,ce),t=bo.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,si(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ri(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,si(this)),this.g&&(this.readyState=3,si(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;nf(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function nf(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?ri(this):si(this),this.readyState==3&&nf(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,ri(this))},t.Qa=function(a){this.g&&(this.response=a,ri(this))},t.ga=function(){this.g&&ri(this)};function ri(a){a.readyState=4,a.l=null,a.j=null,a.v=null,si(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,a.push(m[0]+": "+m[1]),m=h.next();return a.join(`\r
`)};function si(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(bo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function rf(a){let h="";return Q(a,function(m,_){h+=_,h+=":",h+=m,h+=`\r
`}),h}function xl(a,h,m){e:{for(_ in m){var _=!1;break e}_=!0}_||(m=rf(m),typeof a=="string"?m!=null&&encodeURIComponent(String(m)):ze(a,h,m))}function Je(a){ce.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Je,ce);var kw=/^https?$/i,Nw=["POST","PUT"];t=Je.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,m,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tl.g(),this.v=this.o?Dh(this.o):Dh(Tl),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(k){sf(this,k);return}if(a=m||"",m=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var V in _)m.set(V,_[V]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const k of _.keys())m.set(k,_.get(k));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(m.keys()).find(k=>k.toLowerCase()=="content-type"),V=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Nw,h,void 0))||_||V||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,K]of m)this.g.setRequestHeader(k,K);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{lf(this),this.u=!0,this.g.send(a),this.u=!1}catch(k){sf(this,k)}};function sf(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,of(a),To(a)}function of(a){a.A||(a.A=!0,_e(a,"complete"),_e(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,_e(this,"complete"),_e(this,"abort"),To(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),To(this,!0)),Je.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?af(this):this.bb())},t.bb=function(){af(this)};function af(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Nn(a)!=4||a.Z()!=2)){if(a.u&&Nn(a)==4)Tt(a.Ea,0,a);else if(_e(a,"readystatechange"),Nn(a)==4){a.h=!1;try{const K=a.Z();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var _;if(_=K===0){var V=String(a.D).match(Xh)[1]||null;!V&&l.self&&l.self.location&&(V=l.self.location.protocol.slice(0,-1)),_=!kw.test(V?V.toLowerCase():"")}m=_}if(m)_e(a,"complete"),_e(a,"success");else{a.m=6;try{var k=2<Nn(a)?a.g.statusText:""}catch{k=""}a.l=k+" ["+a.Z()+"]",of(a)}}finally{To(a)}}}}function To(a,h){if(a.g){lf(a);const m=a.g,_=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||_e(a,"ready");try{m.onreadystatechange=_}catch{}}}function lf(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Nn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Nn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),Zt(h)}};function cf(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Ow(a){const h={};a=(a.g&&2<=Nn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<a.length;_++){if(D(a[_]))continue;var m=A(a[_]);const V=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const k=h[V]||[];h[V]=k,k.push(m)}T(h,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ii(a,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[a]||h}function uf(a){this.Aa=0,this.i=[],this.j=new Ys,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ii("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ii("baseRetryDelayMs",5e3,a),this.cb=ii("retryDelaySeedMs",1e4,a),this.Wa=ii("forwardChannelMaxRetries",2,a),this.wa=ii("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Hh(a&&a.concurrentRequestLimit),this.Da=new Vw,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=uf.prototype,t.la=8,t.G=1,t.connect=function(a,h,m,_){Nt(0),this.W=a,this.H=h||{},m&&_!==void 0&&(this.H.OSID=m,this.H.OAID=_),this.F=this.X,this.I=wf(this,null,this.W),Io(this)};function Vl(a){if(hf(a),a.G==3){var h=a.U++,m=kn(a.I);if(ze(m,"SID",a.K),ze(m,"RID",h),ze(m,"TYPE","terminate"),oi(a,m),h=new Qn(a,a.j,h),h.L=2,h.v=vo(kn(m)),m=!1,l.navigator&&l.navigator.sendBeacon)try{m=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&l.Image&&(new Image().src=h.v,m=!0),m||(h.g=vf(h.j,null),h.g.ea(h.v)),h.F=Date.now(),_o(h)}yf(a)}function Ao(a){a.g&&(kl(a),a.g.cancel(),a.g=null)}function hf(a){Ao(a),a.u&&(l.clearTimeout(a.u),a.u=null),Co(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Io(a){if(!zh(a.h)&&!a.s){a.s=!0;var h=a.Ga;z||Le(),Z||(z(),Z=!0),De.add(h,a),a.B=0}}function Mw(a,h){return Gh(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Js(p(a.Ga,a,h),_f(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const V=new Qn(this,this.j,a);let k=this.o;if(this.S&&(k?(k=w(k),b(k,this.S)):k=this.S),this.m!==null||this.O||(V.H=k,k=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var _=this.i[m];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=df(this,V,h),m=kn(this.I),ze(m,"RID",a),ze(m,"CVER",22),this.D&&ze(m,"X-HTTP-Session-Id",this.D),oi(this,m),k&&(this.O?h="headers="+encodeURIComponent(String(rf(k)))+"&"+h:this.m&&xl(m,this.m,k)),Pl(this.h,V),this.Ua&&ze(m,"TYPE","init"),this.P?(ze(m,"$req",h),ze(m,"SID","null"),V.T=!0,Il(V,m,null)):Il(V,m,h),this.G=2}}else this.G==3&&(a?ff(this,a):this.i.length==0||zh(this.h)||ff(this))};function ff(a,h){var m;h?m=h.l:m=a.U++;const _=kn(a.I);ze(_,"SID",a.K),ze(_,"RID",m),ze(_,"AID",a.T),oi(a,_),a.m&&a.o&&xl(_,a.m,a.o),m=new Qn(a,a.j,m,a.B+1),a.m===null&&(m.H=a.o),h&&(a.i=h.D.concat(a.i)),h=df(a,m,1e3),m.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Pl(a.h,m),Il(m,_,h)}function oi(a,h){a.H&&Q(a.H,function(m,_){ze(h,_,m)}),a.l&&Qh({},function(m,_){ze(h,_,m)})}function df(a,h,m){m=Math.min(a.i.length,m);var _=a.l?p(a.l.Na,a.l,a):null;e:{var V=a.i;let k=-1;for(;;){const K=["count="+m];k==-1?0<m?(k=V[0].g,K.push("ofs="+k)):k=0:K.push("ofs="+k);let Ue=!0;for(let gt=0;gt<m;gt++){let Pe=V[gt].g;const It=V[gt].map;if(Pe-=k,0>Pe)k=Math.max(0,V[gt].g-100),Ue=!1;else try{Dw(It,K,"req"+Pe+"_")}catch{_&&_(It)}}if(Ue){_=K.join("&");break e}}}return a=a.i.splice(0,m),h.D=a,_}function mf(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;z||Le(),Z||(z(),Z=!0),De.add(h,a),a.v=0}}function Dl(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Js(p(a.Fa,a),_f(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,pf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Js(p(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Nt(10),Ao(this),pf(this))};function kl(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function pf(a){a.g=new Qn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=kn(a.qa);ze(h,"RID","rpc"),ze(h,"SID",a.K),ze(h,"AID",a.T),ze(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&ze(h,"TO",a.ja),ze(h,"TYPE","xmlhttp"),oi(a,h),a.m&&a.o&&xl(h,a.m,a.o),a.L&&(a.g.I=a.L);var m=a.g;a=a.ia,m.L=1,m.v=vo(kn(h)),m.m=null,m.P=!0,$h(m,a)}t.Za=function(){this.C!=null&&(this.C=null,Ao(this),Dl(this),Nt(19))};function Co(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function gf(a,h){var m=null;if(a.g==h){Co(a),kl(a),a.g=null;var _=2}else if(Rl(a.h,h))m=h.D,Wh(a.h,h),_=1;else return;if(a.G!=0){if(h.o)if(_==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var V=a.B;_=mo(),_e(_,new Lh(_,m)),Io(a)}else mf(a);else if(V=h.s,V==3||V==0&&0<h.X||!(_==1&&Mw(a,h)||_==2&&Dl(a)))switch(m&&0<m.length&&(h=a.h,h.i=h.i.concat(m)),V){case 1:Rr(a,5);break;case 4:Rr(a,10);break;case 3:Rr(a,6);break;default:Rr(a,2)}}}function _f(a,h){let m=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(m*=2),m*h}function Rr(a,h){if(a.j.info("Error code "+h),h==2){var m=p(a.fb,a),_=a.Xa;const V=!_;_=new Sr(_||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||yo(_,"https"),vo(_),V?Pw(_.toString(),m):xw(_.toString(),m)}else Nt(2);a.G=0,a.l&&a.l.sa(h),yf(a),hf(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function yf(a){if(a.G=0,a.ka=[],a.l){const h=Kh(a.h);(h.length!=0||a.i.length!=0)&&(x(a.ka,h),x(a.ka,a.i),a.h.i.length=0,R(a.i),a.i.length=0),a.l.ra()}}function wf(a,h,m){var _=m instanceof Sr?kn(m):new Sr(m);if(_.g!="")h&&(_.g=h+"."+_.g),wo(_,_.s);else{var V=l.location;_=V.protocol,h=h?h+"."+V.hostname:V.hostname,V=+V.port;var k=new Sr(null);_&&yo(k,_),h&&(k.g=h),V&&wo(k,V),m&&(k.l=m),_=k}return m=a.D,h=a.ya,m&&h&&ze(_,m,h),ze(_,"VER",a.la),oi(a,_),_}function vf(a,h,m){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Je(new Eo({eb:m})):new Je(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ef(){}t=Ef.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function So(){}So.prototype.g=function(a,h){return new Ht(a,h)};function Ht(a,h){ce.call(this),this.g=new uf(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!D(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!D(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Jr(this)}S(Ht,ce),Ht.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ht.prototype.close=function(){Vl(this.g)},Ht.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var m={};m.__data__=a,a=m}else this.u&&(m={},m.__data__=pt(a),a=m);h.i.push(new ww(h.Ya++,a)),h.G==3&&Io(h)},Ht.prototype.N=function(){this.g.l=null,delete this.j,Vl(this.g),delete this.g,Ht.aa.N.call(this)};function bf(a){El.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const m in h){a=m;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}S(bf,El);function Tf(){bl.call(this),this.status=1}S(Tf,bl);function Jr(a){this.g=a}S(Jr,Ef),Jr.prototype.ua=function(){_e(this.g,"a")},Jr.prototype.ta=function(a){_e(this.g,new bf(a))},Jr.prototype.sa=function(a){_e(this.g,new Tf)},Jr.prototype.ra=function(){_e(this.g,"b")},So.prototype.createWebChannel=So.prototype.g,Ht.prototype.send=Ht.prototype.o,Ht.prototype.open=Ht.prototype.m,Ht.prototype.close=Ht.prototype.close,Ng=function(){return new So},kg=function(){return mo()},Dg=Ir,Bc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},po.NO_ERROR=0,po.TIMEOUT=8,po.HTTP_ERROR=6,Ko=po,Fh.COMPLETE="complete",Vg=Fh,kh.EventType=Qs,Qs.OPEN="a",Qs.CLOSE="b",Qs.ERROR="c",Qs.MESSAGE="d",ce.prototype.listen=ce.prototype.K,fi=kh,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,xg=Je}).apply(typeof ko<"u"?ko:typeof self<"u"?self:typeof window<"u"?window:{});const Md="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pt.UNAUTHENTICATED=new Pt(null),Pt.GOOGLE_CREDENTIALS=new Pt("google-credentials-uid"),Pt.FIRST_PARTY=new Pt("first-party-uid"),Pt.MOCK_USER=new Pt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr=new Tg("@firebase/firestore");function os(){return Hr.logLevel}function te(t,...e){if(Hr.logLevel<=Ie.DEBUG){const n=e.map(Vu);Hr.debug(`Firestore (${$s}): ${t}`,...n)}}function Hn(t,...e){if(Hr.logLevel<=Ie.ERROR){const n=e.map(Vu);Hr.error(`Firestore (${$s}): ${t}`,...n)}}function Ds(t,...e){if(Hr.logLevel<=Ie.WARN){const n=e.map(Vu);Hr.warn(`Firestore (${$s}): ${t}`,...n)}}function Vu(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(t="Unexpected state"){const e=`FIRESTORE (${$s}) INTERNAL ASSERTION FAILED: `+t;throw Hn(e),new Error(e)}function Oe(t,e){t||fe()}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends Us{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Pt.UNAUTHENTICATED))}shutdown(){}}class _I{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class yI{constructor(e){this.t=e,this.currentUser=Pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Oe(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new jn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new jn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new jn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Oe(typeof r.accessToken=="string"),new Og(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string"),new Pt(e)}}class wI{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Pt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class vI{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new wI(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class EI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bI{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Oe(this.o===void 0);const r=i=>{i.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Oe(typeof n.token=="string"),this.R=n.token,new EI(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=TI(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function be(t,e){return t<e?-1:t>e?1:0}function ks(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new at(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new se(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new se(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new se(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{static fromTimestamp(e){return new de(e)}static min(){return new de(new at(0,0))}static max(){return new de(new at(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,n,r){n===void 0?n=0:n>e.length&&fe(),r===void 0?r=e.length-n:r>e.length-n&&fe(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Gi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Gi?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ke extends Gi{construct(e,n,r){return new Ke(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ke(n)}static emptyPath(){return new Ke([])}}const AI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vt extends Gi{construct(e,n,r){return new vt(e,n,r)}static isValidIdentifier(e){return AI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new vt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new se(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new se(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new se(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new se(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vt(n)}static emptyPath(){return new vt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Ke.fromString(e))}static fromName(e){return new ae(Ke.fromString(e).popFirst(5))}static empty(){return new ae(Ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ke.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Ke(e.slice()))}}function II(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=de.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new mr(s,ae.empty(),e)}function CI(t){return new mr(t.readTime,t.key,-1)}class mr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new mr(de.min(),ae.empty(),-1)}static max(){return new mr(de.max(),ae.empty(),-1)}}function SI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ae.comparator(t.documentKey,e.documentKey),n!==0?n:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function js(t){if(t.code!==q.FAILED_PRECONDITION||t.message!==RI)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&fe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new B((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof B?n:B.resolve(n)}catch(n){return B.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):B.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):B.reject(n)}static resolve(e){return new B((n,r)=>{n(e)})}static reject(e){return new B((n,r)=>{r(e)})}static waitFor(e){return new B((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=B.resolve(!1);for(const r of e)n=n.next(s=>s?B.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new B((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(f=>{o[u]=f,++l,l===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new B((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function xI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function qs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ja.oe=-1;function Ya(t){return t==null}function ya(t){return t===0&&1/t==-1/0}function VI(t){return typeof t=="number"&&Number.isInteger(t)&&!ya(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Ld(e)),e=kI(t.get(n),e);return Ld(e)}function kI(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Ld(t){return t+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function br(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Lg(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e,n){this.comparator=e,this.root=n||yt.EMPTY}insert(e,n){return new Xe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yt.BLACK,null,null))}remove(e){return new Xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new No(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new No(this.root,e,this.comparator,!1)}getReverseIterator(){return new No(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new No(this.root,e,this.comparator,!0)}}class No{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??yt.RED,this.left=s??yt.EMPTY,this.right=i??yt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new yt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return yt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return yt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw fe();const e=this.left.check();if(e!==this.right.check())throw fe();return e+(this.isRed()?0:1)}}yt.EMPTY=null,yt.RED=!0,yt.BLACK=!1;yt.EMPTY=new class{constructor(){this.size=0}get key(){throw fe()}get value(){throw fe()}get color(){throw fe()}get left(){throw fe()}get right(){throw fe()}copy(e,n,r,s,i){return this}insert(e,n,r){return new yt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.comparator=e,this.data=new Xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Bd(this.data.getIterator())}getIteratorFrom(e){return new Bd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof lt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new lt(this.comparator);return n.data=e,n}}class Bd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.fields=e,e.sort(vt.comparator)}static empty(){return new Jt([])}unionWith(e){let n=new lt(vt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Jt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ks(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Fg("Invalid base64 string: "+i):i}}(e);return new Et(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const NI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pr(t){if(Oe(!!t),typeof t=="string"){let e=0;const n=NI.exec(t);if(Oe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ye(t.seconds),nanos:Ye(t.nanos)}}function Ye(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function gr(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Za(t){const e=t.mapValue.fields.__previous_value__;return Du(e)?Za(e):e}function Wi(t){const e=pr(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,n,r,s,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Ki{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ki("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ki&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function _r(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Du(t)?4:LI(t)?9007199254740991:MI(t)?10:11:fe()}function Vn(t,e){if(t===e)return!0;const n=_r(t);if(n!==_r(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wi(t).isEqual(Wi(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=pr(s.timestampValue),l=pr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return gr(s.bytesValue).isEqual(gr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ye(s.geoPointValue.latitude)===Ye(i.geoPointValue.latitude)&&Ye(s.geoPointValue.longitude)===Ye(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ye(s.integerValue)===Ye(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ye(s.doubleValue),l=Ye(i.doubleValue);return o===l?ya(o)===ya(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return ks(t.arrayValue.values||[],e.arrayValue.values||[],Vn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Fd(o)!==Fd(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Vn(o[c],l[c])))return!1;return!0}(t,e);default:return fe()}}function Qi(t,e){return(t.values||[]).find(n=>Vn(n,e))!==void 0}function Ns(t,e){if(t===e)return 0;const n=_r(t),r=_r(e);if(n!==r)return be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Ye(i.integerValue||i.doubleValue),c=Ye(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Ud(t.timestampValue,e.timestampValue);case 4:return Ud(Wi(t),Wi(e));case 5:return be(t.stringValue,e.stringValue);case 6:return function(i,o){const l=gr(i),c=gr(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const f=be(l[u],c[u]);if(f!==0)return f}return be(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=be(Ye(i.latitude),Ye(o.latitude));return l!==0?l:be(Ye(i.longitude),Ye(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return $d(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,f;const d=i.fields||{},p=o.fields||{},g=(l=d.value)===null||l===void 0?void 0:l.arrayValue,S=(c=p.value)===null||c===void 0?void 0:c.arrayValue,R=be(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((f=S==null?void 0:S.values)===null||f===void 0?void 0:f.length)||0);return R!==0?R:$d(g,S)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Oo.mapValue&&o===Oo.mapValue)return 0;if(i===Oo.mapValue)return 1;if(o===Oo.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let d=0;d<c.length&&d<f.length;++d){const p=be(c[d],f[d]);if(p!==0)return p;const g=Ns(l[c[d]],u[f[d]]);if(g!==0)return g}return be(c.length,f.length)}(t.mapValue,e.mapValue);default:throw fe()}}function Ud(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const n=pr(t),r=pr(e),s=be(n.seconds,r.seconds);return s!==0?s:be(n.nanos,r.nanos)}function $d(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ns(n[s],r[s]);if(i)return i}return be(n.length,r.length)}function Os(t){return Uc(t)}function Uc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=pr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return gr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Uc(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Uc(n.fields[o])}`;return s+"}"}(t.mapValue):fe()}function Qo(t){switch(_r(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Za(t);return e?16+Qo(e):16;case 5:return 2*t.stringValue.length;case 6:return gr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Qo(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return br(r.fields,(i,o)=>{s+=i.length+Qo(o)}),s}(t.mapValue);default:throw fe()}}function $c(t){return!!t&&"integerValue"in t}function ku(t){return!!t&&"arrayValue"in t}function jd(t){return!!t&&"nullValue"in t}function qd(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xo(t){return!!t&&"mapValue"in t}function MI(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Pi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return br(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Pi(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Pi(t.arrayValue.values[n]);return e}return Object.assign({},t)}function LI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.value=e}static empty(){return new $t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Xo(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pi(n)}setAll(e){let n=vt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Pi(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Xo(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Vn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Xo(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){br(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new $t(Pi(this.value))}}function Bg(t){const e=[];return br(t.fields,(n,r)=>{const s=new vt([n]);if(Xo(r)){const i=Bg(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Jt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Dt(e,0,de.min(),de.min(),de.min(),$t.empty(),0)}static newFoundDocument(e,n,r,s){return new Dt(e,1,n,de.min(),r,s,0)}static newNoDocument(e,n){return new Dt(e,2,n,de.min(),de.min(),$t.empty(),0)}static newUnknownDocument(e,n){return new Dt(e,3,n,de.min(),de.min(),$t.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(de.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$t.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$t.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=de.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,n){this.position=e,this.inclusive=n}}function Hd(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ae.comparator(ae.fromName(o.referenceValue),n.key):r=Ns(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function zd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Vn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,n="asc"){this.field=e,this.dir=n}}function FI(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{}class ot extends Ug{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new UI(e,n,r):n==="array-contains"?new qI(e,r):n==="in"?new HI(e,r):n==="not-in"?new zI(e,r):n==="array-contains-any"?new GI(e,r):new ot(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new $I(e,r):new jI(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ns(n,this.value)):n!==null&&_r(this.value)===_r(n)&&this.matchesComparison(Ns(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dn extends Ug{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Dn(e,n)}matches(e){return $g(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function $g(t){return t.op==="and"}function jg(t){return BI(t)&&$g(t)}function BI(t){for(const e of t.filters)if(e instanceof Dn)return!1;return!0}function jc(t){if(t instanceof ot)return t.field.canonicalString()+t.op.toString()+Os(t.value);if(jg(t))return t.filters.map(e=>jc(e)).join(",");{const e=t.filters.map(n=>jc(n)).join(",");return`${t.op}(${e})`}}function qg(t,e){return t instanceof ot?function(r,s){return s instanceof ot&&r.op===s.op&&r.field.isEqual(s.field)&&Vn(r.value,s.value)}(t,e):t instanceof Dn?function(r,s){return s instanceof Dn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&qg(o,s.filters[l]),!0):!1}(t,e):void fe()}function Hg(t){return t instanceof ot?function(n){return`${n.field.canonicalString()} ${n.op} ${Os(n.value)}`}(t):t instanceof Dn?function(n){return n.op.toString()+" {"+n.getFilters().map(Hg).join(" ,")+"}"}(t):"Filter"}class UI extends ot{constructor(e,n,r){super(e,n,r),this.key=ae.fromName(r.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class $I extends ot{constructor(e,n){super(e,"in",n),this.keys=zg("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class jI extends ot{constructor(e,n){super(e,"not-in",n),this.keys=zg("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function zg(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ae.fromName(r.referenceValue))}class qI extends ot{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ku(n)&&Qi(n.arrayValue,this.value)}}class HI extends ot{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Qi(this.value.arrayValue,n)}}class zI extends ot{constructor(e,n){super(e,"not-in",n)}matches(e){if(Qi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Qi(this.value.arrayValue,n)}}class GI extends ot{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ku(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Qi(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Gd(t,e=null,n=[],r=[],s=null,i=null,o=null){return new WI(t,e,n,r,s,i,o)}function Nu(t){const e=pe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>jc(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ya(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Os(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Os(r)).join(",")),e.ue=n}return e.ue}function Ou(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!FI(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!qg(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zd(t.startAt,e.startAt)&&zd(t.endAt,e.endAt)}function qc(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function KI(t,e,n,r,s,i,o,l){return new el(t,e,n,r,s,i,o,l)}function Mu(t){return new el(t)}function Wd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function QI(t){return t.collectionGroup!==null}function xi(t){const e=pe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new lt(vt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new va(i,r))}),n.has(vt.keyField().canonicalString())||e.ce.push(new va(vt.keyField(),r))}return e.ce}function Pn(t){const e=pe(t);return e.le||(e.le=XI(e,xi(t))),e.le}function XI(t,e){if(t.limitType==="F")return Gd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new va(s.field,i)});const n=t.endAt?new wa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new wa(t.startAt.position,t.startAt.inclusive):null;return Gd(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Hc(t,e,n){return new el(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function tl(t,e){return Ou(Pn(t),Pn(e))&&t.limitType===e.limitType}function Gg(t){return`${Nu(Pn(t))}|lt:${t.limitType}`}function as(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Hg(s)).join(", ")}]`),Ya(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Os(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Os(s)).join(",")),`Target(${r})`}(Pn(t))}; limitType=${t.limitType})`}function nl(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of xi(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=Hd(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,xi(r),s)||r.endAt&&!function(o,l,c){const u=Hd(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,xi(r),s))}(t,e)}function JI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Wg(t){return(e,n)=>{let r=!1;for(const s of xi(t)){const i=YI(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function YI(t,e,n){const r=t.field.isKeyField()?ae.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Ns(c,u):fe()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return fe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){br(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Lg(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=new Xe(ae.comparator);function zn(){return ZI}const Kg=new Xe(ae.comparator);function di(...t){let e=Kg;for(const n of t)e=e.insert(n.key,n);return e}function Qg(t){let e=Kg;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Fr(){return Vi()}function Xg(){return Vi()}function Vi(){return new Gr(t=>t.toString(),(t,e)=>t.isEqual(e))}const e0=new Xe(ae.comparator),t0=new lt(ae.comparator);function Ee(...t){let e=t0;for(const n of t)e=e.add(n);return e}const n0=new lt(be);function r0(){return n0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ya(e)?"-0":e}}function Jg(t){return{integerValue:""+t}}function s0(t,e){return VI(e)?Jg(e):Lu(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(){this._=void 0}}function i0(t,e,n){return t instanceof Ea?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Du(i)&&(i=Za(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Xi?Zg(t,e):t instanceof Ji?e_(t,e):function(s,i){const o=Yg(s,i),l=Kd(o)+Kd(s.Pe);return $c(o)&&$c(s.Pe)?Jg(l):Lu(s.serializer,l)}(t,e)}function o0(t,e,n){return t instanceof Xi?Zg(t,e):t instanceof Ji?e_(t,e):n}function Yg(t,e){return t instanceof ba?function(r){return $c(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Ea extends rl{}class Xi extends rl{constructor(e){super(),this.elements=e}}function Zg(t,e){const n=t_(e);for(const r of t.elements)n.some(s=>Vn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ji extends rl{constructor(e){super(),this.elements=e}}function e_(t,e){let n=t_(e);for(const r of t.elements)n=n.filter(s=>!Vn(s,r));return{arrayValue:{values:n}}}class ba extends rl{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Kd(t){return Ye(t.integerValue||t.doubleValue)}function t_(t){return ku(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function a0(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Xi&&s instanceof Xi||r instanceof Ji&&s instanceof Ji?ks(r.elements,s.elements,Vn):r instanceof ba&&s instanceof ba?Vn(r.Pe,s.Pe):r instanceof Ea&&s instanceof Ea}(t.transform,e.transform)}class l0{constructor(e,n){this.version=e,this.transformResults=n}}class rn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jo(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class sl{}function n_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Fu(t.key,rn.none()):new ro(t.key,t.data,rn.none());{const n=t.data,r=$t.empty();let s=new lt(vt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Tr(t.key,r,new Jt(s.toArray()),rn.none())}}function c0(t,e,n){t instanceof ro?function(s,i,o){const l=s.value.clone(),c=Xd(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Tr?function(s,i,o){if(!Jo(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Xd(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(r_(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Di(t,e,n,r){return t instanceof ro?function(i,o,l,c){if(!Jo(i.precondition,o))return l;const u=i.value.clone(),f=Jd(i.fieldTransforms,c,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Tr?function(i,o,l,c){if(!Jo(i.precondition,o))return l;const u=Jd(i.fieldTransforms,c,o),f=o.data;return f.setAll(r_(i)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(i,o,l){return Jo(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function u0(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Yg(r.transform,s||null);i!=null&&(n===null&&(n=$t.empty()),n.set(r.field,i))}return n||null}function Qd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ks(r,s,(i,o)=>a0(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ro extends sl{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Tr extends sl{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function r_(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Xd(t,e,n){const r=new Map;Oe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,o0(o,l,n[s]))}return r}function Jd(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,i0(i,o,e))}return r}class Fu extends sl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class h0 extends sl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&c0(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Di(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Di(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Xg();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=n_(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(de.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ee())}isEqual(e){return this.batchId===e.batchId&&ks(this.mutations,e.mutations,(n,r)=>Qd(n,r))&&ks(this.baseMutations,e.baseMutations,(n,r)=>Qd(n,r))}}class Bu{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Oe(e.mutations.length===r.length);let s=function(){return e0}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Bu(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt,Ae;function p0(t){switch(t){default:return fe();case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0}}function s_(t){if(t===void 0)return Hn("GRPC error has no .code"),q.UNKNOWN;switch(t){case tt.OK:return q.OK;case tt.CANCELLED:return q.CANCELLED;case tt.UNKNOWN:return q.UNKNOWN;case tt.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case tt.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case tt.INTERNAL:return q.INTERNAL;case tt.UNAVAILABLE:return q.UNAVAILABLE;case tt.UNAUTHENTICATED:return q.UNAUTHENTICATED;case tt.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case tt.NOT_FOUND:return q.NOT_FOUND;case tt.ALREADY_EXISTS:return q.ALREADY_EXISTS;case tt.PERMISSION_DENIED:return q.PERMISSION_DENIED;case tt.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case tt.ABORTED:return q.ABORTED;case tt.OUT_OF_RANGE:return q.OUT_OF_RANGE;case tt.UNIMPLEMENTED:return q.UNIMPLEMENTED;case tt.DATA_LOSS:return q.DATA_LOSS;default:return fe()}}(Ae=tt||(tt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=new $r([4294967295,4294967295],0);function Yd(t){const e=g0().encode(t),n=new Pg;return n.update(e),new Uint8Array(n.digest())}function Zd(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new $r([n,r],0),new $r([s,i],0)]}class Uu{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new mi(`Invalid padding: ${n}`);if(r<0)throw new mi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new mi(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ie=$r.fromNumber(this.Te)}Ee(e,n,r){let s=e.add(n.multiply($r.fromNumber(r)));return s.compare(_0)===1&&(s=new $r([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=Yd(e),[r,s]=Zd(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Uu(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Te===0)return;const n=Yd(e),[r,s]=Zd(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class mi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,so.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new il(de.min(),s,new Xe(be),zn(),Ee())}}class so{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new so(r,n,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class i_{constructor(e,n){this.targetId=e,this.me=n}}class o_{constructor(e,n,r=Et.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class em{constructor(){this.fe=0,this.ge=tm(),this.pe=Et.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ee(),n=Ee(),r=Ee();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:fe()}}),new so(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=tm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Oe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class y0{constructor(e){this.Le=e,this.Be=new Map,this.ke=zn(),this.qe=Mo(),this.Qe=Mo(),this.Ke=new Xe(be)}$e(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(n,e.Ve):this.We(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.We(n,e.key,e.Ve)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.je(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.De(e.resumeToken));break;default:fe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.je(s)&&n(s)})}Je(e){const n=e.targetId,r=e.me.count,s=this.Ye(n);if(s){const i=s.target;if(qc(i))if(r===0){const o=new ae(i.path);this.We(n,o,Dt.newNoDocument(o,de.min()))}else Oe(r===1);else{const o=this.Ze(n);if(o!==r){const l=this.Xe(e),c=l?this.et(l,e,o):1;if(c!==0){this.He(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}}}}}Xe(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=gr(r).toUint8Array()}catch(c){if(c instanceof Fg)return Ds("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Uu(o,s,i)}catch(c){return Ds(c instanceof mi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Te===0?null:l}et(e,n,r){return n.me.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.nt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.We(n,i,null),s++)}),s}it(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Ye(o);if(l){if(i.current&&qc(l.target)){const c=new ae(l.target.path);this.st(c).has(o)||this.ot(o,c)||this.We(o,c,Dt.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Ee();this.Qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new il(e,n,this.Ke,this.ke,r);return this.ke=zn(),this.qe=Mo(),this.Qe=Mo(),this.Ke=new Xe(be),s}Ue(e,n){if(!this.je(e))return;const r=this.ot(e,n.key)?2:0;this.ze(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e)),this.Qe=this.Qe.insert(n.key,this._t(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const s=this.ze(e);this.ot(e,n)?s.Fe(n,1):s.Me(n),this.Qe=this.Qe.insert(n,this._t(n).delete(e)),this.Qe=this.Qe.insert(n,this._t(n).add(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let n=this.Be.get(e);return n||(n=new em,this.Be.set(e,n)),n}_t(e){let n=this.Qe.get(e);return n||(n=new lt(be),this.Qe=this.Qe.insert(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new lt(be),this.qe=this.qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new em),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}ot(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Mo(){return new Xe(ae.comparator)}function tm(){return new Xe(ae.comparator)}const w0={asc:"ASCENDING",desc:"DESCENDING"},v0={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},E0={and:"AND",or:"OR"};class b0{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function zc(t,e){return t.useProto3Json||Ya(e)?e:{value:e}}function Ta(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function a_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function T0(t,e){return Ta(t,e.toTimestamp())}function xn(t){return Oe(!!t),de.fromTimestamp(function(n){const r=pr(n);return new at(r.seconds,r.nanos)}(t))}function $u(t,e){return Gc(t,e).canonicalString()}function Gc(t,e){const n=function(s){return new Ke(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function l_(t){const e=Ke.fromString(t);return Oe(d_(e)),e}function Wc(t,e){return $u(t.databaseId,e.path)}function nc(t,e){const n=l_(e);if(n.get(1)!==t.databaseId.projectId)throw new se(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new se(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(u_(n))}function c_(t,e){return $u(t.databaseId,e)}function A0(t){const e=l_(t);return e.length===4?Ke.emptyPath():u_(e)}function Kc(t){return new Ke(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function u_(t){return Oe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function nm(t,e,n){return{name:Wc(t,e),fields:n.value.mapValue.fields}}function I0(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:fe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,f){return u.useProto3Json?(Oe(f===void 0||typeof f=="string"),Et.fromBase64String(f||"")):(Oe(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Et.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const f=u.code===void 0?q.UNKNOWN:s_(u.code);return new se(f,u.message||"")}(o);n=new o_(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=nc(t,r.document.name),i=xn(r.document.updateTime),o=r.document.createTime?xn(r.document.createTime):de.min(),l=new $t({mapValue:{fields:r.document.fields}}),c=Dt.newFoundDocument(s,i,o,l),u=r.targetIds||[],f=r.removedTargetIds||[];n=new Yo(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=nc(t,r.document),i=r.readTime?xn(r.readTime):de.min(),o=Dt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Yo([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=nc(t,r.document),i=r.removedTargetIds||[];n=new Yo([],i,s,null)}else{if(!("filter"in e))return fe();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new m0(s,i),l=r.targetId;n=new i_(l,o)}}return n}function C0(t,e){let n;if(e instanceof ro)n={update:nm(t,e.key,e.value)};else if(e instanceof Fu)n={delete:Wc(t,e.key)};else if(e instanceof Tr)n={update:nm(t,e.key,e.data),updateMask:O0(e.fieldMask)};else{if(!(e instanceof h0))return fe();n={verify:Wc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Ea)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Xi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ji)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ba)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw fe()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:T0(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:fe()}(t,e.precondition)),n}function S0(t,e){return t&&t.length>0?(Oe(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?xn(s.updateTime):xn(i);return o.isEqual(de.min())&&(o=xn(i)),new l0(o,s.transformResults||[])}(n,e))):[]}function R0(t,e){return{documents:[c_(t,e.path)]}}function P0(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=c_(t,s);const i=function(u){if(u.length!==0)return f_(Dn.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(f=>function(p){return{field:ls(p.field),direction:D0(p.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=zc(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ct:n,parent:s}}function x0(t){let e=A0(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Oe(r===1);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(d){const p=h_(d);return p instanceof Dn&&jg(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(S){return new va(cs(S.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(d){let p;return p=typeof d=="object"?d.value:d,Ya(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(d){const p=!!d.before,g=d.values||[];return new wa(g,p)}(n.startAt));let u=null;return n.endAt&&(u=function(d){const p=!d.before,g=d.values||[];return new wa(g,p)}(n.endAt)),KI(e,s,o,i,l,"F",c,u)}function V0(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function h_(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=cs(n.unaryFilter.field);return ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=cs(n.unaryFilter.field);return ot.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=cs(n.unaryFilter.field);return ot.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=cs(n.unaryFilter.field);return ot.create(o,"!=",{nullValue:"NULL_VALUE"});default:return fe()}}(t):t.fieldFilter!==void 0?function(n){return ot.create(cs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return fe()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Dn.create(n.compositeFilter.filters.map(r=>h_(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return fe()}}(n.compositeFilter.op))}(t):fe()}function D0(t){return w0[t]}function k0(t){return v0[t]}function N0(t){return E0[t]}function ls(t){return{fieldPath:t.canonicalString()}}function cs(t){return vt.fromServerFormat(t.fieldPath)}function f_(t){return t instanceof ot?function(n){if(n.op==="=="){if(qd(n.value))return{unaryFilter:{field:ls(n.field),op:"IS_NAN"}};if(jd(n.value))return{unaryFilter:{field:ls(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(qd(n.value))return{unaryFilter:{field:ls(n.field),op:"IS_NOT_NAN"}};if(jd(n.value))return{unaryFilter:{field:ls(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ls(n.field),op:k0(n.op),value:n.value}}}(t):t instanceof Dn?function(n){const r=n.getFilters().map(s=>f_(s));return r.length===1?r[0]:{compositeFilter:{op:N0(n.op),filters:r}}}(t):fe()}function O0(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function d_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,n,r,s,i=de.min(),o=de.min(),l=Et.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new or(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e){this.ht=e}}function L0(t){const e=x0({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Hc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(){this.ln=new B0}addToCollectionParentIndex(e,n){return this.ln.add(n),B.resolve()}getCollectionParents(e,n){return B.resolve(this.ln.getEntries(n))}addFieldIndex(e,n){return B.resolve()}deleteFieldIndex(e,n){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,n){return B.resolve()}getDocumentsMatchingTarget(e,n){return B.resolve(null)}getIndexType(e,n){return B.resolve(0)}getFieldIndexes(e,n){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,n){return B.resolve(mr.min())}getMinOffsetFromCollectionGroup(e,n){return B.resolve(mr.min())}updateCollectionGroup(e,n,r){return B.resolve()}updateIndexEntries(e,n){return B.resolve()}}class B0{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new lt(Ke.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new lt(Ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ut{static withCacheSize(e){return new Ut(e,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ut.DEFAULT_COLLECTION_PERCENTILE=10,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ut.DEFAULT=new Ut(41943040,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ut.DISABLED=new Ut(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new Ms(0)}static Qn(){return new Ms(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm([t,e],[n,r]){const s=be(t,n);return s===0?be(e,r):s}class U0{constructor(e){this.Gn=e,this.buffer=new lt(sm),this.zn=0}jn(){return++this.zn}Hn(e){const n=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();sm(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class $0{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){te("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){qs(n)?te("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await js(n)}await this.Yn(3e5)})}}class j0{constructor(e,n){this.Zn=e,this.params=n}calculateTargetCount(e,n){return this.Zn.Xn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return B.resolve(Ja.oe);const r=new U0(n);return this.Zn.forEachTarget(e,s=>r.Hn(s.sequenceNumber)).next(()=>this.Zn.er(e,s=>r.Hn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(rm)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rm):this.tr(e,n))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,n){let r,s,i,o,l,c,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(e,s))).next(d=>(r=d,l=Date.now(),this.removeTargets(e,r,n))).next(d=>(i=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),os()<=Ie.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-f}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:d})))}}function q0(t,e){return new j0(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(){this.changes=new Gr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Dt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?B.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Di(r.mutation,s,Jt.empty(),at.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ee()){const s=Fr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=di();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Fr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ee()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=zn();const o=Vi(),l=function(){return Vi()}();return n.forEach((c,u)=>{const f=r.get(u.key);s.has(u.key)&&(f===void 0||f.mutation instanceof Tr)?i=i.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),Di(f.mutation,u,f.mutation.getFieldMask(),at.now())):o.set(u.key,Jt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,f)=>o.set(u,f)),n.forEach((u,f)=>{var d;return l.set(u,new z0(f,(d=o.get(u))!==null&&d!==void 0?d:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Vi();let s=new Xe((o,l)=>o-l),i=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let f=r.get(c)||Jt.empty();f=l.applyToLocalView(u,f),r.set(c,f);const d=(s.get(l.batchId)||Ee()).add(c);s=s.insert(l.batchId,d)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,f=c.value,d=Xg();f.forEach(p=>{if(!i.has(p)){const g=n_(n.get(p),r.get(p));g!==null&&d.set(p,g),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return B.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):QI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):B.resolve(Fr());let l=-1,c=i;return o.next(u=>B.forEach(u,(f,d)=>(l<d.largestBatchId&&(l=d.largestBatchId),i.get(f)?B.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{c=c.insert(f,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Ee())).next(f=>({batchId:l,changes:Qg(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(r=>{let s=di();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=di();return this.indexManager.getCollectionParents(e,i).next(l=>B.forEach(l,c=>{const u=function(d,p){return new el(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(f=>{f.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const f=u.getKey();o.get(f)===null&&(o=o.insert(f,Dt.newInvalidDocument(f)))});let l=di();return o.forEach((c,u)=>{const f=i.get(c);f!==void 0&&Di(f.mutation,u,Jt.empty(),at.now()),nl(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,n){return B.resolve(this.Tr.get(n))}saveBundleMetadata(e,n){return this.Tr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:xn(s.createTime)}}(n)),B.resolve()}getNamedQuery(e,n){return B.resolve(this.Ir.get(n))}saveNamedQuery(e,n){return this.Ir.set(n.name,function(s){return{name:s.name,query:L0(s.bundledQuery),readTime:xn(s.readTime)}}(n)),B.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(){this.overlays=new Xe(ae.comparator),this.Er=new Map}getOverlay(e,n){return B.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Fr();return B.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.Tt(e,n,i)}),B.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Er.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Er.delete(r)),B.resolve()}getOverlaysForCollection(e,n,r){const s=Fr(),i=n.length+1,o=new ae(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return B.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Xe((u,f)=>u-f);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let f=i.get(u.largestBatchId);f===null&&(f=Fr(),i=i.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const l=Fr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>l.set(u,f)),!(l.size()>=s)););return B.resolve(l)}Tt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Er.get(s.largestBatchId).delete(r.key);this.Er.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new d0(n,r));let i=this.Er.get(n);i===void 0&&(i=Ee(),this.Er.set(n,i)),this.Er.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,B.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(){this.dr=new lt(ht.Ar),this.Rr=new lt(ht.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,n){const r=new ht(e,n);this.dr=this.dr.add(r),this.Rr=this.Rr.add(r)}mr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.gr(new ht(e,n))}pr(e,n){e.forEach(r=>this.removeReference(r,n))}yr(e){const n=new ae(new Ke([])),r=new ht(n,e),s=new ht(n,e+1),i=[];return this.Rr.forEachInRange([r,s],o=>{this.gr(o),i.push(o.key)}),i}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const n=new ae(new Ke([])),r=new ht(n,e),s=new ht(n,e+1);let i=Ee();return this.Rr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new ht(e,0),r=this.dr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ht{constructor(e,n){this.key=e,this.br=n}static Ar(e,n){return ae.comparator(e.key,n.key)||be(e.br,n.br)}static Vr(e,n){return be(e.br,n.br)||ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Dr=1,this.vr=new lt(ht.Ar)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new f0(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.vr=this.vr.add(new ht(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return B.resolve(o)}lookupMutationBatch(e,n){return B.resolve(this.Cr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Fr(r),i=s<0?0:s;return B.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ht(n,0),s=new ht(n,Number.POSITIVE_INFINITY),i=[];return this.vr.forEachInRange([r,s],o=>{const l=this.Cr(o.br);i.push(l)}),B.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new lt(be);return n.forEach(s=>{const i=new ht(s,0),o=new ht(s,Number.POSITIVE_INFINITY);this.vr.forEachInRange([i,o],l=>{r=r.add(l.br)})}),B.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ae.isDocumentKey(i)||(i=i.child(""));const o=new ht(new ae(i),0);let l=new lt(be);return this.vr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.br)),!0)},o),B.resolve(this.Mr(l))}Mr(e){const n=[];return e.forEach(r=>{const s=this.Cr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Oe(this.Or(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return B.forEach(n.mutations,s=>{const i=new ht(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.vr=r})}Ln(e){}containsKey(e,n){const r=new ht(n,0),s=this.vr.firstAfterOrEqual(r);return B.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}Or(e,n){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const n=this.Fr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e){this.Nr=e,this.docs=function(){return new Xe(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Nr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return B.resolve(r?r.document.mutableCopy():Dt.newInvalidDocument(n))}getEntries(e,n){let r=zn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Dt.newInvalidDocument(s))}),B.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=zn();const o=n.path,l=new ae(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||SI(CI(f),r)<=0||(s.has(f.key)||nl(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return B.resolve(i)}getAllFromCollectionGroup(e,n,r,s){fe()}Lr(e,n){return B.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Y0(this)}getSize(e){return B.resolve(this.size)}}class Y0 extends H0{constructor(e){super(),this.hr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.hr.addEntry(e,s)):this.hr.removeEntry(r)}),B.waitFor(n)}getFromCache(e,n){return this.hr.getEntry(e,n)}getAllFromCache(e,n){return this.hr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e){this.persistence=e,this.Br=new Gr(n=>Nu(n),Ou),this.lastRemoteSnapshotVersion=de.min(),this.highestTargetId=0,this.kr=0,this.qr=new ju,this.targetCount=0,this.Qr=Ms.qn()}forEachTarget(e,n){return this.Br.forEach((r,s)=>n(s)),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.kr&&(this.kr=n),B.resolve()}Un(e){this.Br.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Qr=new Ms(n),this.highestTargetId=n),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,n){return this.Un(n),this.targetCount+=1,B.resolve()}updateTargetData(e,n){return this.Un(n),B.resolve()}removeTargetData(e,n){return this.Br.delete(n.target),this.qr.yr(n.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Br.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Br.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),B.waitFor(i).next(()=>s)}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,n){const r=this.Br.get(n)||null;return B.resolve(r)}addMatchingKeys(e,n,r){return this.qr.mr(n,r),B.resolve()}removeMatchingKeys(e,n,r){this.qr.pr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),B.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.qr.yr(n),B.resolve()}getMatchingKeysForTargetId(e,n){const r=this.qr.Sr(n);return B.resolve(r)}containsKey(e,n){return B.resolve(this.qr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e,n){this.Kr={},this.overlays={},this.$r=new Ja(0),this.Ur=!1,this.Ur=!0,this.Wr=new Q0,this.referenceDelegate=e(this),this.Gr=new Z0(this),this.indexManager=new F0,this.remoteDocumentCache=function(s){return new J0(s)}(r=>this.referenceDelegate.zr(r)),this.serializer=new M0(n),this.jr=new W0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new K0,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Kr[e.toKey()];return r||(r=new X0(n,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,n,r){te("MemoryPersistence","Starting transaction:",e);const s=new eC(this.$r.next());return this.referenceDelegate.Hr(),r(s).next(i=>this.referenceDelegate.Jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Yr(e,n){return B.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,n)))}}class eC extends PI{constructor(e){super(),this.currentSequenceNumber=e}}class qu{constructor(e){this.persistence=e,this.Zr=new ju,this.Xr=null}static ei(e){return new qu(e)}get ti(){if(this.Xr)return this.Xr;throw fe()}addReference(e,n,r){return this.Zr.addReference(r,n),this.ti.delete(r.toString()),B.resolve()}removeReference(e,n,r){return this.Zr.removeReference(r,n),this.ti.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,n){return this.ti.add(n.toString()),B.resolve()}removeTarget(e,n){this.Zr.yr(n.targetId).forEach(s=>this.ti.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.ti.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Hr(){this.Xr=new Set}Jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.ti,r=>{const s=ae.fromPath(r);return this.ni(e,s).next(i=>{i||n.removeEntry(s,de.min())})}).next(()=>(this.Xr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ni(e,n).next(r=>{r?this.ti.delete(n.toString()):this.ti.add(n.toString())})}zr(e){return 0}ni(e,n){return B.or([()=>B.resolve(this.Zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Yr(e,n)])}}class Aa{constructor(e,n){this.persistence=e,this.ri=new Gr(r=>DI(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=q0(this,n)}static ei(e,n){return new Aa(e,n)}Hr(){}Jr(e){return B.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Xn(e){const n=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}nr(e){let n=0;return this.er(e,r=>{n++}).next(()=>n)}er(e,n){return B.forEach(this.ri,(r,s)=>this.ir(e,r,s).next(i=>i?B.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Lr(e,o=>this.ir(e,o,n).next(l=>{l||(r++,i.removeEntry(o,de.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ri.set(n,e.currentSequenceNumber),B.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,n){return this.ri.set(n,e.currentSequenceNumber),B.resolve()}zr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Qo(e.data.value)),n}ir(e,n,r){return B.or([()=>this.persistence.Yr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.ri.get(n);return B.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Wi=r,this.Gi=s}static zi(e,n){let r=Ee(),s=Ee();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Hu(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return eA()?8:xI(YT())>0?6:4}()}initialize(e,n){this.Zi=e,this.indexManager=n,this.ji=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Xi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.es(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new tC;return this.ts(e,n,o).next(l=>{if(i.result=l,this.Hi)return this.ns(e,n,o,l.size)})}).next(()=>i.result)}ns(e,n,r,s){return r.documentReadCount<this.Ji?(os()<=Ie.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",as(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),B.resolve()):(os()<=Ie.DEBUG&&te("QueryEngine","Query:",as(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Yi*s?(os()<=Ie.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",as(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pn(n))):B.resolve())}Xi(e,n){if(Wd(n))return B.resolve(null);let r=Pn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Hc(n,null,"F"),r=Pn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ee(...i);return this.Zi.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.rs(n,l);return this.ss(n,u,o,c.readTime)?this.Xi(e,Hc(n,null,"F")):this.os(e,u,n,c)}))})))}es(e,n,r,s){return Wd(n)||s.isEqual(de.min())?B.resolve(null):this.Zi.getDocuments(e,r).next(i=>{const o=this.rs(n,i);return this.ss(n,o,r,s)?B.resolve(null):(os()<=Ie.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),as(n)),this.os(e,o,n,II(s,-1)).next(l=>l))})}rs(e,n){let r=new lt(Wg(e));return n.forEach((s,i)=>{nl(e,i)&&(r=r.add(i))}),r}ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ts(e,n,r){return os()<=Ie.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",as(n)),this.Zi.getDocumentsMatchingQuery(e,n,mr.min(),r)}os(e,n,r,s){return this.Zi.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,n,r,s){this.persistence=e,this._s=n,this.serializer=s,this.us=new Xe(be),this.cs=new Gr(i=>Nu(i),Ou),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new G0(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.us))}}function sC(t,e,n,r){return new rC(t,e,n,r)}async function p_(t,e){const n=pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ps(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Ee();for(const u of s){o.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of i){l.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(u=>({Ts:u,removedBatchIds:o,addedBatchIds:l}))})})}function iC(t,e){const n=pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.hs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,f){const d=u.batch,p=d.keys();let g=B.resolve();return p.forEach(S=>{g=g.next(()=>f.getEntry(c,S)).next(R=>{const x=u.docVersions.get(S);Oe(x!==null),R.version.compareTo(x)<0&&(d.applyToRemoteDocument(R,u),R.isValidDocument()&&(R.setReadTime(u.commitVersion),f.addEntry(R)))})}),g.next(()=>l.mutationQueue.removeMutationBatch(c,d))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Ee();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function g_(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Gr.getLastRemoteSnapshotVersion(n))}function oC(t,e){const n=pe(t),r=e.snapshotVersion;let s=n.us;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.hs.newChangeBuffer({trackRemovals:!0});s=n.us;const l=[];e.targetChanges.forEach((f,d)=>{const p=s.get(d);if(!p)return;l.push(n.Gr.removeMatchingKeys(i,f.removedDocuments,d).next(()=>n.Gr.addMatchingKeys(i,f.addedDocuments,d)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(Et.EMPTY_BYTE_STRING,de.min()).withLastLimboFreeSnapshotVersion(de.min()):f.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(f.resumeToken,r)),s=s.insert(d,g),function(R,x,j){return R.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(p,g,f)&&l.push(n.Gr.updateTargetData(i,g))});let c=zn(),u=Ee();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(aC(i,o,e.documentUpdates).next(f=>{c=f.Is,u=f.Es})),!r.isEqual(de.min())){const f=n.Gr.getLastRemoteSnapshotVersion(i).next(d=>n.Gr.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return B.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.us=s,i))}function aC(t,e,n){let r=Ee(),s=Ee();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=zn();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(de.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):te("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Is:o,Es:s}})}function lC(t,e){const n=pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function cC(t,e){const n=pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Gr.getTargetData(r,e).next(i=>i?(s=i,B.resolve(s)):n.Gr.allocateTargetId(r).next(o=>(s=new or(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Gr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.us.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.us=n.us.insert(r.targetId,r),n.cs.set(e,r.targetId)),r})}async function Qc(t,e,n){const r=pe(t),s=r.us.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!qs(o))throw o;te("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.us=r.us.remove(e),r.cs.delete(s.target)}function im(t,e,n){const r=pe(t);let s=de.min(),i=Ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,f){const d=pe(c),p=d.cs.get(f);return p!==void 0?B.resolve(d.us.get(p)):d.Gr.getTargetData(u,f)}(r,o,Pn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r._s.getDocumentsMatchingQuery(o,e,n?s:de.min(),n?i:Ee())).next(l=>(uC(r,JI(e),l),{documents:l,ds:i})))}function uC(t,e,n){let r=t.ls.get(e)||de.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.ls.set(e,r)}class om{constructor(){this.activeTargetIds=r0()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hC{constructor(){this._o=new om,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,n,r){this.ao[e]=n}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new om,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){te("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){te("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lo=null;function rc(){return Lo===null?Lo=function(){return 268435456+Math.round(2147483648*Math.random())}():Lo++,"0x"+Lo.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="WebChannelConnection";class pC extends class{get Co(){return!1}constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+n.host,this.Mo=`projects/${s}/databases/${i}`,this.xo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Oo(n,r,s,i,o){const l=rc(),c=this.No(n,r.toUriEncodedString());te("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(u,i,o),this.Bo(n,c,u,s).then(f=>(te("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw Ds("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",c,"request:",s),f})}ko(n,r,s,i,o,l){return this.Oo(n,r,s,i,o)}Lo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$s}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}No(n,r){const s=dC[n];return`${this.Fo}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,n,r,s){const i=rc();return new Promise((o,l)=>{const c=new xg;c.setWithCredentials(!0),c.listenOnce(Vg.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ko.NO_ERROR:const f=c.getResponseJson();te(St,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),o(f);break;case Ko.TIMEOUT:te(St,`RPC '${e}' ${i} timed out`),l(new se(q.DEADLINE_EXCEEDED,"Request time out"));break;case Ko.HTTP_ERROR:const d=c.getStatus();if(te(St,`RPC '${e}' ${i} failed with status:`,d,"response text:",c.getResponseText()),d>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const S=function(x){const j=x.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(j)>=0?j:q.UNKNOWN}(g.status);l(new se(S,g.message))}else l(new se(q.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new se(q.UNAVAILABLE,"Connection failed."));break;default:fe()}}finally{te(St,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);te(St,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}qo(e,n,r){const s=rc(),i=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ng(),l=kg(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Lo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=i.join("");te(St,`Creating RPC '${e}' stream ${s}: ${f}`,c);const d=o.createWebChannel(f,c);let p=!1,g=!1;const S=new mC({Eo:x=>{g?te(St,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(p||(te(St,`Opening RPC '${e}' stream ${s} transport.`),d.open(),p=!0),te(St,`RPC '${e}' stream ${s} sending:`,x),d.send(x))},Ao:()=>d.close()}),R=(x,j,D)=>{x.listen(j,O=>{try{D(O)}catch(N){setTimeout(()=>{throw N},0)}})};return R(d,fi.EventType.OPEN,()=>{g||(te(St,`RPC '${e}' stream ${s} transport opened.`),S.So())}),R(d,fi.EventType.CLOSE,()=>{g||(g=!0,te(St,`RPC '${e}' stream ${s} transport closed`),S.Do())}),R(d,fi.EventType.ERROR,x=>{g||(g=!0,Ds(St,`RPC '${e}' stream ${s} transport errored:`,x),S.Do(new se(q.UNAVAILABLE,"The operation could not be completed")))}),R(d,fi.EventType.MESSAGE,x=>{var j;if(!g){const D=x.data[0];Oe(!!D);const O=D,N=(O==null?void 0:O.error)||((j=O[0])===null||j===void 0?void 0:j.error);if(N){te(St,`RPC '${e}' stream ${s} received error:`,N);const ne=N.status;let Q=function(y){const b=tt[y];if(b!==void 0)return s_(b)}(ne),T=N.message;Q===void 0&&(Q=q.INTERNAL,T="Unknown error status: "+ne+" with message "+N.message),g=!0,S.Do(new se(Q,T)),d.close()}else te(St,`RPC '${e}' stream ${s} received:`,D),S.vo(D)}}),R(l,Dg.STAT_EVENT,x=>{x.stat===Bc.PROXY?te(St,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===Bc.NOPROXY&&te(St,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{S.bo()},0),S}}function sc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(t){return new b0(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,n,r=1e3,s=1.5,i=6e4){this.li=e,this.timerId=n,this.Qo=r,this.Ko=s,this.$o=i,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const n=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),s=Math.max(0,n-r);s>0&&te("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Uo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,s,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,n,r,s,i,o,l,c){this.li=e,this.Yo=r,this.Zo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new __(e,n)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,n){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():n&&n.code===q.RESOURCE_EXHAUSTED?(Hn(n.toString()),Hn("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):n&&n.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(n)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),n=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Xo===n&&this.I_(r,s)},r=>{e(()=>{const s=new se(q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.E_(s)})})}I_(e,n){const r=this.T_(this.Xo);this.stream=this.d_(e,n),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(s=>{r(()=>this.E_(s))}),this.stream.onMessage(s=>{r(()=>++this.n_==1?this.A_(s):this.onNext(s))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return te("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return n=>{this.li.enqueueAndForget(()=>this.Xo===e?n():(te("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gC extends y_{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}d_(e,n){return this.connection.qo("Listen",e,n)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const n=I0(this.serializer,e),r=function(i){if(!("targetChange"in i))return de.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?de.min():o.readTime?xn(o.readTime):de.min()}(e);return this.listener.R_(n,r)}V_(e){const n={};n.database=Kc(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=qc(c)?{documents:R0(i,c)}:{query:P0(i,c).ct},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=a_(i,o.resumeToken);const u=zc(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(de.min())>0){l.readTime=Ta(i,o.snapshotVersion.toTimestamp());const u=zc(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=V0(this.serializer,e);r&&(n.labels=r),this.c_(n)}m_(e){const n={};n.database=Kc(this.serializer),n.removeTarget=e,this.c_(n)}}class _C extends y_{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,n){return this.connection.qo("Write",e,n)}A_(e){return Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const n=S0(e.writeResults,e.commitTime),r=xn(e.commitTime);return this.listener.y_(r,n)}w_(){const e={};e.database=Kc(this.serializer),this.c_(e)}g_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>C0(this.serializer,r))};this.c_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.S_=!1}b_(){if(this.S_)throw new se(q.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,n,r,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Oo(e,Gc(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new se(q.UNKNOWN,i.toString())})}ko(e,n,r,s,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.ko(e,Gc(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new se(q.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class wC{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Hn(n),this.C_=!1):te("OnlineStateTracker",n)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=i,this.Q_.uo(o=>{r.enqueueAndForget(async()=>{Wr(this)&&(te("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=pe(c);u.k_.add(4),await io(u),u.K_.set("Unknown"),u.k_.delete(4),await al(u)}(this))})}),this.K_=new wC(r,s)}}async function al(t){if(Wr(t))for(const e of t.q_)await e(!0)}async function io(t){for(const e of t.q_)await e(!1)}function w_(t,e){const n=pe(t);n.B_.has(e.targetId)||(n.B_.set(e.targetId,e),Ku(n)?Wu(n):Hs(n).s_()&&Gu(n,e))}function zu(t,e){const n=pe(t),r=Hs(n);n.B_.delete(e),r.s_()&&v_(n,e),n.B_.size===0&&(r.s_()?r.a_():Wr(n)&&n.K_.set("Unknown"))}function Gu(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(de.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Hs(t).V_(e)}function v_(t,e){t.U_.xe(e),Hs(t).m_(e)}function Wu(t){t.U_=new y0({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Hs(t).start(),t.K_.F_()}function Ku(t){return Wr(t)&&!Hs(t).i_()&&t.B_.size>0}function Wr(t){return pe(t).k_.size===0}function E_(t){t.U_=void 0}async function EC(t){t.K_.set("Online")}async function bC(t){t.B_.forEach((e,n)=>{Gu(t,e)})}async function TC(t,e){E_(t),Ku(t)?(t.K_.O_(e),Wu(t)):t.K_.set("Unknown")}async function AC(t,e,n){if(t.K_.set("Online"),e instanceof o_&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.B_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.B_.delete(l),s.U_.removeTarget(l))}(t,e)}catch(r){te("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ia(t,r)}else if(e instanceof Yo?t.U_.$e(e):e instanceof i_?t.U_.Je(e):t.U_.Ge(e),!n.isEqual(de.min()))try{const r=await g_(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.U_.it(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.B_.get(u);f&&i.B_.set(u,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const f=i.B_.get(c);if(!f)return;i.B_.set(c,f.withResumeToken(Et.EMPTY_BYTE_STRING,f.snapshotVersion)),v_(i,c);const d=new or(f.target,c,u,f.sequenceNumber);Gu(i,d)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){te("RemoteStore","Failed to raise snapshot:",r),await Ia(t,r)}}async function Ia(t,e,n){if(!qs(e))throw e;t.k_.add(1),await io(t),t.K_.set("Offline"),n||(n=()=>g_(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te("RemoteStore","Retrying IndexedDB access"),await n(),t.k_.delete(1),await al(t)})}function b_(t,e){return e().catch(n=>Ia(t,n,e))}async function ll(t){const e=pe(t),n=yr(e);let r=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;IC(e);)try{const s=await lC(e.localStore,r);if(s===null){e.L_.length===0&&n.a_();break}r=s.batchId,CC(e,s)}catch(s){await Ia(e,s)}T_(e)&&A_(e)}function IC(t){return Wr(t)&&t.L_.length<10}function CC(t,e){t.L_.push(e);const n=yr(t);n.s_()&&n.f_&&n.g_(e.mutations)}function T_(t){return Wr(t)&&!yr(t).i_()&&t.L_.length>0}function A_(t){yr(t).start()}async function SC(t){yr(t).w_()}async function RC(t){const e=yr(t);for(const n of t.L_)e.g_(n.mutations)}async function PC(t,e,n){const r=t.L_.shift(),s=Bu.from(r,e,n);await b_(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ll(t)}async function xC(t,e){e&&yr(t).f_&&await async function(r,s){if(function(o){return p0(o)&&o!==q.ABORTED}(s.code)){const i=r.L_.shift();yr(r).__(),await b_(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ll(r)}}(t,e),T_(t)&&A_(t)}async function lm(t,e){const n=pe(t);n.asyncQueue.verifyOperationInProgress(),te("RemoteStore","RemoteStore received new credentials");const r=Wr(n);n.k_.add(3),await io(n),r&&n.K_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.k_.delete(3),await al(n)}async function VC(t,e){const n=pe(t);e?(n.k_.delete(2),await al(n)):e||(n.k_.add(2),await io(n),n.K_.set("Unknown"))}function Hs(t){return t.W_||(t.W_=function(n,r,s){const i=pe(n);return i.b_(),new gC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Ro:EC.bind(null,t),mo:bC.bind(null,t),po:TC.bind(null,t),R_:AC.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),Ku(t)?Wu(t):t.K_.set("Unknown")):(await t.W_.stop(),E_(t))})),t.W_}function yr(t){return t.G_||(t.G_=function(n,r,s){const i=pe(n);return i.b_(),new _C(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:SC.bind(null,t),po:xC.bind(null,t),p_:RC.bind(null,t),y_:PC.bind(null,t)}),t.q_.push(async e=>{e?(t.G_.__(),await ll(t)):(await t.G_.stop(),t.L_.length>0&&(te("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))})),t.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new jn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Qu(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xu(t,e){if(Hn("AsyncQueue",`${e}: ${t}`),qs(t))return new se(q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{static emptySet(e){return new Ts(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ae.comparator(n.key,r.key):(n,r)=>ae.comparator(n.key,r.key),this.keyedMap=di(),this.sortedSet=new Xe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ts)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ts;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(){this.z_=new Xe(ae.comparator)}track(e){const n=e.doc.key,r=this.z_.get(n);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(n,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(n):e.type===1&&r.type===2?this.z_=this.z_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):fe():this.z_=this.z_.insert(n,e)}j_(){const e=[];return this.z_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ls{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ls(e,n,Ts.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class kC{constructor(){this.queries=um(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(n,r){const s=pe(n),i=s.queries;s.queries=um(),i.forEach((o,l)=>{for(const c of l.J_)c.onError(r)})})(this,new se(q.ABORTED,"Firestore shutting down"))}}function um(){return new Gr(t=>Gg(t),tl)}async function I_(t,e){const n=pe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Y_()&&e.Z_()&&(r=2):(i=new DC,r=e.Z_()?0:1);try{switch(r){case 0:i.H_=await n.onListen(s,!0);break;case 1:i.H_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Xu(o,`Initialization of query '${as(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.J_.push(e),e.ea(n.onlineState),i.H_&&e.ta(i.H_)&&Ju(n)}async function C_(t,e){const n=pe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.J_.indexOf(e);o>=0&&(i.J_.splice(o,1),i.J_.length===0?s=e.Z_()?0:1:!i.Y_()&&e.Z_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function NC(t,e){const n=pe(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.J_)l.ta(s)&&(r=!0);o.H_=s}}r&&Ju(n)}function OC(t,e,n){const r=pe(t),s=r.queries.get(e);if(s)for(const i of s.J_)i.onError(n);r.queries.delete(e)}function Ju(t){t.X_.forEach(e=>{e.next()})}var Xc,hm;(hm=Xc||(Xc={})).na="default",hm.Cache="cache";class S_{constructor(e,n,r){this.query=e,this.ra=n,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ls(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ia?this.oa(e)&&(this.ra.next(e),n=!0):this._a(e,this.onlineState)&&(this.aa(e),n=!0),this.sa=e,n}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let n=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),n=!0),n}_a(e,n){if(!e.fromCache||!this.Z_())return!0;const r=n!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const n=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}aa(e){e=Ls.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Xc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e){this.key=e}}class P_{constructor(e){this.key=e}}class MC{constructor(e,n){this.query=e,this.da=n,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Ee(),this.mutatedKeys=Ee(),this.Va=Wg(e),this.ma=new Ts(this.Va)}get fa(){return this.da}ga(e,n){const r=n?n.pa:new cm,s=n?n.ma:this.ma;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,d)=>{const p=s.get(f),g=nl(this.query,d)?d:null,S=!!p&&this.mutatedKeys.has(p.key),R=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let x=!1;p&&g?p.data.isEqual(g.data)?S!==R&&(r.track({type:3,doc:g}),x=!0):this.ya(p,g)||(r.track({type:2,doc:g}),x=!0,(c&&this.Va(g,c)>0||u&&this.Va(g,u)<0)&&(l=!0)):!p&&g?(r.track({type:0,doc:g}),x=!0):p&&!g&&(r.track({type:1,doc:p}),x=!0,(c||u)&&(l=!0)),x&&(g?(o=o.add(g),i=R?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{ma:o,pa:r,ss:l,mutatedKeys:i}}ya(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((f,d)=>function(g,S){const R=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe()}};return R(g)-R(S)}(f.type,d.type)||this.Va(f.doc,d.doc)),this.wa(r),s=s!=null&&s;const l=n&&!s?this.Sa():[],c=this.Ra.size===0&&this.current&&!s?1:0,u=c!==this.Aa;return this.Aa=c,o.length!==0||u?{snapshot:new Ls(this.query,e.ma,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:l}:{ba:l}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new cm,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(n=>this.da=this.da.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.da=this.da.delete(n)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=Ee(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});const n=[];return e.forEach(r=>{this.Ra.has(r)||n.push(new P_(r))}),this.Ra.forEach(r=>{e.has(r)||n.push(new R_(r))}),n}va(e){this.da=e.ds,this.Ra=Ee();const n=this.ga(e.documents);return this.applyChanges(n,!0)}Ca(){return Ls.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class LC{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class FC{constructor(e){this.key=e,this.Fa=!1}}class BC{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new Gr(l=>Gg(l),tl),this.Oa=new Map,this.Na=new Set,this.La=new Xe(ae.comparator),this.Ba=new Map,this.ka=new ju,this.qa={},this.Qa=new Map,this.Ka=Ms.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function UC(t,e,n=!0){const r=O_(t);let s;const i=r.xa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Ca()):s=await x_(r,e,n,!0),s}async function $C(t,e){const n=O_(t);await x_(n,e,!0,!1)}async function x_(t,e,n,r){const s=await cC(t.localStore,Pn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await jC(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&w_(t.remoteStore,s),l}async function jC(t,e,n,r,s){t.Ua=(d,p,g)=>async function(R,x,j,D){let O=x.view.ga(j);O.ss&&(O=await im(R.localStore,x.query,!1).then(({documents:T})=>x.view.ga(T,O)));const N=D&&D.targetChanges.get(x.targetId),ne=D&&D.targetMismatches.get(x.targetId)!=null,Q=x.view.applyChanges(O,R.isPrimaryClient,N,ne);return dm(R,x.targetId,Q.ba),Q.snapshot}(t,d,p,g);const i=await im(t.localStore,e,!0),o=new MC(e,i.ds),l=o.ga(i.documents),c=so.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);dm(t,n,u.ba);const f=new LC(e,n,o);return t.xa.set(e,f),t.Oa.has(n)?t.Oa.get(n).push(e):t.Oa.set(n,[e]),u.snapshot}async function qC(t,e,n){const r=pe(t),s=r.xa.get(e),i=r.Oa.get(s.targetId);if(i.length>1)return r.Oa.set(s.targetId,i.filter(o=>!tl(o,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Qc(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&zu(r.remoteStore,s.targetId),Jc(r,s.targetId)}).catch(js)):(Jc(r,s.targetId),await Qc(r.localStore,s.targetId,!0))}async function HC(t,e){const n=pe(t),r=n.xa.get(e),s=n.Oa.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),zu(n.remoteStore,r.targetId))}async function zC(t,e,n){const r=YC(t);try{const s=await function(o,l){const c=pe(o),u=at.now(),f=l.reduce((g,S)=>g.add(S.key),Ee());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let S=zn(),R=Ee();return c.hs.getEntries(g,f).next(x=>{S=x,S.forEach((j,D)=>{D.isValidDocument()||(R=R.add(j))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,S)).next(x=>{d=x;const j=[];for(const D of l){const O=u0(D,d.get(D.key).overlayedDocument);O!=null&&j.push(new Tr(D.key,O,Bg(O.value.mapValue),rn.exists(!0)))}return c.mutationQueue.addMutationBatch(g,u,j,l)}).next(x=>{p=x;const j=x.applyToLocalDocumentSet(d,R);return c.documentOverlayCache.saveOverlays(g,x.batchId,j)})}).then(()=>({batchId:p.batchId,changes:Qg(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.qa[o.currentUser.toKey()];u||(u=new Xe(be)),u=u.insert(l,c),o.qa[o.currentUser.toKey()]=u}(r,s.batchId,n),await oo(r,s.changes),await ll(r.remoteStore)}catch(s){const i=Xu(s,"Failed to persist write");n.reject(i)}}async function V_(t,e){const n=pe(t);try{const r=await oC(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Ba.get(i);o&&(Oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Fa=!0:s.modifiedDocuments.size>0?Oe(o.Fa):s.removedDocuments.size>0&&(Oe(o.Fa),o.Fa=!1))}),await oo(n,r,e)}catch(r){await js(r)}}function fm(t,e,n){const r=pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.xa.forEach((i,o)=>{const l=o.view.ea(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=pe(o);c.onlineState=l;let u=!1;c.queries.forEach((f,d)=>{for(const p of d.J_)p.ea(l)&&(u=!0)}),u&&Ju(c)}(r.eventManager,e),s.length&&r.Ma.R_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function GC(t,e,n){const r=pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Ba.get(e),i=s&&s.key;if(i){let o=new Xe(ae.comparator);o=o.insert(i,Dt.newNoDocument(i,de.min()));const l=Ee().add(i),c=new il(de.min(),new Map,new Xe(be),o,l);await V_(r,c),r.La=r.La.remove(i),r.Ba.delete(e),Yu(r)}else await Qc(r.localStore,e,!1).then(()=>Jc(r,e,n)).catch(js)}async function WC(t,e){const n=pe(t),r=e.batch.batchId;try{const s=await iC(n.localStore,e);k_(n,r,null),D_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await oo(n,s)}catch(s){await js(s)}}async function KC(t,e,n){const r=pe(t);try{const s=await function(o,l){const c=pe(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,l).next(d=>(Oe(d!==null),f=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(r.localStore,e);k_(r,e,n),D_(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await oo(r,s)}catch(s){await js(s)}}function D_(t,e){(t.Qa.get(e)||[]).forEach(n=>{n.resolve()}),t.Qa.delete(e)}function k_(t,e,n){const r=pe(t);let s=r.qa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.qa[r.currentUser.toKey()]=s}}function Jc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Oa.get(e))t.xa.delete(r),n&&t.Ma.Wa(r,n);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(r=>{t.ka.containsKey(r)||N_(t,r)})}function N_(t,e){t.Na.delete(e.path.canonicalString());const n=t.La.get(e);n!==null&&(zu(t.remoteStore,n),t.La=t.La.remove(e),t.Ba.delete(n),Yu(t))}function dm(t,e,n){for(const r of n)r instanceof R_?(t.ka.addReference(r.key,e),QC(t,r)):r instanceof P_?(te("SyncEngine","Document no longer in limbo: "+r.key),t.ka.removeReference(r.key,e),t.ka.containsKey(r.key)||N_(t,r.key)):fe()}function QC(t,e){const n=e.key,r=n.path.canonicalString();t.La.get(n)||t.Na.has(r)||(te("SyncEngine","New document in limbo: "+n),t.Na.add(r),Yu(t))}function Yu(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const n=new ae(Ke.fromString(e)),r=t.Ka.next();t.Ba.set(r,new FC(n)),t.La=t.La.insert(n,r),w_(t.remoteStore,new or(Pn(Mu(n.path)),r,"TargetPurposeLimboResolution",Ja.oe))}}async function oo(t,e,n){const r=pe(t),s=[],i=[],o=[];r.xa.isEmpty()||(r.xa.forEach((l,c)=>{o.push(r.Ua(c,e,n).then(u=>{var f;if((u||n)&&r.isPrimaryClient){const d=u?!u.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){s.push(u);const d=Hu.zi(c.targetId,u);i.push(d)}}))}),await Promise.all(o),r.Ma.R_(s),await async function(c,u){const f=pe(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>B.forEach(u,p=>B.forEach(p.Wi,g=>f.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>B.forEach(p.Gi,g=>f.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!qs(d))throw d;te("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const p=d.targetId;if(!d.fromCache){const g=f.us.get(p),S=g.snapshotVersion,R=g.withLastLimboFreeSnapshotVersion(S);f.us=f.us.insert(p,R)}}}(r.localStore,i))}async function XC(t,e){const n=pe(t);if(!n.currentUser.isEqual(e)){te("SyncEngine","User change. New user:",e.toKey());const r=await p_(n.localStore,e);n.currentUser=e,function(i,o){i.Qa.forEach(l=>{l.forEach(c=>{c.reject(new se(q.CANCELLED,o))})}),i.Qa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await oo(n,r.Ts)}}function JC(t,e){const n=pe(t),r=n.Ba.get(e);if(r&&r.Fa)return Ee().add(r.key);{let s=Ee();const i=n.Oa.get(e);if(!i)return s;for(const o of i){const l=n.xa.get(o);s=s.unionWith(l.view.fa)}return s}}function O_(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=V_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GC.bind(null,e),e.Ma.R_=NC.bind(null,e.eventManager),e.Ma.Wa=OC.bind(null,e.eventManager),e}function YC(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KC.bind(null,e),e}class Ca{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ol(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,n){return null}Ya(e,n){return null}Ha(e){return sC(this.persistence,new nC,e.initialUser,this.serializer)}ja(e){return new m_(qu.ei,this.serializer)}za(e){return new hC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ca.provider={build:()=>new Ca};class ZC extends Ca{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,n){Oe(this.persistence.referenceDelegate instanceof Aa);const r=this.persistence.referenceDelegate.garbageCollector;return new $0(r,e.asyncQueue,n)}ja(e){const n=this.cacheSizeBytes!==void 0?Ut.withCacheSize(this.cacheSizeBytes):Ut.DEFAULT;return new m_(r=>Aa.ei(r,n),this.serializer)}}class Yc{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>fm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=XC.bind(null,this.syncEngine),await VC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new kC}()}createDatastore(e){const n=ol(e.databaseInfo.databaseId),r=function(i){return new pC(i)}(e.databaseInfo);return function(i,o,l,c){return new yC(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new vC(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>fm(this.syncEngine,n,0),function(){return am.p()?new am:new fC}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,f){const d=new BC(s,i,o,l,c,u);return f&&(d.$a=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=pe(s);te("RemoteStore","RemoteStore shutting down."),i.k_.add(5),await io(i),i.Q_.shutdown(),i.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Yc.provider={build:()=>new Yc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Hn("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Pt.UNAUTHENTICATED,this.clientId=Mg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{te("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(te("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Xu(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ic(t,e){t.asyncQueue.verifyOperationInProgress(),te("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await p_(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function mm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await tS(t);te("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>lm(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>lm(e.remoteStore,s)),t._onlineComponents=e}async function tS(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te("FirestoreClient","Using user provided OfflineComponentProvider");try{await ic(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===q.FAILED_PRECONDITION||s.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ds("Error using user provided cache. Falling back to memory cache: "+n),await ic(t,new Ca)}}else te("FirestoreClient","Using default OfflineComponentProvider"),await ic(t,new ZC(void 0));return t._offlineComponents}async function L_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te("FirestoreClient","Using user provided OnlineComponentProvider"),await mm(t,t._uninitializedComponentsProvider._online)):(te("FirestoreClient","Using default OnlineComponentProvider"),await mm(t,new Yc))),t._onlineComponents}function nS(t){return L_(t).then(e=>e.syncEngine)}async function F_(t){const e=await L_(t),n=e.eventManager;return n.onListen=UC.bind(null,e.syncEngine),n.onUnlisten=qC.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$C.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=HC.bind(null,e.syncEngine),n}function rS(t,e,n={}){const r=new jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new M_({next:p=>{f.eu(),o.enqueueAndForget(()=>C_(i,d));const g=p.docs.has(l);!g&&p.fromCache?u.reject(new se(q.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?u.reject(new se(q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),d=new S_(Mu(l.path),f,{includeMetadataChanges:!0,ua:!0});return I_(i,d)}(await F_(t),t.asyncQueue,e,n,r)),r.promise}function sS(t,e,n={}){const r=new jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const f=new M_({next:p=>{f.eu(),o.enqueueAndForget(()=>C_(i,d)),p.fromCache&&c.source==="server"?u.reject(new se(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),d=new S_(l,f,{includeMetadataChanges:!0,ua:!0});return I_(i,d)}(await F_(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U_(t,e,n){if(!n)throw new se(q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iS(t,e,n,r){if(e===!0&&r===!0)throw new se(q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function gm(t){if(!ae.isDocumentKey(t))throw new se(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _m(t){if(ae.isDocumentKey(t))throw new se(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Zu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":fe()}function gn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Zu(t);throw new se(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new se(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new se(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=B_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new se(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new se(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new se(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cl{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ym({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ym(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new gI;switch(r.type){case"firstParty":return new vI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=pm.get(n);r&&(te("ComponentProvider","Removing Datastore"),pm.delete(n),r.terminate())}(this),Promise.resolve()}}function oS(t,e,n,r={}){var s;const i=(t=gn(t,cl))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Ds("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Pt.MOCK_USER;else{l=JT(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new se(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Pt(u)}t._authCredentials=new _I(new Og(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ul(this.firestore,e,this._query)}}class jt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jt(this.firestore,e,this._key)}}class ur extends ul{constructor(e,n,r){super(e,n,Mu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new ae(e))}withConverter(e){return new ur(this.firestore,e,this._path)}}function Sa(t,e,...n){if(t=dr(t),U_("collection","path",e),t instanceof cl){const r=Ke.fromString(e,...n);return _m(r),new ur(t,null,r)}{if(!(t instanceof jt||t instanceof ur))throw new se(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ke.fromString(e,...n));return _m(r),new ur(t.firestore,null,r)}}function Yi(t,e,...n){if(t=dr(t),arguments.length===1&&(e=Mg.newId()),U_("doc","path",e),t instanceof cl){const r=Ke.fromString(e,...n);return gm(r),new jt(t,null,new ae(r))}{if(!(t instanceof jt||t instanceof ur))throw new se(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ke.fromString(e,...n));return gm(r),new jt(t.firestore,t instanceof ur?t.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new __(this,"async_queue_retry"),this.fu=()=>{const r=sc();r&&te("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;const n=sc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const n=sc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const n=new jn;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!qs(e))throw e;te("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const n=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Hn("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Ru=!1,r))));return this.gu=n,n}enqueueAfterDelay(e,n,r){this.pu(),this.mu.indexOf(e)>-1&&(n=0);const s=Qu.createAndSchedule(this,e,n,r,i=>this.Su(i));return this.du.push(s),s}pu(){this.Au&&fe()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const n of this.du)if(n.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.du)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const n=this.du.indexOf(e);this.du.splice(n,1)}}class Kr extends cl{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new wm,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new wm(e),this._firestoreClient=void 0,await e}}}function aS(t,e){const n=typeof t=="object"?t:oI(),r=typeof t=="string"?t:"(default)",s=nI(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=QT("firestore");i&&oS(s,...i)}return s}function eh(t){if(t._terminated)throw new se(q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||lS(t),t._firestoreClient}function lS(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,f){return new OI(l,c,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,B_(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new eS(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fs(Et.fromBase64String(e))}catch(n){throw new se(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Fs(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new se(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new se(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new se(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS=/^__.*__$/;class uS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Tr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ro(e,this.data,n,this.fieldTransforms)}}class $_{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Tr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function j_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe()}}class sh{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Fu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new sh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.xu({path:r,Nu:!1});return s.Lu(e),s}Bu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.xu({path:r,Nu:!1});return s.Fu(),s}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Ra(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(j_(this.Mu)&&cS.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class hS{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ol(e)}$u(e,n,r,s=!1){return new sh({Mu:e,methodName:n,Ku:r,path:vt.emptyPath(),Nu:!1,Qu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ih(t){const e=t._freezeSettings(),n=ol(t._databaseId);return new hS(t._databaseId,!!e.ignoreUndefinedProperties,n)}function q_(t,e,n,r,s,i={}){const o=t.$u(i.merge||i.mergeFields?2:0,e,n,s);oh("Data must be an object, but it was:",o,r);const l=H_(r,o);let c,u;if(i.merge)c=new Jt(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const d of i.mergeFields){const p=Zc(e,d,n);if(!o.contains(p))throw new se(q.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);G_(f,p)||f.push(p)}c=new Jt(f),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new uS(new $t(l),c,u)}class fl extends th{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fl}}function fS(t,e,n,r){const s=t.$u(1,e,n);oh("Data must be an object, but it was:",s,r);const i=[],o=$t.empty();br(r,(c,u)=>{const f=ah(e,c,n);u=dr(u);const d=s.Bu(f);if(u instanceof fl)i.push(f);else{const p=dl(u,d);p!=null&&(i.push(f),o.set(f,p))}});const l=new Jt(i);return new $_(o,l,s.fieldTransforms)}function dS(t,e,n,r,s,i){const o=t.$u(1,e,n),l=[Zc(e,r,n)],c=[s];if(i.length%2!=0)throw new se(q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(Zc(e,i[p])),c.push(i[p+1]);const u=[],f=$t.empty();for(let p=l.length-1;p>=0;--p)if(!G_(u,l[p])){const g=l[p];let S=c[p];S=dr(S);const R=o.Bu(g);if(S instanceof fl)u.push(g);else{const x=dl(S,R);x!=null&&(u.push(g),f.set(g,x))}}const d=new Jt(u);return new $_(f,d,o.fieldTransforms)}function dl(t,e){if(z_(t=dr(t)))return oh("Unsupported field value:",e,t),H_(t,e);if(t instanceof th)return function(r,s){if(!j_(s.Mu))throw s.qu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.qu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=dl(l,s.ku(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=dr(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return s0(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=at.fromDate(r);return{timestampValue:Ta(s.serializer,i)}}if(r instanceof at){const i=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ta(s.serializer,i)}}if(r instanceof nh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fs)return{bytesValue:a_(s.serializer,r._byteString)};if(r instanceof jt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$u(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof rh)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.qu("VectorValues must only contain numeric values.");return Lu(l.serializer,c)})}}}}}}(r,s);throw s.qu(`Unsupported field value: ${Zu(r)}`)}(t,e)}function H_(t,e){const n={};return Lg(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):br(t,(r,s)=>{const i=dl(s,e.Ou(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function z_(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof nh||t instanceof Fs||t instanceof jt||t instanceof th||t instanceof rh)}function oh(t,e,n){if(!z_(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Zu(n);throw r==="an object"?e.qu(t+" a custom object"):e.qu(t+" "+r)}}function Zc(t,e,n){if((e=dr(e))instanceof hl)return e._internalPath;if(typeof e=="string")return ah(t,e);throw Ra("Field path arguments must be of type string or ",t,!1,void 0,n)}const mS=new RegExp("[~\\*/\\[\\]]");function ah(t,e,n){if(e.search(mS)>=0)throw Ra(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new hl(...e.split("."))._internalPath}catch{throw Ra(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ra(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new se(q.INVALID_ARGUMENT,l+t+c)}function G_(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(K_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class pS extends W_{data(){return super.data()}}function K_(t,e){return typeof e=="string"?ah(t,e):e instanceof hl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new se(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _S{convertValue(e,n="none"){switch(_r(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw fe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return br(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ye(o.doubleValue));return new rh(i)}convertGeoPoint(e){return new nh(Ye(e.latitude),Ye(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Za(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Wi(e));default:return null}}convertTimestamp(e){const n=pr(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ke.fromString(e);Oe(d_(r));const s=new Ki(r.get(1),r.get(3)),i=new ae(r.popFirst(5));return s.isEqual(n)||Hn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class X_ extends W_{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Zo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(K_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Zo extends X_{data(e={}){return super.data(e)}}class yS{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new pi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Zo(this._firestore,this._userDataWriter,r.key,r,new pi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new se(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Zo(s._firestore,s._userDataWriter,l.doc.key,l.doc,new pi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Zo(s._firestore,s._userDataWriter,l.doc.key,l.doc,new pi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,f=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:wS(l.type),doc:c,oldIndex:u,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function wS(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(t){t=gn(t,jt);const e=gn(t.firestore,Kr);return rS(eh(e),t._key).then(n=>AS(e,t,n))}class J_ extends _S{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,n)}}function Y_(t){t=gn(t,ul);const e=gn(t.firestore,Kr),n=eh(e),r=new J_(e);return gS(t._query),sS(n,t._query).then(s=>new yS(e,r,t,s))}function ES(t,e,n){t=gn(t,jt);const r=gn(t.firestore,Kr),s=Q_(t.converter,e);return ml(r,[q_(ih(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,rn.none())])}function Z_(t,e,n,...r){t=gn(t,jt);const s=gn(t.firestore,Kr),i=ih(s);let o;return o=typeof(e=dr(e))=="string"||e instanceof hl?dS(i,"updateDoc",t._key,e,n,r):fS(i,"updateDoc",t._key,e),ml(s,[o.toMutation(t._key,rn.exists(!0))])}function bS(t){return ml(gn(t.firestore,Kr),[new Fu(t._key,rn.none())])}function TS(t,e){const n=gn(t.firestore,Kr),r=Yi(t),s=Q_(t.converter,e);return ml(n,[q_(ih(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,rn.exists(!1))]).then(()=>r)}function ml(t,e){return function(r,s){const i=new jn;return r.asyncQueue.enqueueAndForget(async()=>zC(await nS(r),s,i)),i.promise}(eh(t),e)}function AS(t,e,n){const r=n.docs.get(e._key),s=new J_(t);return new X_(t,s,e._key,r,new pi(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){$s=s})(iI),_a(new Hi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Kr(new yI(r.getProvider("auth-internal")),new bI(r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new se(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ki(u.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),bs(Md,"4.7.5",e),bs(Md,"4.7.5","esm2017")})();var IS="firebase",CS="11.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bs(IS,CS,"app");const SS={apiKey:"AIzaSyDyQndYikd9OJZWKtXoor0DYbTQJ_O8X90",authDomain:"celebdle-5f962.firebaseapp.com",projectId:"celebdle-5f962",storageBucket:"celebdle-5f962.firebasestorage.app",messagingSenderId:"538977318861",appId:"1:538977318861:web:7ae0d3c4791f856d1af68"},RS=Cg(SS),fs=aS(RS);async function PS(){const e=(await Y_(Sa(fs,"celebrities"))).docs.map(s=>({id:s.id,...s.data()}));if(e.length===0)throw new Error("No hay celebridades en la colección 'celebrities'.");const n=Math.floor(Math.random()*e.length);return e[n]}const eu="RFC3986",tu={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},xS="RFC1738",VS=Array.isArray,En=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),oc=1024,DS=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=oc){const c=i.length>=oc?i.slice(l,l+oc):i,u=[];for(let f=0;f<c.length;++f){let d=c.charCodeAt(f);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===xS&&(d===40||d===41)){u[u.length]=c.charAt(f);continue}if(d<128){u[u.length]=En[d];continue}if(d<2048){u[u.length]=En[192|d>>6]+En[128|d&63];continue}if(d<55296||d>=57344){u[u.length]=En[224|d>>12]+En[128|d>>6&63]+En[128|d&63];continue}f+=1,d=65536+((d&1023)<<10|c.charCodeAt(f)&1023),u[u.length]=En[240|d>>18]+En[128|d>>12&63]+En[128|d>>6&63]+En[128|d&63]}o+=u.join("")}return o};function kS(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function vm(t,e){if(VS(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const NS=Object.prototype.hasOwnProperty,ey={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},An=Array.isArray,OS=Array.prototype.push,ty=function(t,e){OS.apply(t,An(e)?e:[e])},MS=Date.prototype.toISOString,st={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:DS,encodeValuesOnly:!1,format:eu,formatter:tu[eu],indices:!1,serializeDate(t){return MS.call(t)},skipNulls:!1,strictNullHandling:!1};function LS(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const ac={};function ny(t,e,n,r,s,i,o,l,c,u,f,d,p,g,S,R,x,j){let D=t,O=j,N=0,ne=!1;for(;(O=O.get(ac))!==void 0&&!ne;){const b=O.get(t);if(N+=1,typeof b<"u"){if(b===N)throw new RangeError("Cyclic object value");ne=!0}typeof O.get(ac)>"u"&&(N=0)}if(typeof u=="function"?D=u(e,D):D instanceof Date?D=p==null?void 0:p(D):n==="comma"&&An(D)&&(D=vm(D,function(b){return b instanceof Date?p==null?void 0:p(b):b})),D===null){if(i)return c&&!R?c(e,st.encoder,x,"key",g):e;D=""}if(LS(D)||kS(D)){if(c){const b=R?e:c(e,st.encoder,x,"key",g);return[(S==null?void 0:S(b))+"="+(S==null?void 0:S(c(D,st.encoder,x,"value",g)))]}return[(S==null?void 0:S(e))+"="+(S==null?void 0:S(String(D)))]}const Q=[];if(typeof D>"u")return Q;let T;if(n==="comma"&&An(D))R&&c&&(D=vm(D,c)),T=[{value:D.length>0?D.join(",")||null:void 0}];else if(An(u))T=u;else{const b=Object.keys(D);T=f?b.sort(f):b}const w=l?String(e).replace(/\./g,"%2E"):String(e),y=r&&An(D)&&D.length===1?w+"[]":w;if(s&&An(D)&&D.length===0)return y+"[]";for(let b=0;b<T.length;++b){const A=T[b],I=typeof A=="object"&&typeof A.value<"u"?A.value:D[A];if(o&&I===null)continue;const v=d&&l?A.replace(/\./g,"%2E"):A,Se=An(D)?typeof n=="function"?n(y,v):y:y+(d?"."+v:"["+v+"]");j.set(t,N);const We=new WeakMap;We.set(ac,j),ty(Q,ny(I,Se,n,r,s,i,o,l,n==="comma"&&R&&An(D)?null:c,u,f,d,p,g,S,R,x,We))}return Q}function FS(t=st){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||st.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=eu;if(typeof t.format<"u"){if(!NS.call(tu,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=tu[n];let s=st.filter;(typeof t.filter=="function"||An(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in ey?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=st.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:st.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:st.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:st.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:st.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?st.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:st.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:st.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:st.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:st.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:st.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:st.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:st.strictNullHandling}}function BS(t,e={}){let n=t;const r=FS(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):An(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const l=ey[r.arrayFormat],c=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let p=0;p<s.length;++p){const g=s[p];r.skipNulls&&n[g]===null||ty(o,ny(n[g],g,l,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const f=o.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),f.length>0?d+f:""}const us="4.78.1";let Em=!1,ki,ry,sy,nu,iy,oy,ay,ly,cy;function US(t,e={auto:!1}){if(Em)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(ki)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${ki}'\``);Em=e.auto,ki=t.kind,ry=t.fetch,sy=t.FormData,nu=t.File,iy=t.ReadableStream,oy=t.getMultipartRequestOptions,ay=t.getDefaultAgent,ly=t.fileFromPath,cy=t.isFsReadStream}class $S{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function jS({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new $S(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}ki||US(jS(),{auto:!0});class ve extends Error{}class bt extends ve{constructor(e,n,r,s){super(`${bt.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new pl({message:r,cause:su(n)});const i=n==null?void 0:n.error;return e===400?new uy(e,i,r,s):e===401?new hy(e,i,r,s):e===403?new fy(e,i,r,s):e===404?new dy(e,i,r,s):e===409?new my(e,i,r,s):e===422?new py(e,i,r,s):e===429?new gy(e,i,r,s):e>=500?new _y(e,i,r,s):new bt(e,i,r,s)}}class un extends bt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class pl extends bt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class lh extends pl{constructor({message:e}={}){super({message:e??"Request timed out."})}}class uy extends bt{}class hy extends bt{}class fy extends bt{}class dy extends bt{}class my extends bt{}class py extends bt{}class gy extends bt{}class _y extends bt{}class yy extends ve{constructor(){super("Could not parse response content as the length limit was reached")}}class wy extends ve{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class zr{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=zr.NEWLINE_CHARS.has(n[n.length-1]||"");let s=n.split(zr.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ve(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ve(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new ve("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}zr.NEWLINE_CHARS=new Set([`
`,"\r"]);zr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Sn{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of qS(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new bt(void 0,l.error,void 0,void 0);yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new bt(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new Sn(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new zr,l=vy(e);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new Sn(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new Sn(()=>s(e),this.controller),new Sn(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new iy({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*qS(t,e){if(!t.body)throw e.abort(),new ve("Attempted to iterate over a response with no body");const n=new GS,r=new zr,s=vy(t.body);for await(const i of HS(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*HS(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=zS(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function zS(t){for(let r=0;r<t.length-2;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}class GS{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=WS(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function WS(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function vy(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Ey=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",by=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&gl(t),gl=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",KS=t=>by(t)||Ey(t)||cy(t);async function Ty(t,e,n){var s;if(t=await t,by(t))return t;if(Ey(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=gl(i)?[await i.arrayBuffer()]:[i];return new nu(o,e,n)}const r=await QS(t);if(e||(e=JS(t)??"unknown_file"),!(n!=null&&n.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new nu(r,e,n)}async function QS(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(gl(t))e.push(await t.arrayBuffer());else if(YS(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${XS(t)}`);return e}function XS(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function JS(t){var e;return lc(t.name)||lc(t.filename)||((e=lc(t.path))==null?void 0:e.split(/[\\/]/).pop())}const lc=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},YS=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",bm=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Bs=async t=>{const e=await ZS(t.body);return oy(e,t)},ZS=async t=>{const e=new sy;return await Promise.all(Object.entries(t||{}).map(([n,r])=>ru(e,n,r))),e},ru=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(KS(n)){const r=await Ty(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>ru(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>ru(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var As={},eR=function(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n},tR=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Fo;async function Ay(t){const{response:e}=t;if(t.options.stream)return Is("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Sn.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.includes("application/vnd.api+json"))){const i=await e.json();return Is("response",e.status,e.url,e.headers,i),Iy(i,e)}const s=await e.text();return Is("response",e.status,e.url,e.headers,s),s}function Iy(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class _l extends Promise{constructor(e,n=Ay){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new _l(this.responsePromise,async n=>Iy(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class nR{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=cc("maxRetries",n),this.timeout=cc("timeout",r),this.httpAgent=s,this.fetch=i??ry}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...lR(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${fR()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&gl(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var R;const{method:r,path:s,query:i,headers:o={}}=e,l=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:bm(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,c=this.calculateContentLength(l),u=this.buildURL(s,i);"timeout"in e&&cc("timeout",e.timeout);const f=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??ay(u),p=f+1e3;typeof((R=d==null?void 0:d.options)==null?void 0:R.timeout)=="number"&&p>(d.options.timeout??0)&&(d.options.timeout=p),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const g=this.buildHeaders({options:e,headers:o,contentLength:c,retryCount:n});return{req:{method:r,...l&&{body:l},headers:g,...d&&{agent:d},signal:e.signal??null},url:u,timeout:f}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return Cm(i,o),Cm(i,n),bm(e.body)&&ki!=="node"&&delete i["content-type"],Sm(o,"x-stainless-retry-count")===void 0&&Sm(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return bt.generate(e,n,r,s)}request(e,n=null){return new _l(this.makeRequest(e,n))}async makeRequest(e,n){var d,p;const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:o,options:r}),Is("request",o,r,i.headers),(d=r.signal)!=null&&d.aborted)throw new un;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(su);if(u instanceof Error){if((p=r.signal)!=null&&p.aborted)throw new un;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new lh:new pl({cause:u})}const f=sR(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const D=`retrying, ${n} attempts remaining`;return Is(`response (error; ${D})`,u.status,o,f),this.retryRequest(r,n,f)}const g=await u.text().catch(D=>su(D).message),S=cR(g),R=S?void 0:g;throw Is(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,f,R),this.makeStatusError(u.status,S,R,f)}return{response:u,options:r,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new rR(this,r,e)}buildURL(e,n){const r=hR(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Sy(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new ve(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(l)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await ao(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${us}`}}class Cy{constructor(e,n,r,s){Fo.set(this,void 0),eR(this,Fo,e),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new ve("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await tR(this,Fo,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Fo=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class rR extends _l{constructor(e,n,r){super(n,async s=>new r(e,s.response,await Ay(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const sR=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),iR={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},qt=t=>typeof t=="object"&&t!==null&&!Sy(t)&&Object.keys(t).every(e=>Ry(iR,e)),oR=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":Am(Deno.build.os),"X-Stainless-Arch":Tm(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":Am(process.platform),"X-Stainless-Arch":Tm(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=aR();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function aR(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const Tm=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Am=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Im;const lR=()=>Im??(Im=oR()),cR=t=>{try{return JSON.parse(t)}catch{return}},uR=/^[a-z][a-z0-9+.-]*:/i,hR=t=>uR.test(t),ao=t=>new Promise(e=>setTimeout(e,t)),cc=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ve(`${t} must be an integer`);if(e<0)throw new ve(`${t} must be a positive integer`);return e},su=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},Bo=t=>{var e,n,r,s;if(typeof process<"u")return((e=As==null?void 0:As[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:s.trim()};function Sy(t){if(!t)return!0;for(const e in t)return!1;return!0}function Ry(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Cm(t,e){for(const n in e){if(!Ry(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}function Is(t,...e){typeof process<"u"&&(As==null?void 0:As.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const fR=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),dR=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",mR=t=>typeof(t==null?void 0:t.get)=="function",Sm=(t,e)=>{var r;const n=e.toLowerCase();if(mR(t)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[e,n,e.toUpperCase(),s]){const o=t.get(i);if(o)return o}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===n)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};function uc(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class pR extends Cy{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class yn extends Cy{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Ve{constructor(e){this._client=e}}let Py=class extends Ve{create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}},ch=class extends Ve{constructor(){super(...arguments),this.completions=new Py(this._client)}};ch.Completions=Py;class xy extends Ve{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class Vy extends Ve{create(e,n){return this._client.post("/audio/transcriptions",Bs({body:e,...n}))}}class Dy extends Ve{create(e,n){return this._client.post("/audio/translations",Bs({body:e,...n}))}}class lo extends Ve{constructor(){super(...arguments),this.transcriptions=new Vy(this._client),this.translations=new Dy(this._client),this.speech=new xy(this._client)}}lo.Transcriptions=Vy;lo.Translations=Dy;lo.Speech=xy;class uh extends Ve{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return qt(e)?this.list({},e):this._client.getAPIList("/batches",hh,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class hh extends yn{}uh.BatchesPage=hh;class fh extends Ve{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return qt(e)?this.list({},e):this._client.getAPIList("/assistants",dh,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class dh extends yn{}fh.AssistantsPage=dh;function Rm(t){return typeof t.parse=="function"}const Cs=t=>(t==null?void 0:t.role)==="assistant",ky=t=>(t==null?void 0:t.role)==="function",Ny=t=>(t==null?void 0:t.role)==="tool";var ln=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Qe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},iu,ea,ta,gi,_i,na,yi,Fn,wi,Pa,xa,hs,Oy;class My{constructor(){iu.add(this),this.controller=new AbortController,ea.set(this,void 0),ta.set(this,()=>{}),gi.set(this,()=>{}),_i.set(this,void 0),na.set(this,()=>{}),yi.set(this,()=>{}),Fn.set(this,{}),wi.set(this,!1),Pa.set(this,!1),xa.set(this,!1),hs.set(this,!1),ln(this,ea,new Promise((e,n)=>{ln(this,ta,e,"f"),ln(this,gi,n,"f")}),"f"),ln(this,_i,new Promise((e,n)=>{ln(this,na,e,"f"),ln(this,yi,n,"f")}),"f"),Qe(this,ea,"f").catch(()=>{}),Qe(this,_i,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},Qe(this,iu,"m",Oy).bind(this))},0)}_connected(){this.ended||(Qe(this,ta,"f").call(this),this._emit("connect"))}get ended(){return Qe(this,wi,"f")}get errored(){return Qe(this,Pa,"f")}get aborted(){return Qe(this,xa,"f")}abort(){this.controller.abort()}on(e,n){return(Qe(this,Fn,"f")[e]||(Qe(this,Fn,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=Qe(this,Fn,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(Qe(this,Fn,"f")[e]||(Qe(this,Fn,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{ln(this,hs,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){ln(this,hs,!0,"f"),await Qe(this,_i,"f")}_emit(e,...n){if(Qe(this,wi,"f"))return;e==="end"&&(ln(this,wi,!0,"f"),Qe(this,na,"f").call(this));const r=Qe(this,Fn,"f")[e];if(r&&(Qe(this,Fn,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!Qe(this,hs,"f")&&!(r!=null&&r.length)&&Promise.reject(s),Qe(this,gi,"f").call(this,s),Qe(this,yi,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!Qe(this,hs,"f")&&!(r!=null&&r.length)&&Promise.reject(s),Qe(this,gi,"f").call(this,s),Qe(this,yi,"f").call(this,s),this._emit("end")}}_emitFinal(){}}ea=new WeakMap,ta=new WeakMap,gi=new WeakMap,_i=new WeakMap,na=new WeakMap,yi=new WeakMap,Fn=new WeakMap,wi=new WeakMap,Pa=new WeakMap,xa=new WeakMap,hs=new WeakMap,iu=new WeakSet,Oy=function(e){if(ln(this,Pa,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new un),e instanceof un)return ln(this,xa,!0,"f"),this._emit("abort",e);if(e instanceof ve)return this._emit("error",e);if(e instanceof Error){const n=new ve(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ve(String(e)))};function Ly(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function co(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function gR(t,e){return!e||!Fy(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:mh(t,e)}function mh(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new yy;if(r.finish_reason==="content_filter")throw new wy;return{...r,message:{...r.message,tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>yR(e,i)))??[],parsed:r.message.content&&!r.message.refusal?_R(e,r.message.content):null}}});return{...t,choices:n}}function _R(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function yR(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:co(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function wR(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return co(n)||(n==null?void 0:n.function.strict)||!1}function Fy(t){var e;return Ly(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>co(n)||n.type==="function"&&n.function.strict===!0))??!1}function vR(t){for(const e of t??[]){if(e.type!=="function")throw new ve(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new ve(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Bt=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Rt,ou,Va,au,lu,cu,By,uu;const Pm=10;class Uy extends My{constructor(){super(...arguments),Rt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(ky(e)||Ny(e))&&e.content)this._emit("functionCallResult",e.content);else if(Cs(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Cs(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new ve("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Bt(this,Rt,"m",ou).call(this)}async finalMessage(){return await this.done(),Bt(this,Rt,"m",Va).call(this)}async finalFunctionCall(){return await this.done(),Bt(this,Rt,"m",au).call(this)}async finalFunctionCallResult(){return await this.done(),Bt(this,Rt,"m",lu).call(this)}async totalUsage(){return await this.done(),Bt(this,Rt,"m",cu).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=Bt(this,Rt,"m",Va).call(this);n&&this._emit("finalMessage",n);const r=Bt(this,Rt,"m",ou).call(this);r&&this._emit("finalContent",r);const s=Bt(this,Rt,"m",au).call(this);s&&this._emit("finalFunctionCall",s);const i=Bt(this,Rt,"m",lu).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",Bt(this,Rt,"m",cu).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Bt(this,Rt,"m",By).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(mh(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var p;const s="function",{function_call:i="auto",stream:o,...l}=n,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=Pm}=r||{},f={};for(const g of n.functions)f[g.name||g.function.name]=g;const d=n.functions.map(g=>({name:g.name||g.function.name,parameters:g.parameters,description:g.description}));for(const g of n.messages)this._addMessage(g,!1);for(let g=0;g<u;++g){const R=(p=(await this._createChatCompletion(e,{...l,function_call:i,functions:d,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!R)throw new ve("missing message in ChatCompletion response");if(!R.function_call)return;const{name:x,arguments:j}=R.function_call,D=f[x];if(D){if(c&&c!==x){const Q=`Invalid function_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:x,content:Q});continue}}else{const Q=`Invalid function_call: ${JSON.stringify(x)}. Available options are: ${d.map(T=>JSON.stringify(T.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:x,content:Q});continue}let O;try{O=Rm(D)?await D.parse(j):j}catch(Q){this._addMessage({role:s,name:x,content:Q instanceof Error?Q.message:String(Q)});continue}const N=await D.function(O,this),ne=Bt(this,Rt,"m",uu).call(this,N);if(this._addMessage({role:s,name:x,content:ne}),c)return}}async _runTools(e,n,r){var g,S,R;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&((g=i==null?void 0:i.function)==null?void 0:g.name),{maxChatCompletions:u=Pm}=r||{},f=n.tools.map(x=>{if(co(x)){if(!x.$callback)throw new ve("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:x.$callback,name:x.function.name,description:x.function.description||"",parameters:x.function.parameters,parse:x.$parseRaw,strict:!0}}}return x}),d={};for(const x of f)x.type==="function"&&(d[x.function.name||x.function.function.name]=x.function);const p="tools"in n?f.map(x=>x.type==="function"?{type:"function",function:{name:x.function.name||x.function.function.name,parameters:x.function.parameters,description:x.function.description,strict:x.function.strict}}:x):void 0;for(const x of n.messages)this._addMessage(x,!1);for(let x=0;x<u;++x){const D=(S=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:p,messages:[...this.messages]},r)).choices[0])==null?void 0:S.message;if(!D)throw new ve("missing message in ChatCompletion response");if(!((R=D.tool_calls)!=null&&R.length))return;for(const O of D.tool_calls){if(O.type!=="function")continue;const N=O.id,{name:ne,arguments:Q}=O.function,T=d[ne];if(T){if(c&&c!==ne){const A=`Invalid tool_call: ${JSON.stringify(ne)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:N,content:A});continue}}else{const A=`Invalid tool_call: ${JSON.stringify(ne)}. Available options are: ${Object.keys(d).map(I=>JSON.stringify(I)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:N,content:A});continue}let w;try{w=Rm(T)?await T.parse(Q):Q}catch(A){const I=A instanceof Error?A.message:String(A);this._addMessage({role:s,tool_call_id:N,content:I});continue}const y=await T.function(w,this),b=Bt(this,Rt,"m",uu).call(this,y);if(this._addMessage({role:s,tool_call_id:N,content:b}),c)return}}}}Rt=new WeakSet,ou=function(){return Bt(this,Rt,"m",Va).call(this).content??null},Va=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Cs(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new ve("stream ended without producing a ChatCompletionMessage with role=assistant")},au=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Cs(s)&&(s!=null&&s.function_call))return s.function_call;if(Cs(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},lu=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(ky(n)&&n.content!=null||Ny(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},cu=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},By=function(e){if(e.n!=null&&e.n>1)throw new ve("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},uu=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Zi extends Uy{static runFunctions(e,n,r){const s=new Zi,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Zi,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),Cs(e)&&e.content&&this._emit("content",e.content)}}const $y=1,jy=2,qy=4,Hy=8,zy=16,Gy=32,Wy=64,Ky=128,Qy=256,Xy=Ky|Qy,Jy=zy|Gy|Xy|Wy,Yy=$y|jy|Jy,Zy=qy|Hy,ER=Yy|Zy,ut={STR:$y,NUM:jy,ARR:qy,OBJ:Hy,NULL:zy,BOOL:Gy,NAN:Wy,INFINITY:Ky,MINUS_INFINITY:Qy,INF:Xy,SPECIAL:Jy,ATOM:Yy,COLLECTION:Zy,ALL:ER};class bR extends Error{}class TR extends Error{}function AR(t,e=ut.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return IR(t.trim(),e)}const IR=(t,e)=>{const n=t.length;let r=0;const s=p=>{throw new bR(`${p} at position ${r}`)},i=p=>{throw new TR(`${p} at position ${r}`)},o=()=>(d(),r>=n&&s("Unexpected end of input"),t[r]==='"'?l():t[r]==="{"?c():t[r]==="["?u():t.substring(r,r+4)==="null"||ut.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||ut.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||ut.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||ut.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||ut.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||ut.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):f()),l=()=>{const p=r;let g=!1;for(r++;r<n&&(t[r]!=='"'||g&&t[r-1]==="\\");)g=t[r]==="\\"?!g:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(p,++r-Number(g)))}catch(S){i(String(S))}else if(ut.STR&e)try{return JSON.parse(t.substring(p,r-Number(g))+'"')}catch{return JSON.parse(t.substring(p,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,d();const p={};try{for(;t[r]!=="}";){if(d(),r>=n&&ut.OBJ&e)return p;const g=l();d(),r++;try{const S=o();Object.defineProperty(p,g,{value:S,writable:!0,enumerable:!0,configurable:!0})}catch(S){if(ut.OBJ&e)return p;throw S}d(),t[r]===","&&r++}}catch{if(ut.OBJ&e)return p;s("Expected '}' at end of object")}return r++,p},u=()=>{r++;const p=[];try{for(;t[r]!=="]";)p.push(o()),d(),t[r]===","&&r++}catch{if(ut.ARR&e)return p;s("Expected ']' at end of array")}return r++,p},f=()=>{if(r===0){t==="-"&&ut.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(g){if(ut.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(g))}}const p=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(ut.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(p,r))}catch{t.substring(p,r)==="-"&&ut.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(p,t.lastIndexOf("e")))}catch(S){i(String(S))}}},d=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},xm=t=>AR(t,ut.ALL^ut.NUM);var es=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Fe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},rt,Ln,ts,er,hc,Uo,fc,dc,mc,$o,pc,Vm;class eo extends Uy{constructor(e){super(),rt.add(this),Ln.set(this,void 0),ts.set(this,void 0),er.set(this,void 0),es(this,Ln,e,"f"),es(this,ts,[],"f")}get currentChatCompletionSnapshot(){return Fe(this,er,"f")}static fromReadableStream(e){const n=new eo(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new eo(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Fe(this,rt,"m",hc).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)Fe(this,rt,"m",fc).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new un;return this._addChatCompletion(Fe(this,rt,"m",$o).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Fe(this,rt,"m",hc).call(this),this._connected();const s=Sn.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(Fe(this,rt,"m",$o).call(this)),Fe(this,rt,"m",fc).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new un;return this._addChatCompletion(Fe(this,rt,"m",$o).call(this))}[(Ln=new WeakMap,ts=new WeakMap,er=new WeakMap,rt=new WeakSet,hc=function(){this.ended||es(this,er,void 0,"f")},Uo=function(n){let r=Fe(this,ts,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Fe(this,ts,"f")[n.index]=r,r)},fc=function(n){var s,i,o,l,c,u,f,d,p,g,S,R,x,j,D;if(this.ended)return;const r=Fe(this,rt,"m",Vm).call(this,n);this._emit("chunk",n,r);for(const O of n.choices){const N=r.choices[O.index];O.delta.content!=null&&((s=N.message)==null?void 0:s.role)==="assistant"&&((i=N.message)!=null&&i.content)&&(this._emit("content",O.delta.content,N.message.content),this._emit("content.delta",{delta:O.delta.content,snapshot:N.message.content,parsed:N.message.parsed})),O.delta.refusal!=null&&((o=N.message)==null?void 0:o.role)==="assistant"&&((l=N.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:O.delta.refusal,snapshot:N.message.refusal}),((c=O.logprobs)==null?void 0:c.content)!=null&&((u=N.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=O.logprobs)==null?void 0:f.content,snapshot:((d=N.logprobs)==null?void 0:d.content)??[]}),((p=O.logprobs)==null?void 0:p.refusal)!=null&&((g=N.message)==null?void 0:g.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(S=O.logprobs)==null?void 0:S.refusal,snapshot:((R=N.logprobs)==null?void 0:R.refusal)??[]});const ne=Fe(this,rt,"m",Uo).call(this,N);N.finish_reason&&(Fe(this,rt,"m",mc).call(this,N),ne.current_tool_call_index!=null&&Fe(this,rt,"m",dc).call(this,N,ne.current_tool_call_index));for(const Q of O.delta.tool_calls??[])ne.current_tool_call_index!==Q.index&&(Fe(this,rt,"m",mc).call(this,N),ne.current_tool_call_index!=null&&Fe(this,rt,"m",dc).call(this,N,ne.current_tool_call_index)),ne.current_tool_call_index=Q.index;for(const Q of O.delta.tool_calls??[]){const T=(x=N.message.tool_calls)==null?void 0:x[Q.index];T!=null&&T.type&&((T==null?void 0:T.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(j=T.function)==null?void 0:j.name,index:Q.index,arguments:T.function.arguments,parsed_arguments:T.function.parsed_arguments,arguments_delta:((D=Q.function)==null?void 0:D.arguments)??""}):(T==null||T.type,void 0))}}},dc=function(n,r){var o,l,c;if(Fe(this,rt,"m",Uo).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=Fe(this,Ln,"f"))==null?void 0:l.tools)==null?void 0:c.find(f=>f.type==="function"&&f.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:co(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},mc=function(n){var s,i;const r=Fe(this,rt,"m",Uo).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=Fe(this,rt,"m",pc).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},$o=function(){if(this.ended)throw new ve("stream has ended, this shouldn't happen");const n=Fe(this,er,"f");if(!n)throw new ve("request ended without sending any chunks");return es(this,er,void 0,"f"),es(this,ts,[],"f"),CR(n,Fe(this,Ln,"f"))},pc=function(){var r;const n=(r=Fe(this,Ln,"f"))==null?void 0:r.response_format;return Ly(n)?n:null},Vm=function(n){var r,s,i,o;let l=Fe(this,er,"f");const{choices:c,...u}=n;l?Object.assign(l,u):l=es(this,er,{...u,choices:[]},"f");for(const{delta:f,finish_reason:d,index:p,logprobs:g=null,...S}of n.choices){let R=l.choices[p];if(R||(R=l.choices[p]={finish_reason:d,index:p,message:{},logprobs:g,...S}),g)if(!R.logprobs)R.logprobs=Object.assign({},g);else{const{content:Q,refusal:T,...w}=g;Object.assign(R.logprobs,w),Q&&((r=R.logprobs).content??(r.content=[]),R.logprobs.content.push(...Q)),T&&((s=R.logprobs).refusal??(s.refusal=[]),R.logprobs.refusal.push(...T))}if(d&&(R.finish_reason=d,Fe(this,Ln,"f")&&Fy(Fe(this,Ln,"f")))){if(d==="length")throw new yy;if(d==="content_filter")throw new wy}if(Object.assign(R,S),!f)continue;const{content:x,refusal:j,function_call:D,role:O,tool_calls:N,...ne}=f;if(Object.assign(R.message,ne),j&&(R.message.refusal=(R.message.refusal||"")+j),O&&(R.message.role=O),D&&(R.message.function_call?(D.name&&(R.message.function_call.name=D.name),D.arguments&&((i=R.message.function_call).arguments??(i.arguments=""),R.message.function_call.arguments+=D.arguments)):R.message.function_call=D),x&&(R.message.content=(R.message.content||"")+x,!R.message.refusal&&Fe(this,rt,"m",pc).call(this)&&(R.message.parsed=xm(R.message.content))),N){R.message.tool_calls||(R.message.tool_calls=[]);for(const{index:Q,id:T,type:w,function:y,...b}of N){const A=(o=R.message.tool_calls)[Q]??(o[Q]={});Object.assign(A,b),T&&(A.id=T),w&&(A.type=w),y&&(A.function??(A.function={name:y.name??"",arguments:""})),y!=null&&y.name&&(A.function.name=y.name),y!=null&&y.arguments&&(A.function.arguments+=y.arguments,wR(Fe(this,Ln,"f"),A)&&(A.function.parsed_arguments=xm(A.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Sn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function CR(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:r.map(({message:u,finish_reason:f,index:d,logprobs:p,...g})=>{if(!f)throw new ve(`missing finish_reason for choice ${d}`);const{content:S=null,function_call:R,tool_calls:x,...j}=u,D=u.role;if(!D)throw new ve(`missing role for choice ${d}`);if(R){const{arguments:O,name:N}=R;if(O==null)throw new ve(`missing function_call.arguments for choice ${d}`);if(!N)throw new ve(`missing function_call.name for choice ${d}`);return{...g,message:{content:S,function_call:{arguments:O,name:N},role:D,refusal:u.refusal??null},finish_reason:f,index:d,logprobs:p}}return x?{...g,index:d,finish_reason:f,logprobs:p,message:{...j,role:D,content:S,refusal:u.refusal??null,tool_calls:x.map((O,N)=>{const{function:ne,type:Q,id:T,...w}=O,{arguments:y,name:b,...A}=ne||{};if(T==null)throw new ve(`missing choices[${d}].tool_calls[${N}].id
${jo(t)}`);if(Q==null)throw new ve(`missing choices[${d}].tool_calls[${N}].type
${jo(t)}`);if(b==null)throw new ve(`missing choices[${d}].tool_calls[${N}].function.name
${jo(t)}`);if(y==null)throw new ve(`missing choices[${d}].tool_calls[${N}].function.arguments
${jo(t)}`);return{...w,id:T,type:Q,function:{...A,name:b,arguments:y}}})}}:{...g,message:{...j,content:S,role:D,refusal:u.refusal??null},finish_reason:f,index:d,logprobs:p}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return gR(c,e)}function jo(t){return JSON.stringify(t)}class Ss extends eo{static fromReadableStream(e){const n=new Ss(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Ss(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Ss(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let ew=class extends Ve{parse(e,n){return vR(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>mh(r,e))}runFunctions(e,n){return e.stream?Ss.runFunctions(this._client,e,n):Zi.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?Ss.runTools(this._client,e,n):Zi.runTools(this._client,e,n)}stream(e,n){return eo.createChatCompletion(this._client,e,n)}};class tw extends Ve{constructor(){super(...arguments),this.completions=new ew(this._client)}}(function(t){t.Completions=ew})(tw);class nw extends Ve{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class ph extends Ve{constructor(){super(...arguments),this.sessions=new nw(this._client)}}ph.Sessions=nw;var oe=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},zt=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},_t,hu,In,ra,cn,Br,ds,Lr,Da,Wt,sa,ia,Ni,vi,Ei,Dm,km,Nm,Om,Mm,Lm,Fm;class hn extends My{constructor(){super(...arguments),_t.add(this),hu.set(this,[]),In.set(this,{}),ra.set(this,{}),cn.set(this,void 0),Br.set(this,void 0),ds.set(this,void 0),Lr.set(this,void 0),Da.set(this,void 0),Wt.set(this,void 0),sa.set(this,void 0),ia.set(this,void 0),Ni.set(this,void 0)}[(hu=new WeakMap,In=new WeakMap,ra=new WeakMap,cn=new WeakMap,Br=new WeakMap,ds=new WeakMap,Lr=new WeakMap,Da=new WeakMap,Wt=new WeakMap,sa=new WeakMap,ia=new WeakMap,Ni=new WeakMap,_t=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new hn;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Sn.fromReadableStream(e,this.controller);for await(const o of s)oe(this,_t,"m",vi).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new un;return this._addRun(oe(this,_t,"m",Ei).call(this))}toReadableStream(){return new Sn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new hn;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},c=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const f of c)oe(this,_t,"m",vi).call(this,f);if((u=c.controller.signal)!=null&&u.aborted)throw new un;return this._addRun(oe(this,_t,"m",Ei).call(this))}static createThreadAssistantStream(e,n,r){const s=new hn;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new hn;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return oe(this,sa,"f")}currentRun(){return oe(this,ia,"f")}currentMessageSnapshot(){return oe(this,cn,"f")}currentRunStepSnapshot(){return oe(this,Ni,"f")}async finalRunSteps(){return await this.done(),Object.values(oe(this,In,"f"))}async finalMessages(){return await this.done(),Object.values(oe(this,ra,"f"))}async finalRun(){if(await this.done(),!oe(this,Br,"f"))throw Error("Final run was not received.");return oe(this,Br,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)oe(this,_t,"m",vi).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new un;return this._addRun(oe(this,_t,"m",Ei).call(this))}async _createAssistantStream(e,n,r,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)oe(this,_t,"m",vi).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new un;return this._addRun(oe(this,_t,"m",Ei).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(uc(i)&&uc(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!uc(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}vi=function(e){if(!this.ended)switch(zt(this,sa,e,"f"),oe(this,_t,"m",Nm).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":oe(this,_t,"m",Fm).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":oe(this,_t,"m",km).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":oe(this,_t,"m",Dm).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Ei=function(){if(this.ended)throw new ve("stream has ended, this shouldn't happen");if(!oe(this,Br,"f"))throw Error("Final run has not been received");return oe(this,Br,"f")},Dm=function(e){const[n,r]=oe(this,_t,"m",Mm).call(this,e,oe(this,cn,"f"));zt(this,cn,n,"f"),oe(this,ra,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=oe(this,ds,"f")){if(oe(this,Lr,"f"))switch(oe(this,Lr,"f").type){case"text":this._emit("textDone",oe(this,Lr,"f").text,oe(this,cn,"f"));break;case"image_file":this._emit("imageFileDone",oe(this,Lr,"f").image_file,oe(this,cn,"f"));break}zt(this,ds,s.index,"f")}zt(this,Lr,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(oe(this,ds,"f")!==void 0){const s=e.data.content[oe(this,ds,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,oe(this,cn,"f"));break;case"text":this._emit("textDone",s.text,oe(this,cn,"f"));break}}oe(this,cn,"f")&&this._emit("messageDone",e.data),zt(this,cn,void 0,"f")}},km=function(e){const n=oe(this,_t,"m",Om).call(this,e);switch(zt(this,Ni,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==oe(this,Da,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(oe(this,Wt,"f")&&this._emit("toolCallDone",oe(this,Wt,"f")),zt(this,Da,i.index,"f"),zt(this,Wt,n.step_details.tool_calls[i.index],"f"),oe(this,Wt,"f")&&this._emit("toolCallCreated",oe(this,Wt,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":zt(this,Ni,void 0,"f"),e.data.step_details.type=="tool_calls"&&oe(this,Wt,"f")&&(this._emit("toolCallDone",oe(this,Wt,"f")),zt(this,Wt,void 0,"f")),this._emit("runStepDone",e.data,n);break}},Nm=function(e){oe(this,hu,"f").push(e),this._emit("event",e)},Om=function(e){switch(e.event){case"thread.run.step.created":return oe(this,In,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=oe(this,In,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=hn.accumulateDelta(n,r.delta);oe(this,In,"f")[e.data.id]=s}return oe(this,In,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":oe(this,In,"f")[e.data.id]=e.data;break}if(oe(this,In,"f")[e.data.id])return oe(this,In,"f")[e.data.id];throw new Error("No snapshot available")},Mm=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=oe(this,_t,"m",Lm).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Lm=function(e,n){return hn.accumulateDelta(n,e)},Fm=function(e){switch(zt(this,ia,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":zt(this,Br,e.data,"f"),oe(this,Wt,"f")&&(this._emit("toolCallDone",oe(this,Wt,"f")),zt(this,Wt,void 0,"f"));break}};class gh extends Ve{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return qt(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,_h,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class _h extends yn{}gh.MessagesPage=_h;class yh extends Ve{retrieve(e,n,r,s={},i){return qt(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},s){return qt(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,wh,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class wh extends yn{}yh.RunStepsPage=wh;class uo extends Ve{constructor(){super(...arguments),this.steps=new yh(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return qt(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,vh,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return hn.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ao(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return hn.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return hn.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}}class vh extends yn{}uo.RunsPage=vh;uo.Steps=yh;uo.RunStepsPage=wh;class zs extends Ve{constructor(){super(...arguments),this.runs=new uo(this._client),this.messages=new gh(this._client)}create(e={},n){return qt(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return hn.createThreadAssistantStream(e,this._client.beta.threads,n)}}zs.Runs=uo;zs.RunsPage=vh;zs.Messages=gh;zs.MessagesPage=_h;const SR=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Eh=class extends Ve{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,n={},r){return qt(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,yl,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ao(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}};class yl extends yn{}Eh.VectorStoreFilesPage=yl;class rw extends Ve{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return qt(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,yl,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ao(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),u=[...r];async function f(p){for(let g of p){const S=await l.files.create({file:g,purpose:"assistants"},s);u.push(S.id)}}const d=Array(o).fill(c).map(f);return await SR(d),await this.createAndPoll(e,{file_ids:u})}}class Gs extends Ve{constructor(){super(...arguments),this.files=new Eh(this._client),this.fileBatches=new rw(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return qt(e)?this.list({},e):this._client.getAPIList("/vector_stores",bh,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class bh extends yn{}Gs.VectorStoresPage=bh;Gs.Files=Eh;Gs.VectorStoreFilesPage=yl;Gs.FileBatches=rw;class Ar extends Ve{constructor(){super(...arguments),this.realtime=new ph(this._client),this.vectorStores=new Gs(this._client),this.chat=new tw(this._client),this.assistants=new fh(this._client),this.threads=new zs(this._client)}}Ar.Realtime=ph;Ar.VectorStores=Gs;Ar.VectorStoresPage=bh;Ar.Assistants=fh;Ar.AssistantsPage=dh;Ar.Threads=zs;class sw extends Ve{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}class iw extends Ve{create(e,n){return this._client.post("/embeddings",{body:e,...n})}}class Th extends Ve{create(e,n){return this._client.post("/files",Bs({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return qt(e)?this.list({},e):this._client.getAPIList("/files",Ah,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await ao(n),o=await this.retrieve(e),Date.now()-i>r)throw new lh({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}}class Ah extends yn{}Th.FileObjectsPage=Ah;class Ih extends Ve{list(e,n={},r){return qt(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Ch,{query:n,...r})}}class Ch extends yn{}Ih.FineTuningJobCheckpointsPage=Ch;class Ws extends Ve{constructor(){super(...arguments),this.checkpoints=new Ih(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return qt(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Sh,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return qt(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Rh,{query:n,...r})}}class Sh extends yn{}class Rh extends yn{}Ws.FineTuningJobsPage=Sh;Ws.FineTuningJobEventsPage=Rh;Ws.Checkpoints=Ih;Ws.FineTuningJobCheckpointsPage=Ch;class ho extends Ve{constructor(){super(...arguments),this.jobs=new Ws(this._client)}}ho.Jobs=Ws;ho.FineTuningJobsPage=Sh;ho.FineTuningJobEventsPage=Rh;class ow extends Ve{createVariation(e,n){return this._client.post("/images/variations",Bs({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Bs({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class Ph extends Ve{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",xh,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class xh extends pR{}Ph.ModelsPage=xh;class aw extends Ve{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class lw extends Ve{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,Bs({body:n,...r}))}}class Vh extends Ve{constructor(){super(...arguments),this.parts=new lw(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}Vh.Parts=lw;var cw;class Ce extends nR{constructor({baseURL:e=Bo("OPENAI_BASE_URL"),apiKey:n=Bo("OPENAI_API_KEY"),organization:r=Bo("OPENAI_ORG_ID")??null,project:s=Bo("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new ve("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&dR())throw new ve(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new sw(this),this.chat=new ch(this),this.embeddings=new iw(this),this.files=new Th(this),this.images=new ow(this),this.audio=new lo(this),this.moderations=new aw(this),this.models=new Ph(this),this.fineTuning=new ho(this),this.beta=new Ar(this),this.batches=new uh(this),this.uploads=new Vh(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return BS(e,{arrayFormat:"brackets"})}}cw=Ce;Ce.OpenAI=cw;Ce.DEFAULT_TIMEOUT=6e5;Ce.OpenAIError=ve;Ce.APIError=bt;Ce.APIConnectionError=pl;Ce.APIConnectionTimeoutError=lh;Ce.APIUserAbortError=un;Ce.NotFoundError=dy;Ce.ConflictError=my;Ce.RateLimitError=gy;Ce.BadRequestError=uy;Ce.AuthenticationError=hy;Ce.InternalServerError=_y;Ce.PermissionDeniedError=fy;Ce.UnprocessableEntityError=py;Ce.toFile=Ty;Ce.fileFromPath=ly;Ce.Completions=sw;Ce.Chat=ch;Ce.Embeddings=iw;Ce.Files=Th;Ce.FileObjectsPage=Ah;Ce.Images=ow;Ce.Audio=lo;Ce.Moderations=aw;Ce.Models=Ph;Ce.ModelsPage=xh;Ce.FineTuning=ho;Ce.Beta=Ar;Ce.Batches=uh;Ce.BatchesPage=hh;Ce.Uploads=Vh;const RR=new Ce({apiKey:"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",dangerouslyAllowBrowser:!0});async function PR(t,e){var o,l,c,u;const n=[{role:"system",content:e==="es"?"Eres un asistente creativo que describe celebridades sin revelar su identidad directamente.":"You are a creative assistant who describes celebrities without directly revealing their identity."},{role:"user",content:e==="es"?`
            Genera 4 pistas cortas y creativas sobre la celebridad llamada "${t}",
            sin revelar su nombre ni mencionar detalles de su profesión o al menos no de forma literal.
            Deben estar ordenadas de la más difícil (pista 1) a la más fácil (pista 4).
            Cada pista debe ser solo una oración. Todas las pistas deben ser difíciles, casi imposibles de adivinar.
          `:`
            Generate 4 short and creative clues about the celebrity named "${t}",
            without revealing their name or mentioning details about their profession or at least not in a literal way.
            They must be ordered from the hardest (clue 1) to the easiest (clue 4).
            Each clue must be just one sentence. All clues should be challenging, almost impossible to guess.
          `}];return(((u=(c=(l=(o=(await RR.chat.completions.create({model:"gpt-4o-mini",messages:n,max_tokens:150,temperature:.7})).choices)==null?void 0:o[0])==null?void 0:l.message)==null?void 0:c.content)==null?void 0:u.trim())||"").split(`
`).map(f=>f.trim()).filter(Boolean)}const uw=Sa(fs,"userGames");async function xR(t,e,n){const r=Yi(uw,`${t}_${e}`),s=await vS(r);if(s.exists())return s.data();{const i=await PS(),o=await PR(i.name,n),l={userId:t,date:e,celebrityId:i.id,celebrityName:i.name,celebrityAudio:i.audioUrl,clues:o,currentStep:1,finished:!1,resetAt:VR(e)};return await ES(r,l),l}}async function ns(t,e,n){const r=Yi(uw,`${t}_${e}`);await Z_(r,n)}function VR(t){const[e,n,r]=t.split("-").map(Number);return new Date(e,n-1,r+1).getTime()}const hw="/img/celeb-dle-no-text-white.png",DR=new Date,kR=new Date(DR.getTime()),Dr=kR.toISOString().slice(0,10),NR={name:"GameView",props:{lang:{type:String,default:"es"}},setup(t){const e=it(""),n=it(!1),r=it(!1),s=it(null),i=it(null),o=it(1),l=it(""),c=it(null),u=it(!1),f=it(0),d=it([]),p=it(!1),g=it({played:0,wins:0,distribution:[0,0,0,0,0,0,0],currentStreak:0,maxStreak:0,lastPlayed:null}),S=(z,Z=null)=>{const De=Ps[t.lang]||Ps.es;return typeof De[z]=="function"?De[z](Z):Array.isArray(De[z])?De[z]:De[z]||z},R=async z=>{var Le,nt;const Z="https://en.wikipedia.org/w/api.php",De=new URLSearchParams({action:"query",titles:z,prop:"pageimages",format:"json",pithumbsize:100,origin:"*"});try{const je=await(await fetch(`${Z}?${De}`)).json();if((Le=je.query)!=null&&Le.pages){const on=Object.values(je.query.pages)[0];(nt=on.thumbnail)!=null&&nt.source?e.value=on.thumbnail.source:(console.error("No se encontró imagen para la celebridad:",z),e.value="")}else console.error("No se encontraron resultados para la celebridad:",z),e.value=""}catch(Be){console.error("Error al obtener la imagen de MediaWiki:",Be),e.value=""}};Es(()=>s.celebrityName,z=>{z&&R(z)},{immediate:!0}),Es([e,o],()=>{const z=document.getElementById("GameScreen");z&&setTimeout(()=>{const Z=Date.now(),De=2e3,Le=()=>{const nt=Date.now()-Z;(!(Math.abs(z.scrollHeight-z.scrollTop-z.clientHeight)<1)&&nt<De||!e&&o.value>5)&&(z.scrollTo({top:z.scrollHeight,behavior:"smooth"}),setTimeout(Le,100))};Le()},200)});const x=()=>{n.value=!0},j=()=>{n.value=!1},D=()=>{w(),r.value=!0},O=()=>r.value=!1;za(async()=>{w();const z=await T();i.value=`USER_${z}`;const Z=await xR(i.value,Dr,t.lang);s.value=Z,d.value=Array(N.value.length).fill("border-amber-300"),f.value=Z.attempts||0,!Z.finished&&Z.revealedCluesCount!==void 0&&(o.value=Z.revealedCluesCount),Z.finished&&(o.value=N.value.length,u.value=!0,Z.guessedCorrectly?(c.value=!0,d.value=d.value.map(()=>"border-green-500")):(c.value=!1,d.value=d.value.map(()=>"border-red-500"))),setTimeout(()=>{s.value.celebrityName&&R(s.value.celebrityName)},500)});const N=Qt(()=>{if(!s.value)return[];const z=(s.value.clues||[]).map(Le=>({type:"text",content:Le})),Z={type:"audio",content:s.value.celebrityAudio},De={type:"image",content:e.value};return[...z,Z,De]}),ne=Qt(()=>N.value.slice(0,o.value));async function Q(){f.value++,await ns(i.value,Dr,{attempts:f.value})}async function T(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch(z){return console.error("Error al obtener la IP pública:",z),null}}function w(){const z=localStorage.getItem("celebStats");if(z)try{g.value=JSON.parse(z)}catch(Z){console.error("Error al parsear stats:",Z)}}function y(){localStorage.setItem("celebStats",JSON.stringify(g.value))}function b(z){g.value.played++,g.value.wins++,g.value.distribution[z]++;const Z=new Date().toISOString().slice(0,10);g.value.lastPlayed===Z||(g.value.lastPlayed=Z,g.value.currentStreak++,g.value.currentStreak>g.value.maxStreak&&(g.value.maxStreak=g.value.currentStreak)),y()}function A(){g.value.played++,g.value.distribution[0]++;const z=new Date().toISOString().slice(0,10);g.value.lastPlayed!==z&&(g.value.currentStreak=0,g.value.lastPlayed=z),y()}function I(){return g.value.played===0?0:Math.round(g.value.wins/g.value.played*100)}function v(z){const Z=Math.max(...g.value.distribution);return Z===0?0:z/Z*100}async function Se(){if(!(u.value||p.value)&&l.value.trim()){p.value=!0;try{await Q();const z=l.value.trim().toLowerCase(),Z=s.value.celebrityName.trim().toLowerCase();if(z.includes(Z)||Z.includes(z)){c.value=!0,u.value=!0,d.value=d.value.map(()=>"border-green-500");const Le=o.value;Le>6?b(6):b(Le),o.value=N.value.length,l.value="",await ns(i.value,Dr,{finished:!0,guessedCorrectly:!0,attempts:f.value}),s.value.finished=!0}else{const Le=o.value-1;Le>=0&&Le<d.value.length&&(d.value[Le]="border-red-500"),o.value<N.value.length?(o.value++,await ns(i.value,Dr,{revealedCluesCount:o.value,attempts:f.value})):(c.value=!1,u.value=!0,await ns(i.value,Dr,{finished:!0,guessedCorrectly:!1,attempts:f.value}),s.value.finished=!0,A()),l.value=""}}catch(z){console.error("Error en la función onGuess:",z)}finally{p.value=!1}}}async function We(){if(u.value)return;await Q();const z=o.value-1;z>=0&&z<d.value.length&&(d.value[z]="border-gray-500"),o.value<N.value.length?(o.value++,await ns(i.value,Dr,{revealedCluesCount:o.value,attempts:f.value})):(c.value=!1,u.value=!0,await ns(i.value,Dr,{finished:!0,guessedCorrectly:!1,attempts:f.value,revealedCluesCount:o.value}),s.value.finished=!0,A())}function He(){const z=new Date,Z=new Date(z);Z.setDate(z.getDate()+1),Z.setHours(0,0,0,0);const De=Z-z;if(De<=0)return"0 horas";const Le=Math.floor(De/36e5),nt=Math.floor(De%36e5/6e4);return`${Le}h ${nt}m`}return{showRulesModal:n,gameState:s,revealedCluesCount:o,userGuess:l,result:c,localFinished:u,attempts:f,cluesColors:d,allClues:N,visibleClues:ne,onGuess:Se,onSkip:We,timeLeft:He,openRulesModal:x,closeRulesModal:j,imageUrl:e,isGuessing:p,t:S,showStatsModal:r,openStatsModal:D,closeStatsModal:O,stats:g,loadStats:w,saveStats:y,getWinPercentage:I,getDistributionWidth:v}}},OR={class:"flex justify-center"},MR={href:"/"},LR=["alt"],FR={class:"fixed top-4 right-4 flex items-center space-x-3"},BR={id:"GameScreen",style:{"overflow-y":"scroll"},class:"dark text-white p-4 bg-neutral-800 rounded-lg w-full sm:w-[600px] min-h-[70vh] max-h-[70vh] mx-auto flex flex-col"},UR={class:"font-montserrat text-2xl font-bold mb-4 text-center"},$R={key:0,class:"flex justify-center flex-1"},jR={key:1,class:"flex-1 flex flex-col"},qR={class:"font-montserrat bg-amber-300 text-black px-3 py-2 mb-2 select-none"},HR={key:0,class:"font-montserrat"},zR=["src"],GR={key:2,class:"flex justify-center"},WR=["src"],KR={key:3},QR={key:0},XR=["placeholder"],JR={class:"mt-3"},YR=["disabled"],ZR={key:0},eP={key:1,class:"flex items-center justify-center"},tP={key:1},nP=["placeholder"],rP=["disabled"],sP={key:0},iP={key:1,class:"flex items-center justify-center"},oP={key:2,class:"mt-4"},aP={key:0,class:"font-montserrat text-green-400"},lP={key:1,class:"font-montserrat text-red-400"},cP={class:"font-montserrat"},uP={key:3,class:"mt-4 text-center"},hP={class:"font-montserrat text-green-300"},fP={class:"font-montserrat text-2xl font-bold mb-4 text-center"},dP={class:"font-montserrat space-y-2",style:{padding:"0"}},mP=["innerHTML"],pP={class:"flex justify-center mt-6"},gP={class:"text-2xl font-bold mb-4 text-center"},_P={class:"space-y-2 mb-4"},yP={class:"flex items-center"},wP={class:"w-6 text-right mr-2"},vP={class:"flex-1 bg-neutral-600 h-4 rounded relative mr-2"},EP={class:"w-6 text-right"},bP={class:"flex justify-around items-center mb-4"},TP={class:"text-center"},AP={class:"text-xl font-bold"},IP={class:"text-sm text-neutral-400"},CP={class:"text-center"},SP={class:"text-xl font-bold"},RP={class:"text-sm text-neutral-400"},PP={class:"text-center"},xP={class:"text-xl font-bold"},VP={class:"text-sm text-neutral-400"},DP={class:"flex flex-col space-y-2 mt-4"};function kP(t,e,n,r,s,i){return ge(),we(Ze,null,[$("div",OR,[$("a",MR,[$("img",{src:hw,alt:r.t("gameTitle"),class:"w-20 transition hover:scale-110"},null,8,LR)])]),$("div",FR,[$("button",{class:"text-amber-300 hover:text-amber-300 transition text-2xl p-2 rounded-full hover:scale-110 hover:text-white bg-neutral-800",onClick:e[0]||(e[0]=(...o)=>r.openRulesModal&&r.openRulesModal(...o)),"aria-label":"Mostrar reglas"},e[15]||(e[15]=[$("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[$("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:`M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0\r
                 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442\r
                 -.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0\r
                 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z`})],-1)])),$("button",{class:"text-amber-300 hover:text-amber-300 transition text-2xl p-2 rounded-full hover:scale-110 hover:text-white bg-neutral-800",onClick:e[1]||(e[1]=(...o)=>r.openStatsModal&&r.openStatsModal(...o)),"aria-label":"Mostrar estadísticas"},e[16]||(e[16]=[$("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[$("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3v18h16.5V3m-12 9v6m4-10v10m4-6v6"})],-1)]))]),Me(Hl,{name:"fade-in-up",appear:""},{default:tn(()=>[$("div",BR,[$("h2",UR,ye(r.t("gameTitle")),1),r.gameState?(ge(),we("div",jR,[Me(ZE,{name:"collapse",tag:"div",class:"mb-4 flex-1 overflow-auto"},{default:tn(()=>[(ge(!0),we(Ze,null,Ho(r.visibleClues,(o,l)=>(ge(),we("div",{key:l,class:Ba(["mb-2","border","rounded","overflow-hidden","p-2","bg-neutral-700",r.cluesColors[l]])},[$("h3",qR,ye(r.t("clueLabel",l)),1),o.type==="text"?(ge(),we("p",HR,ye(o.content),1)):o.type==="audio"?(ge(),we("audio",{key:1,src:o.content,controls:"",class:"w-full"},null,8,zR)):o.type==="image"&&r.imageUrl?(ge(),we("div",GR,[$("img",{src:r.imageUrl,alt:"Imagen de la celebridad",style:{"image-rendering":"pixelated",width:"256px",height:"auto",filter:"blur(3px)"}},null,8,WR)])):(ge(),we("div",KR,e[18]||(e[18]=[$("div",{class:"flex items-center justify-center"},[$("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[$("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),$("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])],-1)])))],2))),128))]),_:1}),!r.localFinished&&r.revealedCluesCount<r.allClues.length?(ge(),we("div",QR,[$("div",null,[ca($("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>r.userGuess=o),class:"font-montserrat text-black p-2 rounded mr-2 transition hover:scale-95 w-full",placeholder:r.t("placeholderGuess"),onKeyup:e[3]||(e[3]=od((...o)=>r.onGuess&&r.onGuess(...o),["enter"]))},null,40,XR),[[ma,r.userGuess]])]),$("div",JR,[$("button",{onClick:e[4]||(e[4]=(...o)=>r.onGuess&&r.onGuess(...o)),disabled:r.isGuessing,class:"font-montserrat bg-green-600 text-white px-4 py-2 rounded mr-2 transition hover:scale-105"},[r.isGuessing?(ge(),we("span",eP,[ft(ye(r.t("guessButton"))+" ",1),e[19]||(e[19]=$("span",{class:"relative flex h-5 w-5 ms-2"},[$("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),$("span",{class:"relative inline-flex rounded-full h-5 w-5 bg-white"})],-1))])):(ge(),we("span",ZR,ye(r.t("guessButton")),1))],8,YR),$("button",{onClick:e[5]||(e[5]=(...o)=>r.onSkip&&r.onSkip(...o)),class:"font-montserrat bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition hover:scale-105"},ye(r.t("skipButton")),1)])])):!r.localFinished&&r.revealedCluesCount===r.allClues.length?(ge(),we("div",tP,[$("div",null,[ca($("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=o=>r.userGuess=o),class:"font-montserrat text-black p-2 rounded mr-2 transition hover:scale-95 w-full",placeholder:r.t("placeholderGuess"),onKeyup:e[7]||(e[7]=od((...o)=>r.onGuess&&r.onGuess(...o),["enter"]))},null,40,nP),[[ma,r.userGuess]])]),$("button",{onClick:e[8]||(e[8]=(...o)=>r.onGuess&&r.onGuess(...o)),disabled:r.isGuessing,class:"font-montserrat bg-green-600 text-white px-4 py-2 rounded mr-2 transition hover:scale-105 mt-2"},[r.isGuessing?(ge(),we("span",iP,[ft(ye(r.t("guessButton"))+" ",1),e[20]||(e[20]=$("span",{class:"relative flex h-5 w-5 ms-2"},[$("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),$("span",{class:"relative inline-flex rounded-full h-5 w-5 bg-white"})],-1))])):(ge(),we("span",sP,ye(r.t("guessButton")),1))],8,rP)])):Nr("",!0),r.localFinished?(ge(),we("div",oP,[r.result===!0?(ge(),we("p",aP,ye(r.t("correctAnswer",r.gameState.celebrityName)),1)):r.result===!1?(ge(),we("p",lP,ye(r.t("wrongAnswer",r.gameState.celebrityName)),1)):Nr("",!0),$("p",cP,ye(r.t("attemptsLabel",r.attempts)),1)])):Nr("",!0),r.localFinished?(ge(),we("div",uP,[$("p",hP,ye(r.t("nextCelebrityTimer",r.timeLeft())),1)])):Nr("",!0)])):(ge(),we("div",$R,e[17]||(e[17]=[$("span",{class:"relative flex h-5 w-5"},[$("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-300 opacity-75"}),$("span",{class:"relative inline-flex rounded-full h-5 w-5 bg-amber-300"})],-1)])))])]),_:1}),Me(Hl,{name:"fade"},{default:tn(()=>[r.showRulesModal?(ge(),we("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[11]||(e[11]=hi((...o)=>r.closeRulesModal&&r.closeRulesModal(...o),["self"]))},[$("div",{class:"bg-neutral-700 text-white p-6 px-3 rounded-lg shadow-md w-11/12 sm:w-96",onClick:e[10]||(e[10]=hi(()=>{},["stop"]))},[$("h2",fP,ye(r.t("rulesModalTitle")),1),$("ul",dP,[(ge(!0),we(Ze,null,Ho(r.t("rulesList"),(o,l)=>(ge(),we("li",{class:"bg-neutral-800 p-2 rounded-lg",key:l,innerHTML:o},null,8,mP))),128))]),$("div",pP,[$("button",{class:"font-montserrat bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-transform transform hover:scale-105",onClick:e[9]||(e[9]=(...o)=>r.closeRulesModal&&r.closeRulesModal(...o))},ye(r.t("closeButton")),1)])])])):Nr("",!0)]),_:1}),Me(Hl,{name:"fade"},{default:tn(()=>[r.showStatsModal?(ge(),we("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[14]||(e[14]=hi((...o)=>r.closeStatsModal&&r.closeStatsModal(...o),["self"]))},[$("div",{class:"bg-neutral-700 text-white p-6 rounded-lg shadow-md w-11/12 sm:w-96",onClick:e[13]||(e[13]=hi(()=>{},["stop"]))},[$("h2",gP,ye(r.t("statsTitle")),1),$("div",_P,[(ge(!0),we(Ze,null,Ho(r.stats.distribution,(o,l)=>(ge(),we("div",{key:l,class:"text-sm"},[$("div",yP,[$("span",wP,[l===0?(ge(),we(Ze,{key:0},[ft(ye(r.t("statsXLabel")),1)],64)):(ge(),we(Ze,{key:1},[ft(ye(l),1)],64))]),$("div",vP,[$("div",{class:"bg-amber-300 h-4 rounded-l",style:Fa({width:r.getDistributionWidth(o)+"%"})},null,4)]),$("span",EP,ye(o),1)])]))),128))]),$("div",bP,[$("div",TP,[$("p",AP,ye(r.stats.wins)+"/"+ye(r.stats.played)+" ("+ye(r.getWinPercentage())+"%) ",1),$("p",IP,ye(r.t("statsFoundLabel")),1)]),$("div",CP,[$("p",SP,ye(r.stats.currentStreak),1),$("p",RP,ye(r.t("statsCurrentStreakLabel")),1)]),$("div",PP,[$("p",xP,ye(r.stats.maxStreak),1),$("p",VP,ye(r.t("statsMaxStreakLabel")),1)])]),$("div",DP,[$("button",{class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition",onClick:e[12]||(e[12]=(...o)=>r.closeStatsModal&&r.closeStatsModal(...o))},ye(r.t("statsCloseButton")),1)])])])):Nr("",!0)]),_:1})],64)}const NP=_n(NR,[["render",kP],["__scopeId","data-v-81ce2ad6"]]),OP={name:"LogoIcon"},MP={class:"flex items-center justify-center cursor-default"};function LP(t,e,n,r,s,i){return ge(),we("div",MP,e[0]||(e[0]=[$("a",{href:"/"},[$("img",{src:hw,alt:"Celebdle Logo",class:"w-36 transition hover:scale-110"})],-1)]))}const FP=_n(OP,[["render",LP]]),BP={name:"TextTemplate",components:{LogoIcon:FP}},UP={class:"bg-neutral-800 p-4 rounded-lg"};function $P(t,e,n,r,s,i){const o=hr("LogoIcon");return ge(),we("div",null,[Me(o),$("div",UP,[$v(t.$slots,"default")])])}const wl=_n(BP,[["render",$P]]),jP={name:"TermsView",components:{TextTemplate:wl}},qP={class:"p-4"};function HP(t,e,n,r,s,i){const o=hr("TextTemplate");return ge(),we("div",qP,[Me(o,null,{default:tn(()=>e[0]||(e[0]=[ft(" Descripción básica de terms y su uso en el sitio. ")])),_:1})])}const zP=_n(jP,[["render",HP]]),GP={name:"PrivacyView",components:{TextTemplate:wl}},WP={class:"p-4"};function KP(t,e,n,r,s,i){const o=hr("TextTemplate");return ge(),we("div",WP,[Me(o,null,{default:tn(()=>e[0]||(e[0]=[ft(" Descripción básica de privacidad y su uso en el sitio. ")])),_:1})])}const QP=_n(GP,[["render",KP]]),XP={name:"CookiesView",components:{TextTemplate:wl}},JP={class:"p-4"};function YP(t,e,n,r,s,i){const o=hr("TextTemplate");return ge(),we("div",JP,[Me(o,null,{default:tn(()=>e[0]||(e[0]=[ft(" Descripción básica de cookies y su uso en el sitio. ")])),_:1})])}const ZP=_n(XP,[["render",YP]]),ex={name:"DmcaView",components:{TextTemplate:wl}},tx={class:"p-4"};function nx(t,e,n,r,s,i){const o=hr("TextTemplate");return ge(),we("div",tx,[Me(o,null,{default:tn(()=>e[0]||(e[0]=[ft(" Descripción básica de dmca y su uso en el sitio. ")])),_:1})])}const rx=_n(ex,[["render",nx]]),sx={name:"AdminCelebrities",setup(){const t=it([]),e=it(""),n=it(""),r=it(!1);let s=null;za(()=>{i()});async function i(){t.value=[],(await Y_(Sa(fs,"celebrities"))).forEach(p=>{t.value.push({id:p.id,...p.data()})})}async function o(){if(!(!e.value.trim()||!n.value.trim())){if(n.value=u(n.value),!r.value)await TS(Sa(fs,"celebrities"),{name:e.value,audioUrl:n.value});else{if(!s)return;const d=Yi(fs,"celebrities",s);await Z_(d,{name:e.value,audioUrl:n.value})}e.value="",n.value="",s=null,r.value=!1,await i()}}function l(d){r.value=!0,s=d.id,e.value=d.name,n.value=d.audioUrl}function c(){r.value=!1,s=null,e.value="",n.value=""}function u(d){return d?d.replace("https://www.dropbox.com/","https://dl.dropboxusercontent.com/"):""}async function f(d){confirm("¿Estás seguro de eliminar esta celebridad?")&&(await bS(Yi(fs,"celebrities",d)),await i())}return{celebrities:t,name:e,audioUrl:n,isEditing:r,loadCelebs:i,saveCeleb:o,editCeleb:l,cancelEditing:c,deleteCeleb:f}}},ix={class:"p-4 max-w-3xl mx-auto"},ox={class:"w-full border border-gray-600 text-sm mb-6"},ax={class:"py-2 px-2"},lx={class:"py-2 px-2"},cx={class:"py-2 px-2 flex items-center justify-center space-x-2"},ux=["onClick"],hx=["onClick"],fx={class:"border border-gray-600 p-4 rounded"},dx={class:"text-xl font-bold mb-2"},mx={class:"flex items-center space-x-2"},px={type:"submit",class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"};function gx(t,e,n,r,s,i){return ge(),we("div",ix,[e[7]||(e[7]=$("h1",{class:"text-2xl font-bold mb-4"},"Administrar Celebridades",-1)),$("table",ox,[e[4]||(e[4]=$("thead",{class:"bg-gray-700 text-white"},[$("tr",null,[$("th",{class:"py-2 px-2 text-left"},"Nombre"),$("th",{class:"py-2 px-2 text-left"},"Audio URL"),$("th",{class:"py-2 px-2 text-center"},"Acciones")])],-1)),$("tbody",null,[(ge(!0),we(Ze,null,Ho(r.celebrities,o=>(ge(),we("tr",{key:o.id,class:"border-b border-gray-600"},[$("td",ax,ye(o.name),1),$("td",lx,ye(o.audioUrl),1),$("td",cx,[$("button",{class:"bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:l=>r.editCeleb(o)}," Editar ",8,ux),$("button",{class:"bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:l=>r.deleteCeleb(o.id)}," Eliminar ",8,hx)])]))),128))])]),$("div",fx,[$("h2",dx,ye(r.isEditing?"Editar Celebridad":"Añadir Celebridad"),1),$("form",{onSubmit:e[3]||(e[3]=hi((...o)=>r.saveCeleb&&r.saveCeleb(...o),["prevent"])),class:"space-y-4"},[$("div",null,[e[5]||(e[5]=$("label",{class:"block font-semibold mb-1"},"Nombre",-1)),ca($("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>r.name=o),class:"w-full border border-gray-500 rounded p-2",required:""},null,512),[[ma,r.name]])]),$("div",null,[e[6]||(e[6]=$("label",{class:"block font-semibold mb-1"},"Audio URL",-1)),ca($("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>r.audioUrl=o),class:"w-full border border-gray-500 rounded p-2",required:""},null,512),[[ma,r.audioUrl]])]),$("div",mx,[$("button",px,ye(r.isEditing?"Actualizar":"Guardar"),1),r.isEditing?(ge(),we("button",{key:0,type:"button",onClick:e[2]||(e[2]=(...o)=>r.cancelEditing&&r.cancelEditing(...o)),class:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"}," Cancelar ")):Nr("",!0)])],32)])])}const _x=_n(sx,[["render",gx],["__scopeId","data-v-2a1ac40e"]]),yx=[{path:"/",component:BT,props:t=>({lang:t.query.lang})},{path:"/play",component:NP,props:t=>({lang:t.query.lang})},{path:"/terms",name:"Terms",component:zP},{path:"/privacy",name:"Privacy",component:QP},{path:"/cookies",name:"Cookies",component:ZP},{path:"/dmca",name:"DMCA",component:rx},{path:"/admin/3184239974",name:"AdminCelebrities",component:_x,props:t=>({lang:t.query.lang})}],fw=ST({history:nT(),routes:yx,scrollBehavior(t,e,n){return{top:0,behavior:"smooth"}}});fw.beforeEach((t,e,n)=>{const r=localStorage.getItem("lang")||(navigator.language.includes("es")?"es":"en");t.query.lang?n():n({...t,query:{...t.query,lang:r}})});const dw=ub(Ib);dw.use(fw);dw.mount("#app");
